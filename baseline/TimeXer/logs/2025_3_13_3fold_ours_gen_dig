nohup: ignoring input
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          my_classificaion    Is Training:        1                   
  Model ID:           ECL_96_96           Model:              TimeXer             

[1mData Loader[0m
  Data:               ptb                 Root Path:          ./dataset/electricity/
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             12                  
  C Out:              23                  d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                test                Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                7                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:7
>>>>>>>start training : my_classificaion_ECL_96_96_TimeXer_ptb_ftM_sl1000_ll48_pl0_dm512_nh8_el1_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_test_0>>>>>>>>>>>>>>>>>>>>>>>>>>
TRAIN
Label to index mapping:
{'NORM': 0, 'LAFB/LPFB': 1, 'IRBBB': 2, 'ILBBB': 3, 'CLBBB': 4, 'CRBBB': 5, '_AVB': 6, 'IVCD': 7, 'WPW': 8, 'LVH': 9, 'RVH': 10, 'LAO/LAE': 11, 'RAO/RAE': 12, 'SEHYP': 13, 'AMI': 14, 'IMI': 15, 'LMI': 16, 'PMI': 17, 'ISCA': 18, 'ISCI': 19, 'ISC_': 20, 'STTC': 21, 'NST_': 22}
Âà†Èô§train‰∏≠Áº∫Â§±labelÁöÑÊï∞Èáè:328
xtrain shape:(17124, 12, 1000)
my_dataloader shape : (17124, 1000, 12)
VAL
Label to index mapping:
{'NORM': 0, 'LAFB/LPFB': 1, 'IRBBB': 2, 'ILBBB': 3, 'CLBBB': 4, 'CRBBB': 5, '_AVB': 6, 'IVCD': 7, 'WPW': 8, 'LVH': 9, 'RVH': 10, 'LAO/LAE': 11, 'RAO/RAE': 12, 'SEHYP': 13, 'AMI': 14, 'IMI': 15, 'LMI': 16, 'PMI': 17, 'ISCA': 18, 'ISCI': 19, 'ISC_': 20, 'STTC': 21, 'NST_': 22}
Âà†Èô§val‰∏≠Áº∫Â§±labelÁöÑÊï∞Èáè:39
my_dataloader shape : (2135, 1000, 12)
TEST
Label to index mapping:
{'NORM': 0, 'LAFB/LPFB': 1, 'IRBBB': 2, 'ILBBB': 3, 'CLBBB': 4, 'CRBBB': 5, '_AVB': 6, 'IVCD': 7, 'WPW': 8, 'LVH': 9, 'RVH': 10, 'LAO/LAE': 11, 'RAO/RAE': 12, 'SEHYP': 13, 'AMI': 14, 'IMI': 15, 'LMI': 16, 'PMI': 17, 'ISCA': 18, 'ISCI': 19, 'ISC_': 20, 'STTC': 21, 'NST_': 22}
my_dataloader shape : (18139, 1000, 12)
(17124, 1000, 12)
torch.Size([17124, 23])
(2135, 1000, 12)
torch.Size([2135, 23])
(18139, 1000, 12)
(18139, 23)
	iters: 100, epoch: 1 | loss: 0.3012728
	speed: 0.0647s/iter; left time: 686.0383s
	iters: 200, epoch: 1 | loss: 0.2554778
	speed: 0.0253s/iter; left time: 265.5931s
	iters: 300, epoch: 1 | loss: 0.2097732
	speed: 0.0253s/iter; left time: 263.0632s
	iters: 400, epoch: 1 | loss: 0.0694856
	speed: 0.0253s/iter; left time: 261.1831s
	iters: 500, epoch: 1 | loss: 0.1195393
	speed: 0.0288s/iter; left time: 294.3902s
	iters: 600, epoch: 1 | loss: 0.0432479
	speed: 0.0295s/iter; left time: 298.5007s
	iters: 700, epoch: 1 | loss: 0.0622131
	speed: 0.0318s/iter; left time: 317.9721s
	iters: 800, epoch: 1 | loss: 0.0695818
	speed: 0.0295s/iter; left time: 292.8522s
	iters: 900, epoch: 1 | loss: 0.0651016
	speed: 0.0287s/iter; left time: 281.2234s
	iters: 1000, epoch: 1 | loss: 0.0800720
	speed: 0.0316s/iter; left time: 306.5079s
Epoch: 1 cost time: 34.39102649688721
Test is reading ....
[0.7780534172149012, 0.8829391763217669, 0.7088235199850145, 0.5560023141976753, 0.9567201501650354, 0.9843205948264954, 0.732003526715842, 0.5624630482609848, 0.6969178467934343, 0.6906234181607255, 0.9564150364984972, 0.7126481296407616, 0.8095759093493909, 0.657078180212014, 0.7618440927707641, 0.7509652895080361, 0.7787810360350711, 0.9424798598466038, 0.7624865346769936, 0.7596179591581635, 0.6941401403825358, 0.6652273149131518, 0.684596104268118]
Êñá‰ª∂ 'existing_file.xlsx' ‰∏çÂ≠òÂú®ÔºåÂ∞ÜÂàõÂª∫Êñ∞Êñá‰ª∂„ÄÇ
	iters: 100, epoch: 2 | loss: 0.0782476
	speed: 0.3652s/iter; left time: 3484.1313s
	iters: 200, epoch: 2 | loss: 0.0941191
	speed: 0.0351s/iter; left time: 330.9823s
	iters: 300, epoch: 2 | loss: 0.0609382
	speed: 0.0361s/iter; left time: 336.9849s
	iters: 400, epoch: 2 | loss: 0.0556737
	speed: 0.0365s/iter; left time: 337.4751s
	iters: 500, epoch: 2 | loss: 0.0679158
	speed: 0.0355s/iter; left time: 324.5949s
	iters: 600, epoch: 2 | loss: 0.0422288
	speed: 0.0381s/iter; left time: 344.2400s
	iters: 700, epoch: 2 | loss: 0.0588543
	speed: 0.0400s/iter; left time: 357.2636s
	iters: 800, epoch: 2 | loss: 0.0643441
	speed: 0.0423s/iter; left time: 374.0169s
	iters: 900, epoch: 2 | loss: 0.0397527
	speed: 0.0438s/iter; left time: 382.9315s
	iters: 1000, epoch: 2 | loss: 0.1111990
	speed: 0.0433s/iter; left time: 374.0462s
Epoch: 2 cost time: 42.94355130195618
Test is reading ....
[0.7746819259314833, 0.8688125361387886, 0.7152240058774321, 0.6415469214460471, 0.9157008276785598, 0.9894026630854073, 0.6858309793907327, 0.5651815823450117, 0.7311788980022323, 0.6293664851223577, 0.9394321777266974, 0.7070999389515942, 0.8506160032525728, 0.8100256838110194, 0.7547986977624015, 0.7425048467110615, 0.8053867079777975, 0.9344996689289854, 0.7657926895000776, 0.7451982113852319, 0.7433937776568854, 0.6780779237844102, 0.6901369184921629]
Epoch: 2, Steps: 1071, | Train Loss: 0.06885

	iters: 100, epoch: 3 | loss: 0.0464346
	speed: 0.4432s/iter; left time: 3753.7922s
	iters: 200, epoch: 3 | loss: 0.0712332
	speed: 0.0383s/iter; left time: 320.3324s
	iters: 300, epoch: 3 | loss: 0.0676528
	speed: 0.0367s/iter; left time: 303.5903s
	iters: 400, epoch: 3 | loss: 0.0705250
	speed: 0.0367s/iter; left time: 300.0334s
	iters: 500, epoch: 3 | loss: 0.0579588
	speed: 0.0361s/iter; left time: 291.0681s
	iters: 600, epoch: 3 | loss: 0.0851894
	speed: 0.0399s/iter; left time: 317.8670s
	iters: 700, epoch: 3 | loss: 0.0547979
	speed: 0.0416s/iter; left time: 327.2327s
	iters: 800, epoch: 3 | loss: 0.0473327
	speed: 0.0423s/iter; left time: 328.6134s
	iters: 900, epoch: 3 | loss: 0.0527459
	speed: 0.0429s/iter; left time: 328.9652s
	iters: 1000, epoch: 3 | loss: 0.0456341
	speed: 0.0448s/iter; left time: 338.9171s
Epoch: 3 cost time: 43.667858600616455
Test is reading ....
[0.7636854760300746, 0.8710812528244991, 0.7208959855234163, 0.5897096189735191, 0.9361714336004698, 0.9880200190628584, 0.7521584515411551, 0.5613290047459314, 0.7468569205091184, 0.6734096419588388, 0.9225867609945149, 0.7190311783152573, 0.7882153667856665, 0.8366859295249313, 0.7621653553380374, 0.7541466126180126, 0.8288075004024932, 0.977152651327043, 0.8011551653726581, 0.7689990603806631, 0.698832661054019, 0.689518729863491, 0.697743110521458]
Epoch: 3, Steps: 1071, | Train Loss: 0.06286

	iters: 100, epoch: 4 | loss: 0.0394871
	speed: 0.4549s/iter; left time: 3365.1402s
	iters: 200, epoch: 4 | loss: 0.0711979
	speed: 0.0385s/iter; left time: 280.6850s
	iters: 300, epoch: 4 | loss: 0.0795700
	speed: 0.0365s/iter; left time: 262.4385s
	iters: 400, epoch: 4 | loss: 0.0501031
	speed: 0.0388s/iter; left time: 275.4924s
	iters: 500, epoch: 4 | loss: 0.0636470
	speed: 0.0380s/iter; left time: 265.8795s
	iters: 600, epoch: 4 | loss: 0.0407323
	speed: 0.0402s/iter; left time: 277.0562s
	iters: 700, epoch: 4 | loss: 0.0804109
	speed: 0.0401s/iter; left time: 272.2684s
	iters: 800, epoch: 4 | loss: 0.0559118
	speed: 0.0402s/iter; left time: 269.0576s
	iters: 900, epoch: 4 | loss: 0.0681932
	speed: 0.0422s/iter; left time: 278.6182s
	iters: 1000, epoch: 4 | loss: 0.0672737
	speed: 0.0451s/iter; left time: 292.8559s
Epoch: 4 cost time: 43.71896195411682
Test is reading ....
[0.7667521003732449, 0.8923011799252851, 0.7154819863565036, 0.6154813658119007, 0.961284941471856, 0.9881457951497883, 0.746100046412356, 0.5668385197437533, 0.7898585895821173, 0.7003580790373813, 0.9250160349046219, 0.6564229841171307, 0.8199725260253101, 0.8214095831697421, 0.7666733375245395, 0.7536985277345947, 0.830105152674525, 0.9627683054681896, 0.7848308267570624, 0.7639883786914504, 0.7356914525434934, 0.6990691997446, 0.7002878747522869]
Epoch: 4, Steps: 1071, | Train Loss: 0.05768

	iters: 100, epoch: 5 | loss: 0.0641713
	speed: 0.4473s/iter; left time: 2830.2758s
	iters: 200, epoch: 5 | loss: 0.0644052
	speed: 0.0375s/iter; left time: 233.3097s
	iters: 300, epoch: 5 | loss: 0.0464453
	speed: 0.0362s/iter; left time: 221.9784s
	iters: 400, epoch: 5 | loss: 0.0483136
	speed: 0.0370s/iter; left time: 222.9691s
	iters: 500, epoch: 5 | loss: 0.0853169
	speed: 0.0390s/iter; left time: 231.1109s
	iters: 600, epoch: 5 | loss: 0.0564786
	speed: 0.0399s/iter; left time: 232.5980s
	iters: 700, epoch: 5 | loss: 0.0413451
	speed: 0.0403s/iter; left time: 231.0321s
	iters: 800, epoch: 5 | loss: 0.0522608
	speed: 0.0407s/iter; left time: 229.1108s
	iters: 900, epoch: 5 | loss: 0.0577254
	speed: 0.0397s/iter; left time: 219.5807s
	iters: 1000, epoch: 5 | loss: 0.0880731
	speed: 0.0412s/iter; left time: 223.7704s
Epoch: 5 cost time: 42.7597222328186
Updating learning rate to 6.25e-06
Test is reading ....
[0.7653093428897908, 0.859656639571209, 0.689570335633998, 0.6381635862083974, 0.9620866455678764, 0.9849841721127117, 0.7491881732799514, 0.5943203741906605, 0.7762203176358555, 0.693703380127594, 0.9024744091971915, 0.7472973069831087, 0.8208525306718428, 0.8598412347860228, 0.7482361708270823, 0.7528836855481412, 0.8314886586711572, 0.9719382828450036, 0.7481098188073088, 0.7778840738428585, 0.6981923094784749, 0.6891755281657573, 0.7098557945996472]
Epoch: 5, Steps: 1071, | Train Loss: 0.05170

	iters: 100, epoch: 6 | loss: 0.0391717
	speed: 0.4438s/iter; left time: 2332.4498s
	iters: 200, epoch: 6 | loss: 0.0363569
	speed: 0.0383s/iter; left time: 197.3081s
	iters: 300, epoch: 6 | loss: 0.0342774
	speed: 0.0364s/iter; left time: 184.0932s
	iters: 400, epoch: 6 | loss: 0.0266921
	speed: 0.0379s/iter; left time: 188.0036s
	iters: 500, epoch: 6 | loss: 0.0406555
	speed: 0.0354s/iter; left time: 172.1162s
	iters: 600, epoch: 6 | loss: 0.0402714
	speed: 0.0411s/iter; left time: 195.3354s
	iters: 700, epoch: 6 | loss: 0.0372251
	speed: 0.0412s/iter; left time: 191.8561s
	iters: 800, epoch: 6 | loss: 0.0341895
	speed: 0.0404s/iter; left time: 184.1580s
	iters: 900, epoch: 6 | loss: 0.0286620
	speed: 0.0407s/iter; left time: 181.3121s
	iters: 1000, epoch: 6 | loss: 0.0263537
	speed: 0.0413s/iter; left time: 180.0002s
Epoch: 6 cost time: 42.66783690452576
Test is reading ....
[0.7640407575073859, 0.8518709482620819, 0.7020886655135447, 0.6544835766324071, 0.9660674795701881, 0.9838788477787893, 0.7446117695571991, 0.5991691278309959, 0.7860094819729877, 0.7080410664751934, 0.8908964727734673, 0.7512983303775184, 0.8230366711376037, 0.8683827378615364, 0.7413581625637301, 0.758634298836665, 0.8347303709364585, 0.9768836561275728, 0.7552319025665358, 0.7750778222137942, 0.721967445316491, 0.7019356722460464, 0.7157720521106069]
Epoch: 6, Steps: 1071, | Train Loss: 0.03634

	iters: 100, epoch: 7 | loss: 0.0253425
	speed: 0.4456s/iter; left time: 1864.8261s
	iters: 200, epoch: 7 | loss: 0.0316142
	speed: 0.0380s/iter; left time: 155.1692s
	iters: 300, epoch: 7 | loss: 0.0282477
	speed: 0.0390s/iter; left time: 155.4574s
	iters: 400, epoch: 7 | loss: 0.0339825
	speed: 0.0394s/iter; left time: 152.9756s
	iters: 500, epoch: 7 | loss: 0.0249820
	speed: 0.0380s/iter; left time: 143.8310s
	iters: 600, epoch: 7 | loss: 0.0376948
	speed: 0.0386s/iter; left time: 142.2429s
	iters: 700, epoch: 7 | loss: 0.0379308
	speed: 0.0395s/iter; left time: 141.4327s
	iters: 800, epoch: 7 | loss: 0.0253248
	speed: 0.0404s/iter; left time: 140.9150s
	iters: 900, epoch: 7 | loss: 0.0292004
	speed: 0.0420s/iter; left time: 142.1504s
	iters: 1000, epoch: 7 | loss: 0.0321679
	speed: 0.0374s/iter; left time: 122.8637s
Epoch: 7 cost time: 42.69876265525818
Test is reading ....
[0.7564490843518588, 0.8413380775052445, 0.7069122742915642, 0.6608802656611876, 0.9645275362753047, 0.9825946815849522, 0.747953424568842, 0.6001569067234428, 0.7873795553917201, 0.7152554541074185, 0.8856798969241266, 0.7469861439751393, 0.8240490479335761, 0.8682702689438555, 0.7363828614021857, 0.7576237831382542, 0.837175733764318, 0.9771492026706394, 0.7555717126317123, 0.770047343178385, 0.7290685614328396, 0.6996954846380483, 0.7157899343508203]
Epoch: 7, Steps: 1071, | Train Loss: 0.03383

	iters: 100, epoch: 8 | loss: 0.0280689
	speed: 0.4535s/iter; left time: 1412.1144s
	iters: 200, epoch: 8 | loss: 0.0253654
	speed: 0.0395s/iter; left time: 119.0443s
	iters: 300, epoch: 8 | loss: 0.0325276
	speed: 0.0380s/iter; left time: 110.7204s
	iters: 400, epoch: 8 | loss: 0.0304656
	speed: 0.0391s/iter; left time: 109.9707s
	iters: 500, epoch: 8 | loss: 0.0347621
	speed: 0.0388s/iter; left time: 105.2512s
	iters: 600, epoch: 8 | loss: 0.0372033
	speed: 0.0381s/iter; left time: 99.5915s
	iters: 700, epoch: 8 | loss: 0.0288757
	speed: 0.0407s/iter; left time: 102.3713s
	iters: 800, epoch: 8 | loss: 0.0180517
	speed: 0.0420s/iter; left time: 101.3489s
	iters: 900, epoch: 8 | loss: 0.0266210
	speed: 0.0347s/iter; left time: 80.2773s
	iters: 1000, epoch: 8 | loss: 0.0386776
	speed: 0.0348s/iter; left time: 76.9462s
Epoch: 8 cost time: 42.19933867454529
Test is reading ....
[0.7506686273094856, 0.8405475137500075, 0.7067173273495395, 0.6553468666742839, 0.9673941567354246, 0.9826019526163466, 0.7459834096168272, 0.603424939943249, 0.7909562866709674, 0.7154339119556545, 0.8879847377119465, 0.739620290757446, 0.823293311019171, 0.865779593639576, 0.7344017550560462, 0.7550955545613584, 0.8339443861337771, 0.9787114440214092, 0.749299881890724, 0.7657059538343641, 0.7259761318728949, 0.6971799957518385, 0.7153976557932595]
Epoch: 8, Steps: 1071, | Train Loss: 0.03211

	iters: 100, epoch: 9 | loss: 0.0227723
	speed: 0.4912s/iter; left time: 1003.5808s
	iters: 200, epoch: 9 | loss: 0.0319526
	speed: 0.0370s/iter; left time: 71.9439s
	iters: 300, epoch: 9 | loss: 0.0303896
	speed: 0.0377s/iter; left time: 69.4766s
	iters: 400, epoch: 9 | loss: 0.0293781
	speed: 0.0379s/iter; left time: 66.0131s
	iters: 500, epoch: 9 | loss: 0.0245992
	speed: 0.0377s/iter; left time: 61.9996s
	iters: 600, epoch: 9 | loss: 0.0268928
	speed: 0.0408s/iter; left time: 62.9002s
	iters: 700, epoch: 9 | loss: 0.0251263
	speed: 0.0351s/iter; left time: 50.6407s
	iters: 800, epoch: 9 | loss: 0.0350926
	speed: 0.0357s/iter; left time: 47.9232s
	iters: 900, epoch: 9 | loss: 0.0329337
	speed: 0.0365s/iter; left time: 45.3152s
	iters: 1000, epoch: 9 | loss: 0.0279349
	speed: 0.0366s/iter; left time: 41.7993s
Epoch: 9 cost time: 41.16047239303589
Test is reading ....
[0.7511203026541085, 0.8280139601797418, 0.7040071523477855, 0.6624127868489732, 0.9646755318679383, 0.9811633088958646, 0.7436000373237746, 0.6005726512746358, 0.7843895595900019, 0.7214754558064373, 0.8771692369647822, 0.7410073579066412, 0.8184522724110778, 0.8613053756052872, 0.7271949980974467, 0.7538845045922112, 0.8337460761220234, 0.9815083043646196, 0.7475777762564947, 0.765564975422882, 0.7272934620836679, 0.6928035282703668, 0.7136969584277699]
Epoch: 9, Steps: 1071, | Train Loss: 0.03065

	iters: 100, epoch: 10 | loss: 0.0315961
	speed: 0.4886s/iter; left time: 474.9633s
	iters: 200, epoch: 10 | loss: 0.0298464
	speed: 0.0328s/iter; left time: 28.5780s
	iters: 300, epoch: 10 | loss: 0.0265702
	speed: 0.0333s/iter; left time: 25.7143s
	iters: 400, epoch: 10 | loss: 0.0243544
	speed: 0.0351s/iter; left time: 23.5559s
	iters: 500, epoch: 10 | loss: 0.0316262
	speed: 0.0336s/iter; left time: 19.2339s
	iters: 600, epoch: 10 | loss: 0.0304239
	speed: 0.0330s/iter; left time: 15.5840s
	iters: 700, epoch: 10 | loss: 0.0304639
	speed: 0.0345s/iter; left time: 12.8496s
	iters: 800, epoch: 10 | loss: 0.0324596
	speed: 0.0343s/iter; left time: 9.3304s
	iters: 900, epoch: 10 | loss: 0.0220091
	speed: 0.0340s/iter; left time: 5.8562s
	iters: 1000, epoch: 10 | loss: 0.0290422
	speed: 0.0260s/iter; left time: 1.8755s
Epoch: 10 cost time: 36.04801559448242
Updating learning rate to 1.953125e-07
Test is reading ....
[0.7446095842213228, 0.8321582232642034, 0.7078104131640616, 0.6557576548979922, 0.9641482181544649, 0.9774576341237413, 0.7440856272480173, 0.6013178125461629, 0.7788078927697396, 0.7216814077290747, 0.8753881465007708, 0.7374047540472226, 0.8158217136250112, 0.8587983411857086, 0.7227408160464026, 0.7522884974457271, 0.831706488745043, 0.9818635159741765, 0.7415252856930402, 0.7613340250863447, 0.7292220357236844, 0.6877307705310265, 0.7107795986672496]
Epoch: 10, Steps: 1071, | Train Loss: 0.02914

