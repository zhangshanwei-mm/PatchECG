nohup: ignoring input
True
Args in experiment:
[1mBasic Config[0m
  Task Name:          my_classificaion    Is Training:        1                   
  Model ID:           ECL_96_96           Model:              TimeXer             

[1mData Loader[0m
  Data:               ptb                 Root Path:          ./dataset/electricity/
  Data Path:          electricity.csv     Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             12                  
  C Out:              23                  d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       10                  Batch Size:         16                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                test                Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                8                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:8
>>>>>>>start training : my_classificaion_ECL_96_96_TimeXer_ptb_ftM_sl1000_ll48_pl0_dm512_nh8_el1_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_test_0>>>>>>>>>>>>>>>>>>>>>>>>>>
TRAIN
Label to index mapping:
{'NORM': 0, 'LAFB/LPFB': 1, 'IRBBB': 2, 'ILBBB': 3, 'CLBBB': 4, 'CRBBB': 5, '_AVB': 6, 'IVCD': 7, 'WPW': 8, 'LVH': 9, 'RVH': 10, 'LAO/LAE': 11, 'RAO/RAE': 12, 'SEHYP': 13, 'AMI': 14, 'IMI': 15, 'LMI': 16, 'PMI': 17, 'ISCA': 18, 'ISCI': 19, 'ISC_': 20, 'STTC': 21, 'NST_': 22}
Âà†Èô§train‰∏≠Áº∫Â§±labelÁöÑÊï∞Èáè:325
xtrain shape:(17108, 12, 1000)
my_dataloader shape : (17108, 1000, 12)
VAL
Label to index mapping:
{'NORM': 0, 'LAFB/LPFB': 1, 'IRBBB': 2, 'ILBBB': 3, 'CLBBB': 4, 'CRBBB': 5, '_AVB': 6, 'IVCD': 7, 'WPW': 8, 'LVH': 9, 'RVH': 10, 'LAO/LAE': 11, 'RAO/RAE': 12, 'SEHYP': 13, 'AMI': 14, 'IMI': 15, 'LMI': 16, 'PMI': 17, 'ISCA': 18, 'ISCI': 19, 'ISC_': 20, 'STTC': 21, 'NST_': 22}
Âà†Èô§val‰∏≠Áº∫Â§±labelÁöÑÊï∞Èáè:42
my_dataloader shape : (2150, 1000, 12)
TEST
Label to index mapping:
{'NORM': 0, 'LAFB/LPFB': 1, 'IRBBB': 2, 'ILBBB': 3, 'CLBBB': 4, 'CRBBB': 5, '_AVB': 6, 'IVCD': 7, 'WPW': 8, 'LVH': 9, 'RVH': 10, 'LAO/LAE': 11, 'RAO/RAE': 12, 'SEHYP': 13, 'AMI': 14, 'IMI': 15, 'LMI': 16, 'PMI': 17, 'ISCA': 18, 'ISCI': 19, 'ISC_': 20, 'STTC': 21, 'NST_': 22}
my_dataloader shape : (18139, 1000, 12)
(17108, 1000, 12)
torch.Size([17108, 23])
(2150, 1000, 12)
torch.Size([2150, 23])
(18139, 1000, 12)
(18139, 23)
	iters: 100, epoch: 1 | loss: 0.4726462
	speed: 0.0617s/iter; left time: 653.6012s
	iters: 200, epoch: 1 | loss: 0.3719271
	speed: 0.0298s/iter; left time: 312.6955s
	iters: 300, epoch: 1 | loss: 0.2509315
	speed: 0.0292s/iter; left time: 303.5146s
	iters: 400, epoch: 1 | loss: 0.1115090
	speed: 0.0302s/iter; left time: 310.7476s
	iters: 500, epoch: 1 | loss: 0.1070379
	speed: 0.0280s/iter; left time: 285.1777s
	iters: 600, epoch: 1 | loss: 0.1666017
	speed: 0.0254s/iter; left time: 256.4219s
	iters: 700, epoch: 1 | loss: 0.1405927
	speed: 0.0255s/iter; left time: 254.7171s
	iters: 800, epoch: 1 | loss: 0.0984153
	speed: 0.0253s/iter; left time: 250.9899s
	iters: 900, epoch: 1 | loss: 0.0894629
	speed: 0.0253s/iter; left time: 248.3942s
	iters: 1000, epoch: 1 | loss: 0.1735539
	speed: 0.0253s/iter; left time: 244.9792s
Epoch: 1 cost time: 32.513734102249146
Test is reading ....
[0.6157200944281837, 0.7495458698668119, 0.5874522366637477, 0.3900656354340662, 0.43476116199746034, 0.8905844352985358, 0.6307526609202595, 0.5077946962237165, 0.6063045904627326, 0.6510217886988736, 0.8186952847765125, 0.5411635782530557, 0.69701163118958, 0.5648229943724642, 0.6919519612091409, 0.6443372980715244, 0.607171359888449, 0.701667080505435, 0.6199415040401871, 0.6593918965467036, 0.6736858763846411, 0.5672487796103556, 0.5899975877821164]
Êñá‰ª∂ 'existing_file.xlsx' ‰∏çÂ≠òÂú®ÔºåÂ∞ÜÂàõÂª∫Êñ∞Êñá‰ª∂„ÄÇ
	iters: 100, epoch: 2 | loss: 0.0859713
	speed: 0.2126s/iter; left time: 2026.2254s
	iters: 200, epoch: 2 | loss: 0.0675151
	speed: 0.0332s/iter; left time: 313.3718s
	iters: 300, epoch: 2 | loss: 0.0869610
	speed: 0.0328s/iter; left time: 305.9264s
	iters: 400, epoch: 2 | loss: 0.0791943
	speed: 0.0339s/iter; left time: 312.9074s
	iters: 500, epoch: 2 | loss: 0.0594384
	speed: 0.0339s/iter; left time: 309.9407s
	iters: 600, epoch: 2 | loss: 0.1064120
	speed: 0.0358s/iter; left time: 323.4502s
	iters: 700, epoch: 2 | loss: 0.0897244
	speed: 0.0356s/iter; left time: 318.0817s
	iters: 800, epoch: 2 | loss: 0.0651366
	speed: 0.0335s/iter; left time: 295.4959s
	iters: 900, epoch: 2 | loss: 0.0714973
	speed: 0.0340s/iter; left time: 296.7955s
	iters: 1000, epoch: 2 | loss: 0.0635389
	speed: 0.0335s/iter; left time: 289.4816s
Epoch: 2 cost time: 37.069924116134644
Test is reading ....
[0.6560084242257089, 0.7532031448886678, 0.5703347733706929, 0.43641487978323446, 0.6087932119711514, 0.8129003531935391, 0.6664015830404646, 0.5527154151430411, 0.669357662888213, 0.6054196704985674, 0.7414783107411802, 0.5515639330131642, 0.7578845849930506, 0.497807878549928, 0.6366429992218016, 0.6548855672958005, 0.7068635993336231, 0.6730087457926393, 0.6281512790188039, 0.6752462860888753, 0.6382483530262522, 0.6073822809565635, 0.6073575158176162]
Epoch: 2, Steps: 1070, | Train Loss: 0.08034

	iters: 100, epoch: 3 | loss: 0.0755820
	speed: 0.4724s/iter; left time: 3997.1868s
	iters: 200, epoch: 3 | loss: 0.0653349
	speed: 0.0423s/iter; left time: 353.9244s
	iters: 300, epoch: 3 | loss: 0.0612976
	speed: 0.0416s/iter; left time: 343.8028s
	iters: 400, epoch: 3 | loss: 0.0808583
	speed: 0.0394s/iter; left time: 321.8995s
	iters: 500, epoch: 3 | loss: 0.0581817
	speed: 0.0361s/iter; left time: 290.5996s
	iters: 600, epoch: 3 | loss: 0.0412978
	speed: 0.0352s/iter; left time: 280.3698s
	iters: 700, epoch: 3 | loss: 0.0746970
	speed: 0.0357s/iter; left time: 280.7657s
	iters: 800, epoch: 3 | loss: 0.0841031
	speed: 0.0349s/iter; left time: 270.9914s
	iters: 900, epoch: 3 | loss: 0.0824184
	speed: 0.0354s/iter; left time: 271.0153s
	iters: 1000, epoch: 3 | loss: 0.0663829
	speed: 0.0337s/iter; left time: 255.0924s
Epoch: 3 cost time: 41.044700622558594
Test is reading ....
[0.674625715649678, 0.7556720679971661, 0.5870549235780685, 0.47652975539510933, 0.7692512640147746, 0.8523298170455428, 0.6045588064978684, 0.5043990349105464, 0.6169405789532967, 0.6753145281529852, 0.7139050620525355, 0.6888365245849939, 0.7715553862632828, 0.48857520285302963, 0.6030120051342532, 0.6495577032733268, 0.5827816468575464, 0.6852307840865198, 0.6078566668004346, 0.7083586348744371, 0.6607007129699045, 0.6033016858057186, 0.5913867488830928]
Epoch: 3, Steps: 1070, | Train Loss: 0.06654

	iters: 100, epoch: 4 | loss: 0.0429964
	speed: 0.4745s/iter; left time: 3506.6695s
	iters: 200, epoch: 4 | loss: 0.0491071
	speed: 0.0446s/iter; left time: 325.3133s
	iters: 300, epoch: 4 | loss: 0.0525913
	speed: 0.0432s/iter; left time: 310.7376s
	iters: 400, epoch: 4 | loss: 0.0664518
	speed: 0.0363s/iter; left time: 257.1229s
	iters: 500, epoch: 4 | loss: 0.0805414
	speed: 0.0365s/iter; left time: 255.1930s
	iters: 600, epoch: 4 | loss: 0.0638474
	speed: 0.0364s/iter; left time: 251.1765s
	iters: 700, epoch: 4 | loss: 0.0503246
	speed: 0.0363s/iter; left time: 246.1816s
	iters: 800, epoch: 4 | loss: 0.0412015
	speed: 0.0359s/iter; left time: 240.4439s
	iters: 900, epoch: 4 | loss: 0.0642728
	speed: 0.0353s/iter; left time: 232.5889s
	iters: 1000, epoch: 4 | loss: 0.0514795
	speed: 0.0338s/iter; left time: 219.5140s
Epoch: 4 cost time: 41.68817901611328
Test is reading ....
[0.6663576214557223, 0.7062685035531953, 0.5968916275437326, 0.5149924099394427, 0.8984604445833079, 0.7868742065646444, 0.6147506984791254, 0.4792327370900692, 0.5505309290490379, 0.6511933476649718, 0.7621291185949464, 0.5599558294994996, 0.6228893058161351, 0.5262175271561313, 0.6236663475832804, 0.6488151633197544, 0.6413126395338955, 0.6150471776195995, 0.5817130880972445, 0.6620822049733774, 0.6558982281901755, 0.5937711331683821, 0.6032809513519308]
Epoch: 4, Steps: 1070, | Train Loss: 0.05437

	iters: 100, epoch: 5 | loss: 0.0439763
	speed: 0.4736s/iter; left time: 2993.5504s
	iters: 200, epoch: 5 | loss: 0.0333086
	speed: 0.0430s/iter; left time: 267.5806s
	iters: 300, epoch: 5 | loss: 0.0479308
	speed: 0.0389s/iter; left time: 237.9999s
	iters: 400, epoch: 5 | loss: 0.0379497
	speed: 0.0359s/iter; left time: 216.1503s
	iters: 500, epoch: 5 | loss: 0.0568092
	speed: 0.0343s/iter; left time: 202.9925s
	iters: 600, epoch: 5 | loss: 0.0512206
	speed: 0.0359s/iter; left time: 208.9166s
	iters: 700, epoch: 5 | loss: 0.0414523
	speed: 0.0364s/iter; left time: 208.0545s
	iters: 800, epoch: 5 | loss: 0.0509134
	speed: 0.0362s/iter; left time: 203.6545s
	iters: 900, epoch: 5 | loss: 0.0569944
	speed: 0.0349s/iter; left time: 192.4495s
	iters: 1000, epoch: 5 | loss: 0.0469197
	speed: 0.0332s/iter; left time: 179.8963s
Epoch: 5 cost time: 40.79997420310974
Updating learning rate to 6.25e-06
Test is reading ....
[0.637804365608939, 0.6813724155215728, 0.5770296235069747, 0.4514753010179931, 0.7947806040574198, 0.7983195115703796, 0.561576307989694, 0.5027233752973704, 0.5099202326462488, 0.4609047112871934, 0.67539640433525, 0.516096258284306, 0.7385278596098804, 0.5470488156000523, 0.640578831004199, 0.6376396324440905, 0.6157239110051, 0.5992419853225184, 0.6050436831209175, 0.6603783903177305, 0.5455369444020584, 0.6006975978751538, 0.5956075857551834]
Epoch: 5, Steps: 1070, | Train Loss: 0.04476

	iters: 100, epoch: 6 | loss: 0.0271008
	speed: 0.4693s/iter; left time: 2464.4001s
	iters: 200, epoch: 6 | loss: 0.0426343
	speed: 0.0386s/iter; left time: 198.9598s
	iters: 300, epoch: 6 | loss: 0.0439858
	speed: 0.0370s/iter; left time: 186.7089s
	iters: 400, epoch: 6 | loss: 0.0238119
	speed: 0.0366s/iter; left time: 181.3252s
	iters: 500, epoch: 6 | loss: 0.0372195
	speed: 0.0355s/iter; left time: 172.0463s
	iters: 600, epoch: 6 | loss: 0.0390584
	speed: 0.0362s/iter; left time: 171.8755s
	iters: 700, epoch: 6 | loss: 0.0292524
	speed: 0.0356s/iter; left time: 165.6923s
	iters: 800, epoch: 6 | loss: 0.0332728
	speed: 0.0365s/iter; left time: 166.2694s
	iters: 900, epoch: 6 | loss: 0.0361334
	speed: 0.0371s/iter; left time: 165.1565s
	iters: 1000, epoch: 6 | loss: 0.0265270
	speed: 0.0348s/iter; left time: 151.5947s
Epoch: 6 cost time: 40.49136471748352
Test is reading ....
[0.666053060391807, 0.6993892569371674, 0.5828899618439364, 0.4393139745982346, 0.7729730221355396, 0.7975112152470211, 0.5882251973910059, 0.5004411073680011, 0.5097482054905333, 0.49976364565068776, 0.6835507330807717, 0.5117934987031498, 0.7339056402692288, 0.5302357348514593, 0.6593074567628681, 0.6440748792555198, 0.6238345831931228, 0.583805799260608, 0.6168134573756133, 0.6619170791261753, 0.5540521138098113, 0.6098847734026817, 0.6080158921604593]
Epoch: 6, Steps: 1070, | Train Loss: 0.03070

	iters: 100, epoch: 7 | loss: 0.0293827
	speed: 0.4459s/iter; left time: 1864.1728s
	iters: 200, epoch: 7 | loss: 0.0336443
	speed: 0.0380s/iter; left time: 155.0125s
	iters: 300, epoch: 7 | loss: 0.0335042
	speed: 0.0383s/iter; left time: 152.3036s
	iters: 400, epoch: 7 | loss: 0.0233517
	speed: 0.0382s/iter; left time: 148.1962s
	iters: 500, epoch: 7 | loss: 0.0288049
	speed: 0.0370s/iter; left time: 139.9627s
	iters: 600, epoch: 7 | loss: 0.0356627
	speed: 0.0358s/iter; left time: 131.6036s
	iters: 700, epoch: 7 | loss: 0.0243383
	speed: 0.0355s/iter; left time: 126.9642s
	iters: 800, epoch: 7 | loss: 0.0226882
	speed: 0.0364s/iter; left time: 126.5403s
	iters: 900, epoch: 7 | loss: 0.0271886
	speed: 0.0363s/iter; left time: 122.5923s
	iters: 1000, epoch: 7 | loss: 0.0236531
	speed: 0.0355s/iter; left time: 116.4942s
Epoch: 7 cost time: 40.145798206329346
Test is reading ....
[0.6712658415493552, 0.6882000367061554, 0.5835204159216304, 0.4491810533226692, 0.7847684648075441, 0.7952176513088878, 0.5878932910515211, 0.49555850807685753, 0.5111735733521744, 0.5412384568850979, 0.6907067688224893, 0.5072536662543796, 0.7291652315094341, 0.526779871744536, 0.6649891587022726, 0.6490845189730954, 0.6288583216616028, 0.5763567014291233, 0.616881993804181, 0.6581339216785025, 0.5617157939198528, 0.6111360515188453, 0.6194230862652669]
Epoch: 7, Steps: 1070, | Train Loss: 0.02717

	iters: 100, epoch: 8 | loss: 0.0208991
	speed: 0.4269s/iter; left time: 1328.0603s
	iters: 200, epoch: 8 | loss: 0.0276062
	speed: 0.0370s/iter; left time: 111.4766s
	iters: 300, epoch: 8 | loss: 0.0427795
	speed: 0.0372s/iter; left time: 108.2156s
	iters: 400, epoch: 8 | loss: 0.0325845
	speed: 0.0370s/iter; left time: 103.9958s
	iters: 500, epoch: 8 | loss: 0.0246374
	speed: 0.0381s/iter; left time: 103.1821s
	iters: 600, epoch: 8 | loss: 0.0228202
	speed: 0.0367s/iter; left time: 95.9018s
	iters: 700, epoch: 8 | loss: 0.0223713
	speed: 0.0372s/iter; left time: 93.3114s
	iters: 800, epoch: 8 | loss: 0.0252181
	speed: 0.0376s/iter; left time: 90.6406s
	iters: 900, epoch: 8 | loss: 0.0239642
	speed: 0.0371s/iter; left time: 85.7368s
	iters: 1000, epoch: 8 | loss: 0.0297108
	speed: 0.0377s/iter; left time: 83.3015s
Epoch: 8 cost time: 40.56927824020386
Test is reading ....
[0.672893862209662, 0.6911507774403179, 0.5795681478598215, 0.42753532506678704, 0.7593092772170783, 0.7981531707819856, 0.5991965867096549, 0.4976918123000751, 0.5104311942575697, 0.5655076758856474, 0.6844721037907985, 0.5101616458326127, 0.7218560601455822, 0.5196861503729878, 0.6622106771771904, 0.6481932721230785, 0.6386553199251811, 0.577287838658059, 0.6164360742396666, 0.6611709943843007, 0.5719358492944384, 0.6157012623928632, 0.6228409393578475]
Epoch: 8, Steps: 1070, | Train Loss: 0.02498

	iters: 100, epoch: 9 | loss: 0.0228422
	speed: 0.4238s/iter; left time: 864.9328s
	iters: 200, epoch: 9 | loss: 0.0215946
	speed: 0.0370s/iter; left time: 71.8007s
	iters: 300, epoch: 9 | loss: 0.0204740
	speed: 0.0378s/iter; left time: 69.5029s
	iters: 400, epoch: 9 | loss: 0.0193276
	speed: 0.0388s/iter; left time: 67.6281s
	iters: 500, epoch: 9 | loss: 0.0213856
	speed: 0.0390s/iter; left time: 64.0552s
	iters: 600, epoch: 9 | loss: 0.0179076
	speed: 0.0383s/iter; left time: 58.9619s
	iters: 700, epoch: 9 | loss: 0.0177256
	speed: 0.0377s/iter; left time: 54.2787s
	iters: 800, epoch: 9 | loss: 0.0276289
	speed: 0.0362s/iter; left time: 48.5646s
	iters: 900, epoch: 9 | loss: 0.0188321
	speed: 0.0356s/iter; left time: 44.1799s
	iters: 1000, epoch: 9 | loss: 0.0228217
	speed: 0.0363s/iter; left time: 41.4475s
Epoch: 9 cost time: 40.590842485427856
Test is reading ....
[0.6779818458236955, 0.6967245676666134, 0.5766569124938999, 0.425302740945883, 0.7584871760782412, 0.7983262085729798, 0.6078197462502677, 0.49510994609715947, 0.5142035040293266, 0.5866388504189786, 0.6830744935854725, 0.5164210551246226, 0.6954954297840038, 0.5151035531998429, 0.6694403539933544, 0.6525154314794872, 0.6265176416448262, 0.5704112177895492, 0.6193258564889677, 0.6573503729003272, 0.5614229433007587, 0.6132325287978787, 0.6301807404503812]
Epoch: 9, Steps: 1070, | Train Loss: 0.02359

	iters: 100, epoch: 10 | loss: 0.0219173
	speed: 0.4288s/iter; left time: 416.4045s
	iters: 200, epoch: 10 | loss: 0.0242517
	speed: 0.0358s/iter; left time: 31.1937s
	iters: 300, epoch: 10 | loss: 0.0221282
	speed: 0.0363s/iter; left time: 28.0147s
	iters: 400, epoch: 10 | loss: 0.0251217
	speed: 0.0365s/iter; left time: 24.5197s
	iters: 500, epoch: 10 | loss: 0.0228830
	speed: 0.0383s/iter; left time: 21.8650s
	iters: 600, epoch: 10 | loss: 0.0202348
	speed: 0.0390s/iter; left time: 18.3674s
	iters: 700, epoch: 10 | loss: 0.0211304
	speed: 0.0399s/iter; left time: 14.8120s
	iters: 800, epoch: 10 | loss: 0.0275428
	speed: 0.0361s/iter; left time: 9.7904s
	iters: 900, epoch: 10 | loss: 0.0234834
	speed: 0.0384s/iter; left time: 6.5713s
	iters: 1000, epoch: 10 | loss: 0.0235858
	speed: 0.0372s/iter; left time: 2.6384s
Epoch: 10 cost time: 40.790722131729126
Updating learning rate to 1.953125e-07
Test is reading ....
[0.6789869799212254, 0.693890003887695, 0.5781971090754404, 0.43163323231388934, 0.7523349598358821, 0.804848323733871, 0.6059354669167845, 0.49897246317850247, 0.5137130218413049, 0.6018131953160106, 0.6829144273418031, 0.5279244258754244, 0.7081416976322944, 0.5150912838633687, 0.6793854442701612, 0.6565981332001063, 0.6209045009462911, 0.5714147768029576, 0.620821736827983, 0.6633819051900652, 0.5713640801604625, 0.6187484412245167, 0.62751733362816]
Epoch: 10, Steps: 1070, | Train Loss: 0.02243

