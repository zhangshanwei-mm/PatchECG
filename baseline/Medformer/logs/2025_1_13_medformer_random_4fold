nohup: ignoring input
Args in experiment:
Namespace(task_name='my_classification', is_training=1, model_id='PTB-XL-Indep', model='Medformer', data='my_data', root_path='./', data_path='ETTh1.csv', features='M', target='OT', freq='h', seq_len=96, label_len=48, pred_len=96, seasonal_patterns='Monthly', inverse=False, mask_rate=0.25, anomaly_ratio=0.25, expand=2, d_conv=4, top_k=5, num_kernels=6, enc_in=7, dec_in=7, c_out=7, d_model=128, n_heads=8, e_layers=6, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, no_inter_attn=False, chunk_size=16, patch_len=16, stride=8, sampling_rate=256, patch_len_list='2,4,8,8,16,16,16,16,32,32,32,32,32,32,32,32', single_channel=False, augmentations='flip0.5,shuffle0.5,frequency0.1,jitter0.2,scale0.2,mask0.1,drop0.5', num_workers=0, itr=5, train_epochs=30, batch_size=32, patience=10, learning_rate=0.0001, des='Exp', loss='MSE', lradj='type1', use_amp=False, swa=True, use_gpu=True, gpu=8, use_multi_gpu=False, devices='0,1,2,3', p_hidden_dims=[128, 128], p_hidden_layers=2)
Use GPU: cuda:8
>>>>>>>start training : my_classification_PTB-XL-Indep_Medformer_my_data_ftM_sl96_ll48_pl96_dm128_nh8_el6_dl1_df256_fc1_ebtimeF_dtTrue_Exp_seed41>>>>>>>>>>>>>>>>>>>>>>>>>>
TRAIN
Label to index mapping:
{'NORM': 0, 'LAFB/LPFB': 1, 'IRBBB': 2, 'ILBBB': 3, 'CLBBB': 4, 'CRBBB': 5, '_AVB': 6, 'IVCD': 7, 'WPW': 8, 'LVH': 9, 'RVH': 10, 'LAO/LAE': 11, 'RAO/RAE': 12, 'SEHYP': 13, 'AMI': 14, 'IMI': 15, 'LMI': 16, 'PMI': 17, 'ISCA': 18, 'ISCI': 19, 'ISC_': 20, 'STTC': 21, 'NST_': 22}
删除train中缺失label的数量:325
(17125, 1000, 12)
VAL
Label to index mapping:
{'NORM': 0, 'LAFB/LPFB': 1, 'IRBBB': 2, 'ILBBB': 3, 'CLBBB': 4, 'CRBBB': 5, '_AVB': 6, 'IVCD': 7, 'WPW': 8, 'LVH': 9, 'RVH': 10, 'LAO/LAE': 11, 'RAO/RAE': 12, 'SEHYP': 13, 'AMI': 14, 'IMI': 15, 'LMI': 16, 'PMI': 17, 'ISCA': 18, 'ISCI': 19, 'ISC_': 20, 'STTC': 21, 'NST_': 22}
删除val中缺失label的数量:42
(2134, 1000, 12)
TEST
Label to index mapping:
{'NORM': 0, 'LAFB/LPFB': 1, 'IRBBB': 2, 'ILBBB': 3, 'CLBBB': 4, 'CRBBB': 5, '_AVB': 6, 'IVCD': 7, 'WPW': 8, 'LVH': 9, 'RVH': 10, 'LAO/LAE': 11, 'RAO/RAE': 12, 'SEHYP': 13, 'AMI': 14, 'IMI': 15, 'LMI': 16, 'PMI': 17, 'ISCA': 18, 'ISCI': 19, 'ISC_': 20, 'STTC': 21, 'NST_': 22}
删除test中缺失label的数量:44
(2129, 1000, 12)
(17125, 1000, 12)
torch.Size([17125, 23])
(2134, 1000, 12)
torch.Size([2134, 23])
(2129, 1000, 12)
torch.Size([2129, 23])
	iters: 100, epoch: 1 | loss: 0.0677255
	speed: 0.3895s/iter; left time: 6225.0435s
	iters: 200, epoch: 1 | loss: 0.0737521
	speed: 0.2401s/iter; left time: 3812.2907s
	iters: 300, epoch: 1 | loss: 0.0418537
	speed: 0.2478s/iter; left time: 3911.3101s
	iters: 400, epoch: 1 | loss: 0.0520217
	speed: 0.2389s/iter; left time: 3745.9034s
	iters: 500, epoch: 1 | loss: 0.0428706
	speed: 0.2384s/iter; left time: 3714.6764s
Epoch: 1 cost time: 144.4672167301178
Test is reading ....
[0.7264643188801762, 0.8856023031754175, 0.7841632514576022, 0.8086397925506836, 0.9901740294511379, 0.9050602409638554, 0.7017405984398649, 0.6803241741278172, 0.932991513437058, 0.8118610759896889, 0.8110367892976589, 0.653113781801155, 0.5132609721566777, 0.641110065851364, 0.7659823359769287, 0.6295982496793008, 0.6970839260312944, 0.6227080394922426, 0.5895863985613864, 0.6274293920536141, 0.7915651549225388, 0.550783370636697, 0.47811447811447816]
文件 'existing_file.xlsx' 不存在，将创建新文件。
	iters: 100, epoch: 2 | loss: 0.0383469
	speed: 0.3684s/iter; left time: 5690.1680s
	iters: 200, epoch: 2 | loss: 0.0543975
	speed: 0.2263s/iter; left time: 3472.4349s
	iters: 300, epoch: 2 | loss: 0.0514512
	speed: 0.2272s/iter; left time: 3463.0184s
	iters: 400, epoch: 2 | loss: 0.0458928
	speed: 0.2333s/iter; left time: 3533.7598s
	iters: 500, epoch: 2 | loss: 0.0355000
	speed: 0.2406s/iter; left time: 3619.0973s
Epoch: 2 cost time: 124.78184604644775
Test is reading ....
[0.749498477954543, 0.8962259848355282, 0.8138956597826766, 0.8335690711928336, 0.9929406514948683, 0.9415350290049086, 0.7177436255675865, 0.6907070083359061, 0.9378830740216879, 0.8215962441314554, 0.8659662643594591, 0.6692122455350176, 0.5779613025011798, 0.7649733458764503, 0.787577505407354, 0.6654757408409298, 0.7065433854907539, 0.6619652092148567, 0.6045392621655495, 0.6623863092388702, 0.8065029985007496, 0.5906436020762893, 0.5183602946760841]
Epoch: 2, Steps: 536, | Train Loss: 0.04401

	iters: 100, epoch: 3 | loss: 0.0359625
	speed: 0.3548s/iter; left time: 5289.9908s
	iters: 200, epoch: 3 | loss: 0.0304967
	speed: 0.2235s/iter; left time: 3310.2991s
	iters: 300, epoch: 3 | loss: 0.0473913
	speed: 0.2240s/iter; left time: 3294.7687s
	iters: 400, epoch: 3 | loss: 0.0283705
	speed: 0.2231s/iter; left time: 3259.1270s
	iters: 500, epoch: 3 | loss: 0.0331707
	speed: 0.2242s/iter; left time: 3252.7988s
Epoch: 3 cost time: 119.71999335289001
Test is reading ....
[0.7662857967522527, 0.8989082720483439, 0.8327931499388387, 0.8395214521452146, 0.9948058902275769, 0.9521642124051762, 0.7307777389684481, 0.7046928064217352, 0.9434229137199435, 0.8280724710125751, 0.8813436091318889, 0.6802715779616044, 0.7038697498820199, 0.8088742552524302, 0.7974945926459985, 0.6779753580433427, 0.6714082503556188, 0.6753643629525152, 0.6697782137213231, 0.6847235519387266, 0.8234788855572214, 0.6511512452973951, 0.5481063770537454]
Epoch: 3, Steps: 536, | Train Loss: 0.03761

	iters: 100, epoch: 4 | loss: 0.0358670
	speed: 0.3497s/iter; left time: 5026.1229s
	iters: 200, epoch: 4 | loss: 0.0319065
	speed: 0.2238s/iter; left time: 3194.3863s
	iters: 300, epoch: 4 | loss: 0.0361759
	speed: 0.2243s/iter; left time: 3178.6627s
	iters: 400, epoch: 4 | loss: 0.0308948
	speed: 0.2245s/iter; left time: 3159.1052s
	iters: 500, epoch: 4 | loss: 0.0324075
	speed: 0.2228s/iter; left time: 3112.5278s
Epoch: 4 cost time: 120.06251907348633
Test is reading ....
[0.7835325079508499, 0.9011316344564165, 0.8391235636032464, 0.842173503064592, 0.9955823293172691, 0.9568049977688532, 0.7312085225288161, 0.7105958629206546, 0.9387081565299387, 0.8339238632910896, 0.9023920314090447, 0.6888782358581016, 0.7070316186880604, 0.8513640639698965, 0.8079794520547945, 0.6935322519726836, 0.6880512091038407, 0.6455101081335214, 0.7129148275298348, 0.73744614648157, 0.8388462018990503, 0.678177532263441, 0.5765993265993267]
Epoch: 4, Steps: 536, | Train Loss: 0.03426

	iters: 100, epoch: 5 | loss: 0.0281158
	speed: 0.3503s/iter; left time: 4846.4874s
	iters: 200, epoch: 5 | loss: 0.0338527
	speed: 0.2249s/iter; left time: 3089.6507s
	iters: 300, epoch: 5 | loss: 0.0255445
	speed: 0.2252s/iter; left time: 3071.4229s
	iters: 400, epoch: 5 | loss: 0.0286060
	speed: 0.2241s/iter; left time: 3033.1286s
	iters: 500, epoch: 5 | loss: 0.0295671
	speed: 0.2250s/iter; left time: 3023.9142s
Epoch: 5 cost time: 120.29292345046997
Test is reading ....
[0.789558839875081, 0.9029103243828743, 0.8438512843864677, 0.8431753889674682, 0.9962070504239179, 0.9601517179830432, 0.7256258004424263, 0.7136461870947824, 0.927982083922678, 0.8381604869299304, 0.9174058455721972, 0.695455863006979, 0.7126002831524304, 0.8485418626528692, 0.8140933669790915, 0.7108372548819452, 0.6860834518729256, 0.6502115655853314, 0.7303144242820555, 0.7398396361895644, 0.8484234445277362, 0.6927901328634698, 0.5930989088883826]
Epoch: 5, Steps: 536, | Train Loss: 0.03200

	iters: 100, epoch: 6 | loss: 0.0254709
	speed: 0.3639s/iter; left time: 4840.2745s
	iters: 200, epoch: 6 | loss: 0.0298180
	speed: 0.2322s/iter; left time: 3064.7599s
	iters: 300, epoch: 6 | loss: 0.0221285
	speed: 0.2332s/iter; left time: 3054.6778s
	iters: 400, epoch: 6 | loss: 0.0309066
	speed: 0.2313s/iter; left time: 3007.0009s
	iters: 500, epoch: 6 | loss: 0.0388837
	speed: 0.2299s/iter; left time: 2965.3751s
Epoch: 6 cost time: 124.6952109336853
Test is reading ....
[0.7929327969422842, 0.9059033122398952, 0.8486906133090475, 0.8146511079679396, 0.9964747880410532, 0.9639178937974119, 0.7237280242170218, 0.7219018215498612, 0.9180221593587929, 0.8389764474109794, 0.9286025883379381, 0.7029699658855271, 0.7122227465785748, 0.8493258074631546, 0.8169412400865177, 0.7211089901289263, 0.685941204362257, 0.6819464033850493, 0.7422429295406245, 0.7437051220679751, 0.8541588580709644, 0.7020298585646936, 0.6113389534442166]
Epoch: 6, Steps: 536, | Train Loss: 0.03006

	iters: 100, epoch: 7 | loss: 0.0252919
	speed: 0.3637s/iter; left time: 4643.1919s
	iters: 200, epoch: 7 | loss: 0.0236232
	speed: 0.2379s/iter; left time: 3013.3273s
	iters: 300, epoch: 7 | loss: 0.0259188
	speed: 0.2443s/iter; left time: 3069.2254s
	iters: 400, epoch: 7 | loss: 0.0258752
	speed: 0.2387s/iter; left time: 2975.9605s
	iters: 500, epoch: 7 | loss: 0.0405114
	speed: 0.2333s/iter; left time: 2884.4138s
Epoch: 7 cost time: 127.04393339157104
Test is reading ....
[0.7985817548162252, 0.9080639644262015, 0.8523290386521307, 0.7885431400282885, 0.9967157518964748, 0.9682016956715752, 0.7156304575619978, 0.728175362766286, 0.913071664309288, 0.8408019445832966, 0.9356914352188453, 0.7067716114071663, 0.7128362435110901, 0.8466603951081845, 0.8185418168709446, 0.7317014246875521, 0.6734708392603129, 0.7235543018335684, 0.7448313443409078, 0.7456318812829104, 0.8583481696651675, 0.7068217534168295, 0.6245601377180324]
Epoch: 7, Steps: 536, | Train Loss: 0.02851

	iters: 100, epoch: 8 | loss: 0.0225497
	speed: 0.3564s/iter; left time: 4358.6678s
	iters: 200, epoch: 8 | loss: 0.0321195
	speed: 0.2315s/iter; left time: 2807.7131s
	iters: 300, epoch: 8 | loss: 0.0244152
	speed: 0.2324s/iter; left time: 2795.5493s
	iters: 400, epoch: 8 | loss: 0.0212534
	speed: 0.2332s/iter; left time: 2781.6287s
	iters: 500, epoch: 8 | loss: 0.0261461
	speed: 0.2303s/iter; left time: 2724.7117s
Epoch: 8 cost time: 123.93581175804138
Test is reading ....
[0.7995014359934172, 0.91031013055128, 0.8537754801382155, 0.7694483734087695, 0.9968763944667559, 0.9725301204819277, 0.7115962277331471, 0.7322198209323866, 0.906058462989156, 0.8439285679280975, 0.9394721535553294, 0.7081651764810809, 0.7103350637092968, 0.8488554405769834, 0.8192537851478009, 0.7411667330182484, 0.6770981507823614, 0.7338975082275505, 0.7463026538063321, 0.7455600765916706, 0.8621392428785608, 0.7095599790466212, 0.6341959697222855]
Epoch: 8, Steps: 536, | Train Loss: 0.02670

	iters: 100, epoch: 9 | loss: 0.0270289
	speed: 0.3618s/iter; left time: 4231.0621s
	iters: 200, epoch: 9 | loss: 0.0284804
	speed: 0.2265s/iter; left time: 2626.2429s
	iters: 300, epoch: 9 | loss: 0.0199117
	speed: 0.2281s/iter; left time: 2621.8290s
	iters: 400, epoch: 9 | loss: 0.0294291
	speed: 0.2310s/iter; left time: 2632.3351s
	iters: 500, epoch: 9 | loss: 0.0281754
	speed: 0.2337s/iter; left time: 2639.0712s
Epoch: 9 cost time: 123.42471504211426
Test is reading ....
[0.8016634934976925, 0.9115700359158544, 0.8560790721345726, 0.763024516737388, 0.9970102632753235, 0.9759303882195449, 0.703009663523111, 0.7326891015745601, 0.9011669024045262, 0.8455384359042215, 0.9425621637341864, 0.7105509598876228, 0.7194431335535629, 0.8576356224521794, 0.8203839221341025, 0.7492845938432537, 0.6784020862968231, 0.7757404795486601, 0.7435998038254047, 0.7453207276208711, 0.8642241379310345, 0.7114576884613553, 0.6393762183235867]
Epoch: 9, Steps: 536, | Train Loss: 0.02534

	iters: 100, epoch: 10 | loss: 0.0283209
	speed: 0.3642s/iter; left time: 4063.0958s
	iters: 200, epoch: 10 | loss: 0.0285345
	speed: 0.2338s/iter; left time: 2584.8657s
	iters: 300, epoch: 10 | loss: 0.0220771
	speed: 0.2333s/iter; left time: 2556.7077s
	iters: 400, epoch: 10 | loss: 0.0288304
	speed: 0.2346s/iter; left time: 2547.2382s
	iters: 500, epoch: 10 | loss: 0.0300755
	speed: 0.2332s/iter; left time: 2509.0054s
Epoch: 10 cost time: 125.4899206161499
Test is reading ....
[0.8000679452565607, 0.9124479790205804, 0.8556147822748417, 0.7537718057520038, 0.997153056671129, 0.9789736724676484, 0.6985737571312144, 0.7354245137388082, 0.8955681282413956, 0.8472610191419918, 0.9448887596335611, 0.7105621084082142, 0.7277961302501179, 0.8632800250862339, 0.8213644556596972, 0.7561256120508083, 0.6686581318160266, 0.7917254348848143, 0.7408479101956297, 0.7484202967927238, 0.8653876186906546, 0.7128196580789562, 0.643806485911749]
Epoch: 10, Steps: 536, | Train Loss: 0.02342

	iters: 100, epoch: 11 | loss: 0.0138081
	speed: 0.3591s/iter; left time: 3814.0949s
	iters: 200, epoch: 11 | loss: 0.0223824
	speed: 0.2348s/iter; left time: 2469.8775s
	iters: 300, epoch: 11 | loss: 0.0197743
	speed: 0.2327s/iter; left time: 2424.6598s
	iters: 400, epoch: 11 | loss: 0.0213629
	speed: 0.2252s/iter; left time: 2324.2902s
	iters: 500, epoch: 11 | loss: 0.0171827
	speed: 0.2245s/iter; left time: 2295.0722s
Epoch: 11 cost time: 122.74746870994568
Test is reading ....
[0.7997147733425123, 0.9140014822416055, 0.8566862204126823, 0.7530645921735031, 0.9972958500669344, 0.9809638554216867, 0.6889276982186516, 0.7324668107440567, 0.8866100895803866, 0.8478466484361983, 0.9471790024720081, 0.706515195433566, 0.7315714959886739, 0.8686108497961744, 0.8217375630857966, 0.765298292892895, 0.6724039829302988, 0.8142924306535025, 0.7402375892321944, 0.752896122546673, 0.8649698588205896, 0.7129339492356779, 0.6502430318219793]
Epoch: 11, Steps: 536, | Train Loss: 0.02167

	iters: 100, epoch: 12 | loss: 0.0200271
	speed: 0.3596s/iter; left time: 3626.6525s
	iters: 200, epoch: 12 | loss: 0.0157265
	speed: 0.2265s/iter; left time: 2262.0474s
	iters: 300, epoch: 12 | loss: 0.0168429
	speed: 0.2225s/iter; left time: 2199.2288s
	iters: 400, epoch: 12 | loss: 0.0145295
	speed: 0.2239s/iter; left time: 2190.4945s
	iters: 500, epoch: 12 | loss: 0.0276741
	speed: 0.2280s/iter; left time: 2207.8705s
Epoch: 12 cost time: 121.65818858146667
Test is reading ....
[0.7999406599474365, 0.9155236303517473, 0.8580478397128546, 0.7442833569071193, 0.997260151717983, 0.9834984381972334, 0.6782163232040982, 0.7298672429762272, 0.8803041018387553, 0.8482779068285846, 0.9500508942852988, 0.7029811144061183, 0.7326097215667768, 0.8698651614926309, 0.8229668348954579, 0.7736237150761002, 0.673660502607871, 0.8298072402444758, 0.7398561386300475, 0.7577788415509813, 0.8641187218890555, 0.7136006476498882, 0.6507999797473482]
Epoch: 12, Steps: 536, | Train Loss: 0.01972

	iters: 100, epoch: 13 | loss: 0.0224926
	speed: 0.3605s/iter; left time: 3442.4163s
	iters: 200, epoch: 13 | loss: 0.0083582
	speed: 0.2328s/iter; left time: 2199.7723s
	iters: 300, epoch: 13 | loss: 0.0264474
	speed: 0.2289s/iter; left time: 2140.0307s
	iters: 400, epoch: 13 | loss: 0.0194017
	speed: 0.2239s/iter; left time: 2071.1728s
	iters: 500, epoch: 13 | loss: 0.0312094
	speed: 0.2261s/iter; left time: 2068.4633s
Epoch: 13 cost time: 122.51691198348999
Test is reading ....
[0.8003879512802033, 0.9172396100564392, 0.8578648023643067, 0.7301980198019803, 0.9972244533690316, 0.9846407853636769, 0.6742635929677495, 0.7249583204692805, 0.8763554926921263, 0.8502259205896479, 0.9496873636760216, 0.6998037860375927, 0.727748938178386, 0.8728441517717153, 0.8230335255948089, 0.7792193651344556, 0.6780938833570412, 0.8333333333333334, 0.7374312026592555, 0.7589875538535185, 0.8630723700649675, 0.7116553169198534, 0.6556922609554189]
Epoch: 13, Steps: 536, | Train Loss: 0.01809

	iters: 100, epoch: 14 | loss: 0.0184639
	speed: 0.3616s/iter; left time: 3259.0434s
	iters: 200, epoch: 14 | loss: 0.0183724
	speed: 0.2339s/iter; left time: 2085.0993s
	iters: 300, epoch: 14 | loss: 0.0172179
	speed: 0.2323s/iter; left time: 2047.7005s
	iters: 400, epoch: 14 | loss: 0.0123340
	speed: 0.2301s/iter; left time: 2004.7481s
	iters: 500, epoch: 14 | loss: 0.0131432
	speed: 0.2314s/iter; left time: 1993.0781s
Epoch: 14 cost time: 124.61425542831421
Test is reading ....
[0.8013865134940356, 0.9187133002679436, 0.8587264172001535, 0.7132248939179632, 0.9970905845604641, 0.985640339134315, 0.6640994295028526, 0.7241432540907687, 0.8714049976426214, 0.8522964509394573, 0.9510324269303476, 0.6935606145064549, 0.730486078338839, 0.8755095641266855, 0.8236517664023072, 0.7839796657921869, 0.6796348980559508, 0.8370944992947814, 0.7357528200098087, 0.7625897558640498, 0.8622524675162418, 0.7103100147626077, 0.659071922229817]
Epoch: 14, Steps: 536, | Train Loss: 0.01626

	iters: 100, epoch: 15 | loss: 0.0143998
	speed: 0.3746s/iter; left time: 3175.8387s
	iters: 200, epoch: 15 | loss: 0.0275514
	speed: 0.2297s/iter; left time: 1923.9338s
	iters: 300, epoch: 15 | loss: 0.0143545
	speed: 0.2326s/iter; left time: 1925.1451s
	iters: 400, epoch: 15 | loss: 0.0117976
	speed: 0.2297s/iter; left time: 1878.5721s
	iters: 500, epoch: 15 | loss: 0.0174765
	speed: 0.2382s/iter; left time: 1924.2951s
Epoch: 15 cost time: 125.63594007492065
Test is reading ....
[0.8012457825536661, 0.9197309161393308, 0.8596594612451898, 0.6999646393210749, 0.9970727353859884, 0.9864792503346721, 0.6558737920596112, 0.7242976227230626, 0.8676921263554926, 0.8538573122800828, 0.9530681983423004, 0.6872951459341345, 0.730486078338839, 0.8770774537472562, 0.8248341744772891, 0.7888794749037902, 0.678212422949265, 0.845322049835449, 0.7339545528854013, 0.7648157012924844, 0.8605931409295353, 0.7111576741749608, 0.6627617022353864]
Epoch: 15, Steps: 536, | Train Loss: 0.01472

	iters: 100, epoch: 16 | loss: 0.0103161
	speed: 0.3751s/iter; left time: 2978.5697s
	iters: 200, epoch: 16 | loss: 0.0097425
	speed: 0.2416s/iter; left time: 1894.7682s
	iters: 300, epoch: 16 | loss: 0.0117233
	speed: 0.2303s/iter; left time: 1782.9291s
	iters: 400, epoch: 16 | loss: 0.0122843
	speed: 0.2319s/iter; left time: 1771.8335s
	iters: 500, epoch: 16 | loss: 0.0103890
	speed: 0.2329s/iter; left time: 1756.1319s
Epoch: 16 cost time: 126.3745048046112
Test is reading ....
[0.8014420887698503, 0.9204520836896414, 0.8598916061750552, 0.6967821782178217, 0.9970638107987505, 0.9870593485051317, 0.6504016765630458, 0.7229824019759186, 0.8647454031117398, 0.8551902927656404, 0.9544132615966265, 0.6832816785212602, 0.7312411514865503, 0.876450297899028, 0.8252379235760634, 0.7912545212648313, 0.6803698435277382, 0.847202632816173, 0.7319492125769713, 0.7664911440880804, 0.8585550974512743, 0.7108814705462165, 0.6642553353079669]
Epoch: 16, Steps: 536, | Train Loss: 0.01323

	iters: 100, epoch: 17 | loss: 0.0140390
	speed: 0.3580s/iter; left time: 2650.6670s
	iters: 200, epoch: 17 | loss: 0.0087360
	speed: 0.2301s/iter; left time: 1681.2085s
	iters: 300, epoch: 17 | loss: 0.0141466
	speed: 0.2356s/iter; left time: 1697.6252s
	iters: 400, epoch: 17 | loss: 0.0112979
	speed: 0.2363s/iter; left time: 1678.8811s
	iters: 500, epoch: 17 | loss: 0.0161970
	speed: 0.2389s/iter; left time: 1673.6833s
Epoch: 17 cost time: 125.8160753250122
Test is reading ....
[0.8009410149121015, 0.9210506812610455, 0.8614496558004981, 0.6951909476661952, 0.9970816599732263, 0.9874074074074074, 0.6464431249272324, 0.7208644643408461, 0.8622112211221122, 0.8567707567604654, 0.9548131452668315, 0.6767151998929742, 0.7326097215667767, 0.8769206647851991, 0.8259931506849314, 0.7926836322557157, 0.6803224276908488, 0.8502585801598496, 0.7303689172252192, 0.7687051220679751, 0.857434563968016, 0.7100480975284538, 0.6679008126376547]
Epoch: 17, Steps: 536, | Train Loss: 0.01190

	iters: 100, epoch: 18 | loss: 0.0105011
	speed: 0.3666s/iter; left time: 2518.3287s
	iters: 200, epoch: 18 | loss: 0.0124522
	speed: 0.2394s/iter; left time: 1620.2219s
	iters: 300, epoch: 18 | loss: 0.0059453
	speed: 0.2297s/iter; left time: 1532.0550s
	iters: 400, epoch: 18 | loss: 0.0065335
	speed: 0.2404s/iter; left time: 1579.1025s
	iters: 500, epoch: 18 | loss: 0.0060858
	speed: 0.2408s/iter; left time: 1557.4784s
Epoch: 18 cost time: 127.09170770645142
Test is reading ....
[0.8008182114800593, 0.9217632974174791, 0.8621594835668176, 0.6924210278170675, 0.9969477911646586, 0.9879428826416778, 0.6361159622773315, 0.7188391478851497, 0.8603253182461102, 0.8578832073862801, 0.9560127962774467, 0.6727574750830564, 0.7360075507314772, 0.8747256193164001, 0.8267519826964672, 0.7944359945421572, 0.6846846846846847, 0.8493182886694876, 0.728428968448586, 0.7697941598851126, 0.8547562156421789, 0.70850040478118, 0.6702108807371965]
Epoch: 18, Steps: 536, | Train Loss: 0.01103

	iters: 100, epoch: 19 | loss: 0.0092154
	speed: 0.3637s/iter; left time: 2303.6073s
	iters: 200, epoch: 19 | loss: 0.0077483
	speed: 0.2307s/iter; left time: 1437.8374s
	iters: 300, epoch: 19 | loss: 0.0108434
	speed: 0.2320s/iter; left time: 1423.0227s
	iters: 400, epoch: 19 | loss: 0.0068272
	speed: 0.2325s/iter; left time: 1402.5899s
	iters: 500, epoch: 19 | loss: 0.0115372
	speed: 0.2336s/iter; left time: 1385.9459s
Epoch: 19 cost time: 124.23203706741333
Test is reading ....
[0.8020202509134067, 0.9226497919160823, 0.8619898391949928, 0.6906529938708156, 0.9968496207050423, 0.9883355644801428, 0.628443357783211, 0.7191293609138623, 0.8603253182461104, 0.8587359228439531, 0.9563036207648685, 0.6702936520323752, 0.7348277489381784, 0.8723737848855441, 0.8281308579668348, 0.7967497932893031, 0.688620199146515, 0.848613070051716, 0.7278349953680998, 0.770428434657731, 0.8516757246376812, 0.7072336777941807, 0.6724639882534619]
Epoch: 19, Steps: 536, | Train Loss: 0.01011

	iters: 100, epoch: 20 | loss: 0.0121064
	speed: 0.3745s/iter; left time: 2170.9405s
	iters: 200, epoch: 20 | loss: 0.0119795
	speed: 0.2374s/iter; left time: 1352.5072s
	iters: 300, epoch: 20 | loss: 0.0192291
	speed: 0.2313s/iter; left time: 1294.4450s
	iters: 400, epoch: 20 | loss: 0.0173733
	speed: 0.2308s/iter; left time: 1268.7167s
	iters: 500, epoch: 20 | loss: 0.0051448
	speed: 0.2312s/iter; left time: 1247.9934s
Epoch: 20 cost time: 125.46297073364258
Test is reading ....
[0.8023465315649638, 0.9233937631833989, 0.8626327020776972, 0.6916548797736917, 0.9968763944667559, 0.9885676037483266, 0.6209453952730236, 0.7194442729237418, 0.8608557284299859, 0.8596241681123624, 0.9561218554602298, 0.6685433342995385, 0.7349693251533742, 0.8620257133897774, 0.8290537130497477, 0.7977178458533665, 0.6934566145092461, 0.846262341325811, 0.7262056563675005, 0.7718884633796074, 0.8479510244877562, 0.7056740797180818, 0.6752993595098858]
Epoch: 20, Steps: 536, | Train Loss: 0.00933

	iters: 100, epoch: 21 | loss: 0.0072714
	speed: 0.3528s/iter; left time: 1855.8723s
	iters: 200, epoch: 21 | loss: 0.0039026
	speed: 0.2287s/iter; left time: 1180.1675s
	iters: 300, epoch: 21 | loss: 0.0068028
	speed: 0.2333s/iter; left time: 1180.7593s
	iters: 400, epoch: 21 | loss: 0.0110277
	speed: 0.2307s/iter; left time: 1144.3020s
	iters: 500, epoch: 21 | loss: 0.0082377
	speed: 0.2294s/iter; left time: 1115.1462s
Epoch: 21 cost time: 123.13467288017273
Test is reading ....
[0.802659814772984, 0.9235505387378143, 0.8634362806810775, 0.6855846298915607, 0.9968317715305667, 0.9886925479696564, 0.6146233554546514, 0.7191664093856128, 0.8617397454031118, 0.8604683074088232, 0.956085502399302, 0.6657450556311177, 0.7336007550731477, 0.8559109438695516, 0.8303280461427541, 0.798697807675687, 0.6952821242294928, 0.8455571227080395, 0.7244836793635224, 0.772510770703686, 0.8452765804597702, 0.7041049573789228, 0.6776189210399737]
Epoch: 21, Steps: 536, | Train Loss: 0.00820

	iters: 100, epoch: 22 | loss: 0.0038178
	speed: 0.3731s/iter; left time: 1762.8077s
	iters: 200, epoch: 22 | loss: 0.0038880
	speed: 0.2323s/iter; left time: 1074.2566s
	iters: 300, epoch: 22 | loss: 0.0049275
	speed: 0.2302s/iter; left time: 1041.4483s
	iters: 400, epoch: 22 | loss: 0.0063525
	speed: 0.2382s/iter; left time: 1053.8998s
	iters: 500, epoch: 22 | loss: 0.0076587
	speed: 0.2350s/iter; left time: 1016.2202s
Epoch: 22 cost time: 126.16457009315491
Test is reading ....
[0.8022533085216618, 0.924163388632347, 0.863802355378173, 0.6832272512965583, 0.9967782240071397, 0.9888978134761268, 0.6083187798346723, 0.7191540598950292, 0.8629184347006128, 0.8621369833475452, 0.9551039697542534, 0.6647305402573078, 0.7347805568664464, 0.850266541235497, 0.8317357606344628, 0.8000673723752845, 0.6961356092935039, 0.84579219558063, 0.7217699307939621, 0.7719961704164672, 0.843328335832084, 0.7010452878708509, 0.6780397964608491]
Epoch: 22, Steps: 536, | Train Loss: 0.00791

	iters: 100, epoch: 23 | loss: 0.0052603
	speed: 0.3729s/iter; left time: 1561.9173s
	iters: 200, epoch: 23 | loss: 0.0101378
	speed: 0.2466s/iter; left time: 1008.5100s
	iters: 300, epoch: 23 | loss: 0.0042809
	speed: 0.2427s/iter; left time: 968.0894s
	iters: 400, epoch: 23 | loss: 0.0042579
	speed: 0.2334s/iter; left time: 907.8834s
	iters: 500, epoch: 23 | loss: 0.0047851
	speed: 0.2337s/iter; left time: 885.3854s
Epoch: 23 cost time: 128.36514806747437
Test is reading ....
[0.8018535250859624, 0.9244968929935579, 0.8641818230519916, 0.6802805280528054, 0.9967425256581882, 0.9890941543953593, 0.6042670858074282, 0.7191417104044459, 0.8636845827439886, 0.8630191027865172, 0.9549949105714701, 0.6633592722245757, 0.7374233128834357, 0.8410159924741298, 0.8323738284066331, 0.8009520601315463, 0.6988383119962068, 0.8413258110014105, 0.7200207073184022, 0.7736476783149833, 0.8409271926536732, 0.6980689556645554, 0.6770967823599402]
Epoch: 23, Steps: 536, | Train Loss: 0.00719

	iters: 100, epoch: 24 | loss: 0.0052000
	speed: 0.3566s/iter; left time: 1302.6295s
	iters: 200, epoch: 24 | loss: 0.0047428
	speed: 0.2426s/iter; left time: 862.0868s
	iters: 300, epoch: 24 | loss: 0.0072302
	speed: 0.2507s/iter; left time: 865.7263s
	iters: 400, epoch: 24 | loss: 0.0069993
	speed: 0.2462s/iter; left time: 825.4914s
	iters: 500, epoch: 24 | loss: 0.0142484
	speed: 0.2290s/iter; left time: 744.9012s
Epoch: 24 cost time: 127.76873087882996
Test is reading ....
[0.8021717383587724, 0.9246109115785873, 0.8643514674238161, 0.6773927392739274, 0.9967425256581882, 0.9892637215528781, 0.5965770171149144, 0.7189379438098178, 0.8651579443658652, 0.8639330765385632, 0.9539770248654937, 0.6620548953153916, 0.7348749410099104, 0.8309814989024773, 0.8320620043258832, 0.8011409069410561, 0.7002607871028924, 0.8354489891866479, 0.7173886981635879, 0.7740785064624222, 0.8380184907546228, 0.6946140292394876, 0.6763752816384395]
Epoch: 24, Steps: 536, | Train Loss: 0.00671

	iters: 100, epoch: 25 | loss: 0.0039099
	speed: 0.3619s/iter; left time: 1128.1205s
	iters: 200, epoch: 25 | loss: 0.0025665
	speed: 0.2248s/iter; left time: 678.2613s
	iters: 300, epoch: 25 | loss: 0.0049942
	speed: 0.2276s/iter; left time: 664.0431s
	iters: 400, epoch: 25 | loss: 0.0089032
	speed: 0.2554s/iter; left time: 719.3805s
	iters: 500, epoch: 25 | loss: 0.0158915
	speed: 0.2370s/iter; left time: 643.9066s
Epoch: 25 cost time: 127.05844354629517
Test is reading ....
[0.8016195711022908, 0.9250242289493188, 0.8654050482593594, 0.6760372465818011, 0.9966622043730478, 0.9893618920124945, 0.5900745139131447, 0.7188453226304414, 0.8666902404526168, 0.8646510237486155, 0.9526319616111676, 0.6612633503534081, 0.7356300141576215, 0.8240827845719662, 0.8327505407354001, 0.8014658595592214, 0.7044333807491702, 0.8298072402444758, 0.7152089804370333, 0.7738870272857826, 0.8359453085957023, 0.6912567265107863, 0.6744702665755298]
Epoch: 25, Steps: 536, | Train Loss: 0.00611

	iters: 100, epoch: 26 | loss: 0.0049352
	speed: 0.3909s/iter; left time: 1008.9166s
	iters: 200, epoch: 26 | loss: 0.0030307
	speed: 0.2503s/iter; left time: 621.0350s
	iters: 300, epoch: 26 | loss: 0.0053247
	speed: 0.2591s/iter; left time: 616.9721s
	iters: 400, epoch: 26 | loss: 0.0059796
	speed: 0.2440s/iter; left time: 556.6040s
	iters: 500, epoch: 26 | loss: 0.0294650
	speed: 0.2514s/iter; left time: 548.2215s
Epoch: 26 cost time: 135.04814863204956
Test is reading ....
[0.8005295785959893, 0.9249700701214298, 0.8664117536763721, 0.6759783121169259, 0.9966622043730478, 0.9893172690763052, 0.584544184421935, 0.7178234022846558, 0.8674563884959925, 0.8649769178746803, 0.9517594881489022, 0.66034917166492, 0.7392638036809815, 0.8204766384446536, 0.8337599134823359, 0.8010830619723773, 0.7083214793741109, 0.8354489891866478, 0.7137431202659257, 0.7724748683580661, 0.8333489505247376, 0.688230391923425, 0.6731665021138705]
Epoch: 26, Steps: 536, | Train Loss: 0.00597

	iters: 100, epoch: 27 | loss: 0.0026748
	speed: 0.4064s/iter; left time: 831.0939s
	iters: 200, epoch: 27 | loss: 0.0050471
	speed: 0.2638s/iter; left time: 513.1345s
	iters: 300, epoch: 27 | loss: 0.0030500
	speed: 0.2919s/iter; left time: 538.5582s
	iters: 400, epoch: 27 | loss: 0.0024817
	speed: 0.2799s/iter; left time: 488.3633s
	iters: 500, epoch: 27 | loss: 0.0081354
	speed: 0.2530s/iter; left time: 416.1858s
Epoch: 27 cost time: 144.69654965400696
Test is reading ....
[0.8001584791736136, 0.9249501168690497, 0.8666193448155787, 0.6744460160301745, 0.9966800535475234, 0.9894243641231594, 0.5811735941320294, 0.7167582587218279, 0.8698727015558698, 0.8653469179726935, 0.9511051330522031, 0.6581529131084306, 0.7405851816894762, 0.8154593916588272, 0.834313266041817, 0.8013586762349051, 0.7087956377430061, 0.8338034790785143, 0.7120538390278459, 0.7732647199617041, 0.8311781609195402, 0.6857374160674318, 0.6714893293840662]
Epoch: 27, Steps: 536, | Train Loss: 0.00557

	iters: 100, epoch: 28 | loss: 0.0056065
	speed: 0.3888s/iter; left time: 586.6582s
	iters: 200, epoch: 28 | loss: 0.0038211
	speed: 0.2385s/iter; left time: 336.0645s
	iters: 300, epoch: 28 | loss: 0.0039290
	speed: 0.2648s/iter; left time: 346.6094s
	iters: 400, epoch: 28 | loss: 0.0125090
	speed: 0.2696s/iter; left time: 325.8868s
	iters: 500, epoch: 28 | loss: 0.0059815
	speed: 0.2742s/iter; left time: 304.0374s
Epoch: 28 cost time: 139.0199248790741
Test is reading ....
[0.7999361780703547, 0.9249273131520438, 0.8665925588621327, 0.6742692126355493, 0.9966979027219991, 0.9894065149486836, 0.5772557922924672, 0.7160049397962334, 0.8707567185289958, 0.8658516863183277, 0.9504871310164316, 0.6563691498138197, 0.741764983482775, 0.8126371903417999, 0.834835976928623, 0.8015730428835377, 0.7076813655761025, 0.8368594264221909, 0.710854994278241, 0.7726902824317855, 0.8292338205897053, 0.6836206486023144, 0.6713817371712109]
Epoch: 28, Steps: 536, | Train Loss: 0.00558

	iters: 100, epoch: 29 | loss: 0.0060065
	speed: 0.4184s/iter; left time: 407.0683s
	iters: 200, epoch: 29 | loss: 0.0017137
	speed: 0.2693s/iter; left time: 235.1112s
	iters: 300, epoch: 29 | loss: 0.0225204
	speed: 0.2709s/iter; left time: 209.3806s
	iters: 400, epoch: 29 | loss: 0.0040310
	speed: 0.2651s/iter; left time: 178.3870s
	iters: 500, epoch: 29 | loss: 0.0074855
	speed: 0.2581s/iter; left time: 147.8702s
Epoch: 29 cost time: 143.43165969848633
Test is reading ....
[0.7989627143681808, 0.9250156775554415, 0.8669139903034848, 0.6688472418670438, 0.9966800535475234, 0.9893172690763052, 0.5732390266620095, 0.7155603581352269, 0.8715228665723715, 0.8661432757995432, 0.9483423004216955, 0.65476376284867, 0.7432751297781972, 0.8146754468485419, 0.8354217736121125, 0.8012676554753667, 0.7072546230440968, 0.8377997179125529, 0.7095417143479918, 0.7719842029679274, 0.8267780172413793, 0.6806633649221392, 0.6703121439963545]
Epoch: 29, Steps: 536, | Train Loss: 0.00494

	iters: 100, epoch: 30 | loss: 0.0021048
	speed: 0.4048s/iter; left time: 176.9000s
	iters: 200, epoch: 30 | loss: 0.0039932
	speed: 0.2751s/iter; left time: 92.7211s
	iters: 300, epoch: 30 | loss: 0.0026463
	speed: 0.2623s/iter; left time: 62.1671s
	iters: 400, epoch: 30 | loss: 0.0075823
	speed: 0.2553s/iter; left time: 34.9719s
	iters: 500, epoch: 30 | loss: 0.0152040
	speed: 0.2493s/iter; left time: 9.2255s
Epoch: 30 cost time: 140.25662231445312
Test is reading ....
[0.79960183004005, 0.9249843224445585, 0.8670925633264583, 0.6635431400282885, 0.9966175814368585, 0.9893083444890673, 0.5705786471067644, 0.7144921271997531, 0.8711692597831212, 0.8665426798788555, 0.9477242983859242, 0.6498918593502643, 0.7429447852760737, 0.8140482910003135, 0.835659697188176, 0.8012565968784132, 0.7062351825509721, 0.8345086976962859, 0.7086480300801046, 0.771218286261369, 0.8255676849075462, 0.6785323110624316, 0.6695589985063669]
Epoch: 30, Steps: 536, | Train Loss: 0.00429

>>>>>>>testing : my_classification_PTB-XL-Indep_Medformer_my_data_ftM_sl96_ll48_pl96_dm128_nh8_el6_dl1_df256_fc1_ebtimeF_dtTrue_Exp_seed41<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
Traceback (most recent call last):
  File "/data/0shared/zhangshanwei/cinc/baseline/Medformer-main/run.py", line 301, in <module>
    exp.test(setting)
TypeError: Exp_Basic.test() takes 1 positional argument but 2 were given
