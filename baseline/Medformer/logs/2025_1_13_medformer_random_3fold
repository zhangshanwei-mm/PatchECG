nohup: ignoring input
Args in experiment:
Namespace(task_name='my_classification', is_training=1, model_id='PTB-XL-Indep', model='Medformer', data='my_data', root_path='./', data_path='ETTh1.csv', features='M', target='OT', freq='h', seq_len=96, label_len=48, pred_len=96, seasonal_patterns='Monthly', inverse=False, mask_rate=0.25, anomaly_ratio=0.25, expand=2, d_conv=4, top_k=5, num_kernels=6, enc_in=7, dec_in=7, c_out=7, d_model=128, n_heads=8, e_layers=6, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, no_inter_attn=False, chunk_size=16, patch_len=16, stride=8, sampling_rate=256, patch_len_list='2,4,8,8,16,16,16,16,32,32,32,32,32,32,32,32', single_channel=False, augmentations='flip0.5,shuffle0.5,frequency0.1,jitter0.2,scale0.2,mask0.1,drop0.5', num_workers=0, itr=5, train_epochs=30, batch_size=32, patience=10, learning_rate=0.0001, des='Exp', loss='MSE', lradj='type1', use_amp=False, swa=True, use_gpu=True, gpu=8, use_multi_gpu=False, devices='0,1,2,3', p_hidden_dims=[128, 128], p_hidden_layers=2)
Use GPU: cuda:8
>>>>>>>start training : my_classification_PTB-XL-Indep_Medformer_my_data_ftM_sl96_ll48_pl96_dm128_nh8_el6_dl1_df256_fc1_ebtimeF_dtTrue_Exp_seed41>>>>>>>>>>>>>>>>>>>>>>>>>>
TRAIN
Label to index mapping:
{'NORM': 0, 'LAFB/LPFB': 1, 'IRBBB': 2, 'ILBBB': 3, 'CLBBB': 4, 'CRBBB': 5, '_AVB': 6, 'IVCD': 7, 'WPW': 8, 'LVH': 9, 'RVH': 10, 'LAO/LAE': 11, 'RAO/RAE': 12, 'SEHYP': 13, 'AMI': 14, 'IMI': 15, 'LMI': 16, 'PMI': 17, 'ISCA': 18, 'ISCI': 19, 'ISC_': 20, 'STTC': 21, 'NST_': 22}
删除train中缺失label的数量:328
(17124, 1000, 12)
VAL
Label to index mapping:
{'NORM': 0, 'LAFB/LPFB': 1, 'IRBBB': 2, 'ILBBB': 3, 'CLBBB': 4, 'CRBBB': 5, '_AVB': 6, 'IVCD': 7, 'WPW': 8, 'LVH': 9, 'RVH': 10, 'LAO/LAE': 11, 'RAO/RAE': 12, 'SEHYP': 13, 'AMI': 14, 'IMI': 15, 'LMI': 16, 'PMI': 17, 'ISCA': 18, 'ISCI': 19, 'ISC_': 20, 'STTC': 21, 'NST_': 22}
删除val中缺失label的数量:39
(2135, 1000, 12)
TEST
Label to index mapping:
{'NORM': 0, 'LAFB/LPFB': 1, 'IRBBB': 2, 'ILBBB': 3, 'CLBBB': 4, 'CRBBB': 5, '_AVB': 6, 'IVCD': 7, 'WPW': 8, 'LVH': 9, 'RVH': 10, 'LAO/LAE': 11, 'RAO/RAE': 12, 'SEHYP': 13, 'AMI': 14, 'IMI': 15, 'LMI': 16, 'PMI': 17, 'ISCA': 18, 'ISCI': 19, 'ISC_': 20, 'STTC': 21, 'NST_': 22}
删除test中缺失label的数量:44
(2129, 1000, 12)
(17124, 1000, 12)
torch.Size([17124, 23])
(2135, 1000, 12)
torch.Size([2135, 23])
(2129, 1000, 12)
torch.Size([2129, 23])
	iters: 100, epoch: 1 | loss: 0.0645593
	speed: 0.2545s/iter; left time: 4067.2170s
	iters: 200, epoch: 1 | loss: 0.0552264
	speed: 0.2340s/iter; left time: 3715.5500s
	iters: 300, epoch: 1 | loss: 0.0432413
	speed: 0.2330s/iter; left time: 3677.6567s
	iters: 400, epoch: 1 | loss: 0.0370478
	speed: 0.2307s/iter; left time: 3617.4069s
	iters: 500, epoch: 1 | loss: 0.0552216
	speed: 0.2272s/iter; left time: 3540.1772s
Epoch: 1 cost time: 126.36808943748474
Test is reading ....
[0.7290246352246944, 0.90630282194528, 0.7195622919470217, 0.7497642621404997, 0.981613771040099, 0.8424764605373178, 0.6956922743055556, 0.5872491509725224, 0.7197076850542197, 0.8018642785681169, 0.8250669185954967, 0.6822894601886329, 0.6618972746331236, 0.5065851364063969, 0.7448847144069549, 0.6593543820966419, 0.7652678994784258, 0.8120300751879699, 0.6343160602498016, 0.5498803255146003, 0.8051987382696044, 0.5578665907518857, 0.5195413643704976]
文件 'existing_file.xlsx' 不存在，将创建新文件。
	iters: 100, epoch: 2 | loss: 0.0393253
	speed: 0.3664s/iter; left time: 5658.9798s
	iters: 200, epoch: 2 | loss: 0.0513332
	speed: 0.2345s/iter; left time: 3598.8095s
	iters: 300, epoch: 2 | loss: 0.0501750
	speed: 0.2338s/iter; left time: 3564.7529s
	iters: 400, epoch: 2 | loss: 0.0467656
	speed: 0.2349s/iter; left time: 3557.7761s
	iters: 500, epoch: 2 | loss: 0.0445767
	speed: 0.2314s/iter; left time: 3482.1247s
Epoch: 2 cost time: 125.70687174797058
Test is reading ....
[0.7813904059834809, 0.9185360263572554, 0.7507082654578936, 0.8002710985384253, 0.9921292761842441, 0.8873014141854801, 0.6845100308641976, 0.6239950602037666, 0.6839344648750589, 0.8249652277884874, 0.9023382144544165, 0.6484759972351668, 0.6044025157232704, 0.5321417372216997, 0.7741892923112034, 0.6901517239501989, 0.7440730203888098, 0.9595864661654135, 0.724766125061546, 0.67498803255146, 0.8414302233199872, 0.6351879126101667, 0.5744097213320687]
Epoch: 2, Steps: 536, | Train Loss: 0.04387

	iters: 100, epoch: 3 | loss: 0.0486604
	speed: 0.3643s/iter; left time: 5431.2832s
	iters: 200, epoch: 3 | loss: 0.0388587
	speed: 0.2353s/iter; left time: 3484.9165s
	iters: 300, epoch: 3 | loss: 0.0379869
	speed: 0.2361s/iter; left time: 3473.0974s
	iters: 400, epoch: 3 | loss: 0.0402137
	speed: 0.2312s/iter; left time: 3377.3022s
	iters: 500, epoch: 3 | loss: 0.0325624
	speed: 0.2335s/iter; left time: 3387.6054s
Epoch: 3 cost time: 125.435378074646
Test is reading ....
[0.8046382738303425, 0.9236670964045265, 0.7779211523479, 0.7984441301272984, 0.9947377031301123, 0.9177663867379212, 0.6810016396604939, 0.6277678295770299, 0.7241867043847242, 0.8331543886191163, 0.956778460085026, 0.6596022207853017, 0.6159329140461216, 0.5410787080589526, 0.7897330566193828, 0.7058617369142772, 0.7040303461356093, 0.9821428571428572, 0.7472040514876556, 0.7055528961225467, 0.8598960095023087, 0.6831506829977555, 0.6253813418104444]
Epoch: 3, Steps: 536, | Train Loss: 0.03701

	iters: 100, epoch: 4 | loss: 0.0384673
	speed: 0.3662s/iter; left time: 5262.8094s
	iters: 200, epoch: 4 | loss: 0.0365534
	speed: 0.2361s/iter; left time: 3370.1560s
	iters: 300, epoch: 4 | loss: 0.0369759
	speed: 0.2360s/iter; left time: 3344.7557s
	iters: 400, epoch: 4 | loss: 0.0262594
	speed: 0.2334s/iter; left time: 3284.5493s
	iters: 500, epoch: 4 | loss: 0.0292730
	speed: 0.2355s/iter; left time: 3290.4396s
Epoch: 4 cost time: 126.43557071685791
Test is reading ....
[0.812704135166402, 0.9266723965047988, 0.7926243005878604, 0.8108793022159357, 0.9963100301741376, 0.9385792707310867, 0.683865017361111, 0.645199135535659, 0.7388613861386139, 0.8399965837827286, 0.9665407022516139, 0.6559009119489844, 0.60062893081761, 0.5678896205707118, 0.7994572698032335, 0.7155541718131676, 0.7454243717401613, 0.9769736842105263, 0.7487665671881751, 0.7148396361895644, 0.8708378235937291, 0.7031559531147803, 0.6574140538877639]
Epoch: 4, Steps: 536, | Train Loss: 0.03413

	iters: 100, epoch: 5 | loss: 0.0307025
	speed: 0.3599s/iter; left time: 4980.1193s
	iters: 200, epoch: 5 | loss: 0.0275035
	speed: 0.2304s/iter; left time: 3164.5165s
	iters: 300, epoch: 5 | loss: 0.0283053
	speed: 0.2342s/iter; left time: 3194.4197s
	iters: 400, epoch: 5 | loss: 0.0319884
	speed: 0.2313s/iter; left time: 3130.8733s
	iters: 500, epoch: 5 | loss: 0.0283633
	speed: 0.2347s/iter; left time: 3154.1036s
Epoch: 5 cost time: 124.39144349098206
Test is reading ....
[0.8177576295658567, 0.929766509096118, 0.8077236348183299, 0.8243752946723244, 0.9970098520376631, 0.9506761915148871, 0.6826533564814814, 0.6508613769681999, 0.7375648279113626, 0.8423537737000074, 0.9717760982522438, 0.6586991906174051, 0.57520964360587, 0.623549702100972, 0.8048810058694738, 0.7280316718216742, 0.7274537695590326, 0.9774436090225564, 0.7527105376862709, 0.7122546673049306, 0.876194671470262, 0.7105423515073946, 0.6790576050452483]
Epoch: 5, Steps: 536, | Train Loss: 0.03174

	iters: 100, epoch: 6 | loss: 0.0331601
	speed: 0.3674s/iter; left time: 4887.1723s
	iters: 200, epoch: 6 | loss: 0.0386107
	speed: 0.2353s/iter; left time: 3105.7752s
	iters: 300, epoch: 6 | loss: 0.0221498
	speed: 0.2380s/iter; left time: 3118.0108s
	iters: 400, epoch: 6 | loss: 0.0323167
	speed: 0.2367s/iter; left time: 3077.3024s
	iters: 500, epoch: 6 | loss: 0.0292031
	speed: 0.2366s/iter; left time: 3053.0094s
Epoch: 6 cost time: 127.02105259895325
Test is reading ....
[0.8201108450590546, 0.9329265148259562, 0.8182944967773923, 0.8240806223479491, 0.9972552441196787, 0.9592830915766896, 0.6793740354938271, 0.6546711948132139, 0.7518269684111268, 0.8448354115321735, 0.9745709337112265, 0.6532587125688422, 0.5744758909853249, 0.6511445594230166, 0.8074538037470492, 0.7367985872217061, 0.7316737790422001, 0.9788533834586466, 0.7547503491795536, 0.7094782192436573, 0.8809300935285187, 0.7108187973781166, 0.6861332581331555]
Epoch: 6, Steps: 536, | Train Loss: 0.02946

	iters: 100, epoch: 7 | loss: 0.0363220
	speed: 0.3683s/iter; left time: 4701.9394s
	iters: 200, epoch: 7 | loss: 0.0211094
	speed: 0.2378s/iter; left time: 3012.1696s
	iters: 300, epoch: 7 | loss: 0.0255534
	speed: 0.2352s/iter; left time: 2955.0945s
	iters: 400, epoch: 7 | loss: 0.0349561
	speed: 0.2361s/iter; left time: 2942.7643s
	iters: 500, epoch: 7 | loss: 0.0264323
	speed: 0.2374s/iter; left time: 2935.5873s
Epoch: 7 cost time: 126.67978286743164
Test is reading ....
[0.8194046113696898, 0.9365878813923507, 0.8244652595792902, 0.8197194719471947, 0.9973370414803504, 0.9670265750536227, 0.671558521412037, 0.6471935782648968, 0.7609028760018859, 0.8470998755520851, 0.9779955912454732, 0.6449419162077192, 0.5718029350104822, 0.6798369394794607, 0.808612721709921, 0.7466271279292522, 0.7196538643907064, 0.9774436090225564, 0.7538158542589858, 0.7107108664432743, 0.8843636678282347, 0.7121504430192125, 0.6940613223267619]
Epoch: 7, Steps: 536, | Train Loss: 0.02809

	iters: 100, epoch: 8 | loss: 0.0217048
	speed: 0.3686s/iter; left time: 4507.1213s
	iters: 200, epoch: 8 | loss: 0.0249975
	speed: 0.2387s/iter; left time: 2894.5869s
	iters: 300, epoch: 8 | loss: 0.0238745
	speed: 0.2356s/iter; left time: 2833.6314s
	iters: 400, epoch: 8 | loss: 0.0422040
	speed: 0.2403s/iter; left time: 2866.0625s
	iters: 500, epoch: 8 | loss: 0.0220531
	speed: 0.2340s/iter; left time: 2768.1003s
Epoch: 8 cost time: 127.26183104515076
Test is reading ....
[0.8202561274180096, 0.9397851310700471, 0.8268113889085629, 0.8118811881188119, 0.99731886428909, 0.9719071509070418, 0.6637550636574073, 0.6487249150972522, 0.7692126355492692, 0.8490056367584978, 0.9788615965989607, 0.6421213404981159, 0.558700209643606, 0.6862652869238006, 0.8101941989915631, 0.7551456502284876, 0.708511142721669, 0.9783834586466166, 0.7584380871994293, 0.7152584968884634, 0.8860470238422994, 0.7126868656449542, 0.6956828261594072]
Epoch: 8, Steps: 536, | Train Loss: 0.02643

	iters: 100, epoch: 9 | loss: 0.0216581
	speed: 0.3671s/iter; left time: 4292.9464s
	iters: 200, epoch: 9 | loss: 0.0257985
	speed: 0.2357s/iter; left time: 2731.9422s
	iters: 300, epoch: 9 | loss: 0.0259434
	speed: 0.2347s/iter; left time: 2697.6254s
	iters: 400, epoch: 9 | loss: 0.0204329
	speed: 0.2348s/iter; left time: 2674.7056s
	iters: 500, epoch: 9 | loss: 0.0161741
	speed: 0.2361s/iter; left time: 2666.7978s
Epoch: 9 cost time: 126.25996804237366
Test is reading ....
[0.8198651205753898, 0.9427847013321874, 0.8320414866491961, 0.8112918434700613, 0.9973279528847203, 0.97674228378231, 0.6560691550925926, 0.6489595554183389, 0.771923620933522, 0.8509382396720433, 0.9800031491103763, 0.642723360610047, 0.5611635220125786, 0.6948886798369395, 0.8112675353202535, 0.7628951747088187, 0.7087719298245613, 0.9788533834586466, 0.7616284327615831, 0.7197343226424127, 0.8889712649555169, 0.7155266117382445, 0.7002397005665649]
Epoch: 9, Steps: 536, | Train Loss: 0.02470

	iters: 100, epoch: 10 | loss: 0.0196986
	speed: 0.3661s/iter; left time: 4084.7307s
	iters: 200, epoch: 10 | loss: 0.0306342
	speed: 0.2334s/iter; left time: 2580.1567s
	iters: 300, epoch: 10 | loss: 0.0311622
	speed: 0.2336s/iter; left time: 2559.9668s
	iters: 400, epoch: 10 | loss: 0.0255984
	speed: 0.2327s/iter; left time: 2526.5889s
	iters: 500, epoch: 10 | loss: 0.0209456
	speed: 0.2331s/iter; left time: 2507.7025s
Epoch: 10 cost time: 125.43986225128174
Test is reading ....
[0.8210906041773162, 0.9456381607219596, 0.8381569162121962, 0.8042786421499293, 0.9973552186716108, 0.9797596975315375, 0.6465747974537037, 0.6450077184316148, 0.7732201791607731, 0.8522559234767332, 0.9816957959376476, 0.6351646636491337, 0.5725890985324947, 0.698338037002195, 0.8133625024069834, 0.7674972523639878, 0.7088667614983404, 0.9765037593984962, 0.7607994453320472, 0.7206677836285305, 0.8899093032951301, 0.7147843251662205, 0.7024764785807676]
Epoch: 10, Steps: 536, | Train Loss: 0.02314

	iters: 100, epoch: 11 | loss: 0.0226779
	speed: 0.3614s/iter; left time: 3838.9314s
	iters: 200, epoch: 11 | loss: 0.0183292
	speed: 0.2340s/iter; left time: 2462.4381s
	iters: 300, epoch: 11 | loss: 0.0174880
	speed: 0.2319s/iter; left time: 2416.8364s
	iters: 400, epoch: 11 | loss: 0.0240344
	speed: 0.2327s/iter; left time: 2401.4993s
	iters: 500, epoch: 11 | loss: 0.0183991
	speed: 0.2354s/iter; left time: 2406.3054s
Epoch: 11 cost time: 125.01120829582214
Test is reading ....
[0.8220389751316061, 0.9477381463973643, 0.8412024576811389, 0.8018033946251768, 0.9974006616497619, 0.9832860726360563, 0.6380449459876543, 0.6443346711948131, 0.7711574728901462, 0.8525438617896098, 0.983034167847583, 0.6275167785234899, 0.5775681341719077, 0.6997491376607086, 0.8142486289109025, 0.7739401610812247, 0.7055713608345188, 0.9793233082706767, 0.7638692109044504, 0.7235758736237434, 0.8902396815782643, 0.7141761442506318, 0.6982400594765042]
Epoch: 11, Steps: 536, | Train Loss: 0.02125

	iters: 100, epoch: 12 | loss: 0.0273243
	speed: 0.3642s/iter; left time: 3672.9361s
	iters: 200, epoch: 12 | loss: 0.0137117
	speed: 0.2340s/iter; left time: 2336.9605s
	iters: 300, epoch: 12 | loss: 0.0168248
	speed: 0.2331s/iter; left time: 2303.8305s
	iters: 400, epoch: 12 | loss: 0.0203203
	speed: 0.2329s/iter; left time: 2278.8448s
	iters: 500, epoch: 12 | loss: 0.0166027
	speed: 0.2357s/iter; left time: 2282.8312s
Epoch: 12 cost time: 125.45623445510864
Test is reading ....
[0.8231241088003444, 0.9499126199684859, 0.8436548268290956, 0.7884842055634135, 0.99731886428909, 0.9854309812047843, 0.6286530671296295, 0.6474529175671504, 0.7629066478076378, 0.8526731900148848, 0.9829160762084711, 0.6211509732658477, 0.5840146750524109, 0.702728127939793, 0.8140649849875549, 0.7782411046347429, 0.7013750592697962, 0.9788533834586466, 0.7631809001296236, 0.7239588319770225, 0.8909004381445326, 0.7130044843049327, 0.6954456892352655]
Epoch: 12, Steps: 536, | Train Loss: 0.01963

	iters: 100, epoch: 13 | loss: 0.0166023
	speed: 0.3711s/iter; left time: 3544.0786s
	iters: 200, epoch: 13 | loss: 0.0176057
	speed: 0.2323s/iter; left time: 2195.2741s
	iters: 300, epoch: 13 | loss: 0.0175366
	speed: 0.2381s/iter; left time: 2225.6643s
	iters: 400, epoch: 13 | loss: 0.0182248
	speed: 0.2320s/iter; left time: 2145.4272s
	iters: 500, epoch: 13 | loss: 0.0267020
	speed: 0.2334s/iter; left time: 2135.1161s
Epoch: 13 cost time: 125.61779737472534
Test is reading ....
[0.825561175531581, 0.9514797306976077, 0.8466605283660316, 0.7736327204148986, 0.9972461555240484, 0.9870760170138511, 0.6248492959104939, 0.6502562519296079, 0.7533003300330033, 0.8530709353114859, 0.9831128956069909, 0.61905505139468, 0.5914046121593292, 0.7002195045468799, 0.8154360740851678, 0.7805940338018775, 0.6978425794215267, 0.9783834586466166, 0.7644670866869643, 0.7257060794638582, 0.8909201035185288, 0.7130021315741181, 0.6962660548106749]
Epoch: 13, Steps: 536, | Train Loss: 0.01733

	iters: 100, epoch: 14 | loss: 0.0138594
	speed: 0.3645s/iter; left time: 3285.6887s
	iters: 200, epoch: 14 | loss: 0.0145874
	speed: 0.2342s/iter; left time: 2087.5089s
	iters: 300, epoch: 14 | loss: 0.0187059
	speed: 0.2322s/iter; left time: 2046.7944s
	iters: 400, epoch: 14 | loss: 0.0120234
	speed: 0.2353s/iter; left time: 2049.7718s
	iters: 500, epoch: 14 | loss: 0.0151213
	speed: 0.2336s/iter; left time: 2011.7385s
Epoch: 14 cost time: 125.70120930671692
Test is reading ....
[0.8275247293891863, 0.9530095974788713, 0.8491571641051066, 0.7683286185761433, 0.9970825608027049, 0.9879485221943505, 0.619972511574074, 0.64822476072862, 0.7483498349834983, 0.8542300090285743, 0.9832309872461029, 0.6185199224062967, 0.589412997903564, 0.7013170272812794, 0.8177129021445332, 0.7840689852291172, 0.6974632527264106, 0.9779135338345865, 0.7641957817100252, 0.7275490665390139, 0.891561194710801, 0.7118892898987855, 0.6986630604763249]
Epoch: 14, Steps: 536, | Train Loss: 0.01565

	iters: 100, epoch: 15 | loss: 0.0088426
	speed: 0.3674s/iter; left time: 3114.0564s
	iters: 200, epoch: 15 | loss: 0.0267185
	speed: 0.2314s/iter; left time: 1938.0749s
	iters: 300, epoch: 15 | loss: 0.0114023
	speed: 0.2352s/iter; left time: 1947.0396s
	iters: 400, epoch: 15 | loss: 0.0286961
	speed: 0.2329s/iter; left time: 1904.3336s
	iters: 500, epoch: 15 | loss: 0.0140661
	speed: 0.2339s/iter; left time: 1889.1961s
Epoch: 15 cost time: 125.46754431724548
Test is reading ....
[0.8294259553211907, 0.9539492909325311, 0.8500380692683618, 0.7452852428099953, 0.9970189406332933, 0.9886937870360272, 0.6189597800925926, 0.6479777709169497, 0.739922206506365, 0.855289036382714, 0.9835852621634388, 0.6200249726861244, 0.5954926624737945, 0.6977108811539667, 0.8189556187908742, 0.7864806100262344, 0.69357515410147, 0.9779135338345865, 0.7658035149067012, 0.7285543322163714, 0.8925641287846013, 0.7111905288468325, 0.7004512010664753]
Epoch: 15, Steps: 536, | Train Loss: 0.01421

	iters: 100, epoch: 16 | loss: 0.0111817
	speed: 0.3659s/iter; left time: 2905.9147s
	iters: 200, epoch: 16 | loss: 0.0197846
	speed: 0.2332s/iter; left time: 1828.8880s
	iters: 300, epoch: 16 | loss: 0.0098618
	speed: 0.2337s/iter; left time: 1808.6852s
	iters: 400, epoch: 16 | loss: 0.0088424
	speed: 0.2326s/iter; left time: 1777.0552s
	iters: 500, epoch: 16 | loss: 0.0108211
	speed: 0.2306s/iter; left time: 1738.7329s
Epoch: 16 cost time: 124.94068551063538
Test is reading ....
[0.8306608553723085, 0.9546082223177196, 0.8506666548622425, 0.7388024516737388, 0.9970098520376631, 0.9891936597956883, 0.6179591049382717, 0.6467736955850572, 0.7328500707213579, 0.8574180717893659, 0.9842544481184066, 0.6164128520145378, 0.6055555555555556, 0.6950454687989966, 0.8202963977263813, 0.7887059399977543, 0.6844238975817923, 0.9750939849624061, 0.7667028406635918, 0.7308999521302059, 0.8927765148237589, 0.7107458627228626, 0.7006691106724434]
Epoch: 16, Steps: 536, | Train Loss: 0.01257

	iters: 100, epoch: 17 | loss: 0.0122538
	speed: 0.3720s/iter; left time: 2754.9546s
	iters: 200, epoch: 17 | loss: 0.0062211
	speed: 0.2306s/iter; left time: 1684.4184s
	iters: 300, epoch: 17 | loss: 0.0137475
	speed: 0.2350s/iter; left time: 1693.4133s
	iters: 400, epoch: 17 | loss: 0.0132682
	speed: 0.2325s/iter; left time: 1652.2191s
	iters: 500, epoch: 17 | loss: 0.0206575
	speed: 0.2341s/iter; left time: 1639.5219s
Epoch: 17 cost time: 125.71842432022095
Test is reading ....
[0.8316742446662542, 0.9553645609511532, 0.8507463347262555, 0.7267208863743517, 0.9970371178245537, 0.9895662922165267, 0.6167836130401234, 0.6459956776782958, 0.7237741631305987, 0.8585881262048266, 0.9844512675169265, 0.6145733461169703, 0.6129979035639412, 0.6934775791784258, 0.8218760920573112, 0.7909210620336249, 0.6770744428639166, 0.9727443609022556, 0.7662858348657041, 0.728769746290091, 0.8930636292841018, 0.7097930067429264, 0.698765606173251]
Epoch: 17, Steps: 536, | Train Loss: 0.01133

	iters: 100, epoch: 18 | loss: 0.0059194
	speed: 0.3655s/iter; left time: 2510.9623s
	iters: 200, epoch: 18 | loss: 0.0119673
	speed: 0.2353s/iter; left time: 1592.6813s
	iters: 300, epoch: 18 | loss: 0.0055623
	speed: 0.2339s/iter; left time: 1559.7121s
	iters: 400, epoch: 18 | loss: 0.0073178
	speed: 0.2321s/iter; left time: 1524.9492s
	iters: 500, epoch: 18 | loss: 0.0119810
	speed: 0.2344s/iter; left time: 1516.6040s
Epoch: 18 cost time: 125.6408338546753
Test is reading ....
[0.8322724133910875, 0.9558802463830396, 0.8511712940009916, 0.7175271098538425, 0.9969189660813611, 0.989893481659214, 0.6187246817129629, 0.6446557579499845, 0.7164662894860915, 0.8598911690783534, 0.9848055424342623, 0.6121819884501327, 0.6194444444444445, 0.6950454687989965, 0.8232043903378337, 0.7934747472685266, 0.6736130867709814, 0.9699248120300752, 0.7647484399963825, 0.7255505026328387, 0.8930714954337002, 0.7087789797618096, 0.697118465916374]
Epoch: 18, Steps: 536, | Train Loss: 0.01074

	iters: 100, epoch: 19 | loss: 0.0077774
	speed: 0.3682s/iter; left time: 2331.5599s
	iters: 200, epoch: 19 | loss: 0.0064340
	speed: 0.2333s/iter; left time: 1454.1144s
	iters: 300, epoch: 19 | loss: 0.0078370
	speed: 0.2348s/iter; left time: 1440.0619s
	iters: 400, epoch: 19 | loss: 0.0051134
	speed: 0.2413s/iter; left time: 1456.0572s
	iters: 500, epoch: 19 | loss: 0.0129427
	speed: 0.2402s/iter; left time: 1425.1643s
Epoch: 19 cost time: 127.00687718391418
Test is reading ....
[0.8332409624507878, 0.9559690588740868, 0.850728628089808, 0.7073314474304573, 0.9967735485512779, 0.990075253571818, 0.6187849633487654, 0.6434578573633837, 0.7130480905233381, 0.8609428759669114, 0.9848449063139663, 0.6089879373007202, 0.6237421383647799, 0.6955158356851678, 0.8232828401691663, 0.7948800397428959, 0.6708155523944997, 0.9638157894736842, 0.7632160692933008, 0.7237314504547632, 0.8918011122735532, 0.7077402491071387, 0.6940356859025303]
Epoch: 19, Steps: 536, | Train Loss: 0.00951

	iters: 100, epoch: 20 | loss: 0.0189045
	speed: 0.3779s/iter; left time: 2190.8851s
	iters: 200, epoch: 20 | loss: 0.0133016
	speed: 0.2453s/iter; left time: 1397.6675s
	iters: 300, epoch: 20 | loss: 0.0145722
	speed: 0.2381s/iter; left time: 1332.7238s
	iters: 400, epoch: 20 | loss: 0.0122493
	speed: 0.2348s/iter; left time: 1290.8490s
	iters: 500, epoch: 20 | loss: 0.0051180
	speed: 0.2435s/iter; left time: 1314.3006s
Epoch: 20 cost time: 129.82114148139954
Test is reading ....
[0.8350435398674523, 0.9563128491620111, 0.8505205751115519, 0.6994342291371994, 0.9966644854037154, 0.9903206456538336, 0.6187367380401234, 0.6420191417104044, 0.7086280056577086, 0.8617090846977868, 0.9846480869154463, 0.6080514615710496, 0.62583857442348, 0.7017873941674506, 0.8236750893258307, 0.7962274872485872, 0.6642721669037459, 0.9609962406015038, 0.7634220601091248, 0.7244734322642412, 0.8902200162042682, 0.7070591335362956, 0.6931063655241366]
Epoch: 20, Steps: 536, | Train Loss: 0.00893

	iters: 100, epoch: 21 | loss: 0.0065577
	speed: 0.3735s/iter; left time: 1965.1760s
	iters: 200, epoch: 21 | loss: 0.0060885
	speed: 0.2325s/iter; left time: 1199.8101s
	iters: 300, epoch: 21 | loss: 0.0062135
	speed: 0.2343s/iter; left time: 1185.7787s
	iters: 400, epoch: 21 | loss: 0.0143573
	speed: 0.2346s/iter; left time: 1163.8030s
	iters: 500, epoch: 21 | loss: 0.0067314
	speed: 0.2327s/iter; left time: 1131.1970s
Epoch: 21 cost time: 125.62397623062134
Test is reading ....
[0.8354587604365646, 0.9561953874803036, 0.8511137474325378, 0.6912423385195663, 0.9966099538299341, 0.990338822845094, 0.6186885127314814, 0.6410867551713492, 0.7093941537010844, 0.8634098728679145, 0.9844906313966304, 0.6080068674886843, 0.6328616352201257, 0.70288491690185, 0.8240388112711012, 0.7973741786865108, 0.6581792318634425, 0.9586466165413534, 0.7619148102372412, 0.7232048827190042, 0.8884226010210262, 0.7060380483627345, 0.6892544927833466]
Epoch: 21, Steps: 536, | Train Loss: 0.00799

	iters: 100, epoch: 22 | loss: 0.0034427
	speed: 0.3634s/iter; left time: 1717.2739s
	iters: 200, epoch: 22 | loss: 0.0066764
	speed: 0.2337s/iter; left time: 1080.8708s
	iters: 300, epoch: 22 | loss: 0.0046727
	speed: 0.2328s/iter; left time: 1053.5174s
	iters: 400, epoch: 22 | loss: 0.0044133
	speed: 0.2337s/iter; left time: 1033.9034s
	iters: 500, epoch: 22 | loss: 0.0106600
	speed: 0.2349s/iter; left time: 1016.0391s
Epoch: 22 cost time: 125.35955667495728
Test is reading ....
[0.8361264315244783, 0.956143818937115, 0.8510119342729656, 0.6861739745403113, 0.9965826880430435, 0.9904569745882867, 0.6169041763117284, 0.6411485026242667, 0.7086280056577086, 0.8644884214636053, 0.9847268146748545, 0.6045842716671498, 0.6391509433962265, 0.7082157416117905, 0.8242295869972971, 0.7985753124478969, 0.6528923660502608, 0.9572368421052632, 0.7606637928435775, 0.7248444231689803, 0.8866133866133865, 0.7056827860097216, 0.6870369420873177]
Epoch: 22, Steps: 536, | Train Loss: 0.00744

	iters: 100, epoch: 23 | loss: 0.0064441
	speed: 0.3649s/iter; left time: 1528.7286s
	iters: 200, epoch: 23 | loss: 0.0092310
	speed: 0.2338s/iter; left time: 956.1871s
	iters: 300, epoch: 23 | loss: 0.0059122
	speed: 0.2340s/iter; left time: 933.2835s
	iters: 400, epoch: 23 | loss: 0.0091512
	speed: 0.2342s/iter; left time: 910.9295s
	iters: 500, epoch: 23 | loss: 0.0049633
	speed: 0.2329s/iter; left time: 882.5399s
Epoch: 23 cost time: 125.43128252029419
Test is reading ....
[0.8371438564395061, 0.9560664661223321, 0.8505692683617819, 0.6840523338048091, 0.9964281819173302, 0.990475151779547, 0.6171091338734568, 0.6393084285273232, 0.7043847241867044, 0.865620653473561, 0.9849236340733744, 0.6026332805636692, 0.6421907756813418, 0.711351520852932, 0.8255739318342283, 0.8000894895691911, 0.6496917970602181, 0.956296992481203, 0.7602317145469709, 0.7260052656773576, 0.8851188181896843, 0.7039770561690954, 0.6834093880585536]
Epoch: 23, Steps: 536, | Train Loss: 0.00697

	iters: 100, epoch: 24 | loss: 0.0050709
	speed: 0.3742s/iter; left time: 1367.1283s
	iters: 200, epoch: 24 | loss: 0.0049304
	speed: 0.2383s/iter; left time: 846.6189s
	iters: 300, epoch: 24 | loss: 0.0096593
	speed: 0.2349s/iter; left time: 811.2426s
	iters: 400, epoch: 24 | loss: 0.0176838
	speed: 0.2351s/iter; left time: 788.1939s
	iters: 500, epoch: 24 | loss: 0.0088377
	speed: 0.2336s/iter; left time: 759.9614s
Epoch: 24 cost time: 126.91288089752197
Test is reading ....
[0.8376066076569183, 0.9559260850880963, 0.8499008428358948, 0.6810466760961811, 0.9964009161304396, 0.9905296833533282, 0.6178325135030864, 0.6372213646187095, 0.7014969354078264, 0.8665918352407213, 0.9848842701936702, 0.5996120314834221, 0.6473270440251572, 0.7138601442458451, 0.825859203948166, 0.8009452548411136, 0.6455192034139403, 0.9511278195488722, 0.7600558687285845, 0.7267113451412159, 0.8831444146404777, 0.7023277918680212, 0.6810444279231933]
Epoch: 24, Steps: 536, | Train Loss: 0.00644

	iters: 100, epoch: 25 | loss: 0.0028422
	speed: 0.3665s/iter; left time: 1142.3467s
	iters: 200, epoch: 25 | loss: 0.0030639
	speed: 0.2345s/iter; left time: 707.4317s
	iters: 300, epoch: 25 | loss: 0.0024445
	speed: 0.2346s/iter; left time: 684.2885s
	iters: 400, epoch: 25 | loss: 0.0115599
	speed: 0.2334s/iter; left time: 657.6078s
	iters: 500, epoch: 25 | loss: 0.0093004
	speed: 0.2332s/iter; left time: 633.7217s
Epoch: 25 cost time: 125.72879004478455
Test is reading ....
[0.8381133023038912, 0.9556481879386907, 0.8489889510588569, 0.6755657708628006, 0.9964190933217001, 0.9904478859926564, 0.6155960648148149, 0.6367459092312442, 0.7009075907590758, 0.8674898123520656, 0.9846087230357424, 0.5956208611117304, 0.6530398322851153, 0.7129194104735026, 0.8261997475341794, 0.8014437423653147, 0.6413229018492177, 0.9478383458646618, 0.7590208904832243, 0.7273336524652944, 0.8805013883754041, 0.7002903269825286, 0.6772310098187504]
Epoch: 25, Steps: 536, | Train Loss: 0.00600

	iters: 100, epoch: 26 | loss: 0.0038481
	speed: 0.3773s/iter; left time: 973.8545s
	iters: 200, epoch: 26 | loss: 0.0039601
	speed: 0.2369s/iter; left time: 587.7974s
	iters: 300, epoch: 26 | loss: 0.0037635
	speed: 0.2358s/iter; left time: 561.3854s
	iters: 400, epoch: 26 | loss: 0.0062427
	speed: 0.2340s/iter; left time: 533.8021s
	iters: 500, epoch: 26 | loss: 0.0408673
	speed: 0.2367s/iter; left time: 516.2923s
Epoch: 26 cost time: 127.43488883972168
Test is reading ....
[0.8382307837176141, 0.9554161294943417, 0.8490199376726397, 0.6658415841584158, 0.9963827389391792, 0.990202493910641, 0.6179108796296295, 0.6362828033343625, 0.7012611975483263, 0.8685927624996951, 0.9844512675169265, 0.594584048696738, 0.6573899371069182, 0.7179366572593289, 0.8261676544213612, 0.8024049896389454, 0.635064011379801, 0.9431390977443609, 0.7581768305549693, 0.7279080899952131, 0.8774257238824169, 0.6982081602115575, 0.6738662291383597]
Epoch: 26, Steps: 536, | Train Loss: 0.00568

	iters: 100, epoch: 27 | loss: 0.0022730
	speed: 0.3662s/iter; left time: 748.8121s
	iters: 200, epoch: 27 | loss: 0.0045407
	speed: 0.2332s/iter; left time: 453.6056s
	iters: 300, epoch: 27 | loss: 0.0027649
	speed: 0.2346s/iter; left time: 432.7828s
	iters: 400, epoch: 27 | loss: 0.0033244
	speed: 0.2357s/iter; left time: 411.2861s
	iters: 500, epoch: 27 | loss: 0.0114641
	speed: 0.2344s/iter; left time: 385.5470s
Epoch: 27 cost time: 125.91976618766785
Test is reading ....
[0.8386469010914113, 0.9551038533161438, 0.8487853247397125, 0.6646039603960395, 0.996328207365398, 0.9901025193587086, 0.6187970196759258, 0.6365606668724915, 0.7029702970297029, 0.8695444230253044, 0.9846874507951503, 0.5930232558139534, 0.6656184486373166, 0.7201317027281279, 0.826069592132195, 0.8037626450802854, 0.63266951161688, 0.9356203007518797, 0.757754800590842, 0.7286022020105314, 0.8730954085284794, 0.6959801241300778, 0.6700848565642064]
Epoch: 27, Steps: 536, | Train Loss: 0.00517

	iters: 100, epoch: 28 | loss: 0.0107483
	speed: 0.3755s/iter; left time: 566.6168s
	iters: 200, epoch: 28 | loss: 0.0038150
	speed: 0.2340s/iter; left time: 329.7340s
	iters: 300, epoch: 28 | loss: 0.0045127
	speed: 0.2340s/iter; left time: 306.3421s
	iters: 400, epoch: 28 | loss: 0.0075980
	speed: 0.2329s/iter; left time: 281.6167s
	iters: 500, epoch: 28 | loss: 0.0088236
	speed: 0.2356s/iter; left time: 261.3239s
Epoch: 28 cost time: 126.36226201057434
Test is reading ....
[0.8386191001461791, 0.9546626557799743, 0.8484311920107657, 0.6613625648279113, 0.9962827643872469, 0.9899752790198858, 0.6185920621141975, 0.6374560049397962, 0.7045025931164545, 0.8703301529977308, 0.9846087230357424, 0.5917188789047694, 0.6713836477987422, 0.7218563813107557, 0.8259323049273626, 0.8036656696916182, 0.6323613086770982, 0.931390977443609, 0.7565791456907727, 0.7301460028721876, 0.8688712861941209, 0.693967362918139, 0.6676301689440357]
Epoch: 28, Steps: 536, | Train Loss: 0.00549

	iters: 100, epoch: 29 | loss: 0.0033953
	speed: 0.3652s/iter; left time: 355.3237s
	iters: 200, epoch: 29 | loss: 0.0030975
	speed: 0.2347s/iter; left time: 204.9104s
	iters: 300, epoch: 29 | loss: 0.0144371
	speed: 0.2312s/iter; left time: 178.6852s
	iters: 400, epoch: 29 | loss: 0.0042155
	speed: 0.2326s/iter; left time: 156.5202s
	iters: 500, epoch: 29 | loss: 0.0070183
	speed: 0.2327s/iter; left time: 133.3636s
Epoch: 29 cost time: 125.16367697715759
Test is reading ....
[0.8382146412332857, 0.954250107434465, 0.8485241518521143, 0.6601838755304102, 0.9962464100047261, 0.9896844439597193, 0.61962890625, 0.6386230317999382, 0.7052687411598302, 0.8708181840365047, 0.9847661785545583, 0.5914178688488038, 0.6779874213836476, 0.7176230793352147, 0.825777188215409, 0.8041556506027786, 0.6304646752015174, 0.9328007518796992, 0.7559661974095399, 0.7317496409765437, 0.86591361394511, 0.6929380431867267, 0.6654574819904119]
Epoch: 29, Steps: 536, | Train Loss: 0.00478

	iters: 100, epoch: 30 | loss: 0.0021358
	speed: 0.3656s/iter; left time: 159.7792s
	iters: 200, epoch: 30 | loss: 0.0073845
	speed: 0.2339s/iter; left time: 78.8311s
	iters: 300, epoch: 30 | loss: 0.0049825
	speed: 0.2329s/iter; left time: 55.2017s
	iters: 400, epoch: 30 | loss: 0.0026804
	speed: 0.2317s/iter; left time: 31.7456s
	iters: 500, epoch: 30 | loss: 0.0068996
	speed: 0.2332s/iter; left time: 8.6274s
Epoch: 30 cost time: 125.15857720375061
Test is reading ....
[0.8385975768337414, 0.9537229623263143, 0.8483116722147461, 0.655999528524281, 0.9962191442178354, 0.9895481150252663, 0.6184413580246915, 0.6382031491200988, 0.7062706270627063, 0.8713257363168296, 0.9847268146748543, 0.5888760061539834, 0.6829140461215932, 0.7151144559423017, 0.8254616059393655, 0.8045197336409324, 0.6287577050734946, 0.9360902255639098, 0.7544639717038957, 0.7309119195787459, 0.8623423820274214, 0.6905711959871824, 0.6616889276283744]
Epoch: 30, Steps: 536, | Train Loss: 0.00456

>>>>>>>testing : my_classification_PTB-XL-Indep_Medformer_my_data_ftM_sl96_ll48_pl96_dm128_nh8_el6_dl1_df256_fc1_ebtimeF_dtTrue_Exp_seed41<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
Traceback (most recent call last):
  File "/data/0shared/zhangshanwei/cinc/baseline/Medformer-main/run.py", line 301, in <module>
    exp.test(setting)
TypeError: Exp_Basic.test() takes 1 positional argument but 2 were given
