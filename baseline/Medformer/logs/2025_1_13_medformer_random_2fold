nohup: ignoring input
Args in experiment:
Namespace(task_name='my_classification', is_training=1, model_id='PTB-XL-Indep', model='Medformer', data='my_data', root_path='./', data_path='ETTh1.csv', features='M', target='OT', freq='h', seq_len=96, label_len=48, pred_len=96, seasonal_patterns='Monthly', inverse=False, mask_rate=0.25, anomaly_ratio=0.25, expand=2, d_conv=4, top_k=5, num_kernels=6, enc_in=7, dec_in=7, c_out=7, d_model=128, n_heads=8, e_layers=6, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, no_inter_attn=False, chunk_size=16, patch_len=16, stride=8, sampling_rate=256, patch_len_list='2,4,8,8,16,16,16,16,32,32,32,32,32,32,32,32', single_channel=False, augmentations='flip0.5,shuffle0.5,frequency0.1,jitter0.2,scale0.2,mask0.1,drop0.5', num_workers=0, itr=5, train_epochs=30, batch_size=32, patience=10, learning_rate=0.0001, des='Exp', loss='MSE', lradj='type1', use_amp=False, swa=True, use_gpu=True, gpu=8, use_multi_gpu=False, devices='0,1,2,3', p_hidden_dims=[128, 128], p_hidden_layers=2)
Use GPU: cuda:8
>>>>>>>start training : my_classification_PTB-XL-Indep_Medformer_my_data_ftM_sl96_ll48_pl96_dm128_nh8_el6_dl1_df256_fc1_ebtimeF_dtTrue_Exp_seed41>>>>>>>>>>>>>>>>>>>>>>>>>>
TRAIN
Label to index mapping:
{'NORM': 0, 'LAFB/LPFB': 1, 'IRBBB': 2, 'ILBBB': 3, 'CLBBB': 4, 'CRBBB': 5, '_AVB': 6, 'IVCD': 7, 'WPW': 8, 'LVH': 9, 'RVH': 10, 'LAO/LAE': 11, 'RAO/RAE': 12, 'SEHYP': 13, 'AMI': 14, 'IMI': 15, 'LMI': 16, 'PMI': 17, 'ISCA': 18, 'ISCI': 19, 'ISC_': 20, 'STTC': 21, 'NST_': 22}
删除train中缺失label的数量:325
(17108, 1000, 12)
VAL
Label to index mapping:
{'NORM': 0, 'LAFB/LPFB': 1, 'IRBBB': 2, 'ILBBB': 3, 'CLBBB': 4, 'CRBBB': 5, '_AVB': 6, 'IVCD': 7, 'WPW': 8, 'LVH': 9, 'RVH': 10, 'LAO/LAE': 11, 'RAO/RAE': 12, 'SEHYP': 13, 'AMI': 14, 'IMI': 15, 'LMI': 16, 'PMI': 17, 'ISCA': 18, 'ISCI': 19, 'ISC_': 20, 'STTC': 21, 'NST_': 22}
删除val中缺失label的数量:42
(2150, 1000, 12)
TEST
Label to index mapping:
{'NORM': 0, 'LAFB/LPFB': 1, 'IRBBB': 2, 'ILBBB': 3, 'CLBBB': 4, 'CRBBB': 5, '_AVB': 6, 'IVCD': 7, 'WPW': 8, 'LVH': 9, 'RVH': 10, 'LAO/LAE': 11, 'RAO/RAE': 12, 'SEHYP': 13, 'AMI': 14, 'IMI': 15, 'LMI': 16, 'PMI': 17, 'ISCA': 18, 'ISCI': 19, 'ISC_': 20, 'STTC': 21, 'NST_': 22}
删除test中缺失label的数量:44
(2130, 1000, 12)
(17108, 1000, 12)
torch.Size([17108, 23])
(2150, 1000, 12)
torch.Size([2150, 23])
(2130, 1000, 12)
torch.Size([2130, 23])
	iters: 100, epoch: 1 | loss: 0.0555879
	speed: 0.2463s/iter; left time: 3928.8720s
	iters: 200, epoch: 1 | loss: 0.0519682
	speed: 0.2292s/iter; left time: 3633.4903s
	iters: 300, epoch: 1 | loss: 0.0528639
	speed: 0.2309s/iter; left time: 3636.4714s
	iters: 400, epoch: 1 | loss: 0.0530854
	speed: 0.2335s/iter; left time: 3653.7674s
	iters: 500, epoch: 1 | loss: 0.0488888
	speed: 0.2317s/iter; left time: 3602.6533s
Epoch: 1 cost time: 125.41289925575256
Test is reading ....
[0.7311145006954027, 0.8957675336240689, 0.7118655316437774, 0.8362983034872762, 0.9847373867123386, 0.8429850852779562, 0.6437395895256649, 0.6117608836907082, 0.7566564561734213, 0.8002385226230659, 0.8545837723919916, 0.6671978248515171, 0.5260377358490567, 0.5784359818210312, 0.7712786281587164, 0.640759082049755, 0.6707582938388625, 0.4431390977443609, 0.6094762362579944, 0.6101555023923445, 0.7956097350037936, 0.5312459645433246, 0.5853075322144976]
文件 'existing_file.xlsx' 不存在，将创建新文件。
	iters: 100, epoch: 2 | loss: 0.0472007
	speed: 0.3525s/iter; left time: 5433.4867s
	iters: 200, epoch: 2 | loss: 0.0417376
	speed: 0.2245s/iter; left time: 3438.1622s
	iters: 300, epoch: 2 | loss: 0.0426418
	speed: 0.2257s/iter; left time: 3434.4373s
	iters: 400, epoch: 2 | loss: 0.0508428
	speed: 0.2268s/iter; left time: 3428.8601s
	iters: 500, epoch: 2 | loss: 0.0394384
	speed: 0.2262s/iter; left time: 3397.3043s
Epoch: 2 cost time: 121.1765251159668
Test is reading ....
[0.759911619728098, 0.9118257647560769, 0.7628751946764831, 0.8824811498586239, 0.9849157924784129, 0.9062745307928353, 0.6601668030205826, 0.6654358474533912, 0.8352379830348727, 0.8238298245956335, 0.9042912684858836, 0.7054523573394547, 0.6406132075471698, 0.5077574047954865, 0.783925045629113, 0.6616919547386374, 0.6938862559241706, 0.3923872180451128, 0.6617533336120052, 0.6583133971291866, 0.8335056470412492, 0.6001577287066246, 0.6309233873773572]
Epoch: 2, Steps: 535, | Train Loss: 0.04389

	iters: 100, epoch: 3 | loss: 0.0286526
	speed: 0.3597s/iter; left time: 5352.4030s
	iters: 200, epoch: 3 | loss: 0.0519388
	speed: 0.2320s/iter; left time: 3429.3889s
	iters: 300, epoch: 3 | loss: 0.0356622
	speed: 0.2280s/iter; left time: 3347.3722s
	iters: 400, epoch: 3 | loss: 0.0242351
	speed: 0.2295s/iter; left time: 3346.8520s
	iters: 500, epoch: 3 | loss: 0.0386649
	speed: 0.2332s/iter; left time: 3376.4664s
Epoch: 3 cost time: 123.72097897529602
Test is reading ....
[0.7723239545867442, 0.9162669766829216, 0.7840418377460003, 0.8967365692742696, 0.9870655819596089, 0.9407336045100978, 0.6630684928281765, 0.6785687509371721, 0.8601555136663525, 0.8370583185374516, 0.9172995167326767, 0.7061320912403473, 0.5937264150943397, 0.5362795800031342, 0.7902198194739902, 0.6766220121274465, 0.6883175355450237, 0.5317199248120301, 0.7064122392676503, 0.7108851674641148, 0.855523800912804, 0.6454563063810947, 0.6589722990112662]
Epoch: 3, Steps: 535, | Train Loss: 0.03709

	iters: 100, epoch: 4 | loss: 0.0340192
	speed: 0.3584s/iter; left time: 5141.0345s
	iters: 200, epoch: 4 | loss: 0.0287701
	speed: 0.2306s/iter; left time: 3285.4847s
	iters: 300, epoch: 4 | loss: 0.0233844
	speed: 0.2322s/iter; left time: 3284.1675s
	iters: 400, epoch: 4 | loss: 0.0391548
	speed: 0.2320s/iter; left time: 3258.8469s
	iters: 500, epoch: 4 | loss: 0.0207464
	speed: 0.2277s/iter; left time: 3175.7225s
Epoch: 4 cost time: 123.743976354599
Test is reading ....
[0.7809669461728634, 0.9193451861099737, 0.8045359620557836, 0.9003887841658813, 0.9890994076928566, 0.9533647327481624, 0.6738512427825616, 0.6901771879842056, 0.880949575871819, 0.8449529783622424, 0.9242396715235638, 0.7131857233594455, 0.6083018867924528, 0.5268766650995141, 0.7949320139544225, 0.6900750521101215, 0.7000947867298578, 0.5606203007518797, 0.7198773147180537, 0.7236961722488039, 0.8656935856058432, 0.6688734849742652, 0.6821313124284387]
Epoch: 4, Steps: 535, | Train Loss: 0.03410

	iters: 100, epoch: 5 | loss: 0.0251169
	speed: 0.3737s/iter; left time: 5160.8832s
	iters: 200, epoch: 5 | loss: 0.0310620
	speed: 0.2323s/iter; left time: 3185.5761s
	iters: 300, epoch: 5 | loss: 0.0356546
	speed: 0.2344s/iter; left time: 3190.4709s
	iters: 400, epoch: 5 | loss: 0.0456368
	speed: 0.2341s/iter; left time: 3163.2332s
	iters: 500, epoch: 5 | loss: 0.0333188
	speed: 0.2344s/iter; left time: 3143.1361s
Epoch: 5 cost time: 126.01727414131165
Test is reading ....
[0.7858199700317705, 0.9236432255053275, 0.8165129902307801, 0.8953228086710651, 0.9900003568115321, 0.9644437308213801, 0.6782832355312801, 0.7004048582995951, 0.8839538171536286, 0.8470382221528496, 0.936266850768504, 0.7153252136704518, 0.6084433962264151, 0.6227863971164393, 0.7967900563188547, 0.6969508811347825, 0.6917535545023696, 0.7354323308270676, 0.7287129540609456, 0.7367224880382776, 0.8696050412570122, 0.6825617540170089, 0.6879827430241459]
Epoch: 5, Steps: 535, | Train Loss: 0.03202

	iters: 100, epoch: 6 | loss: 0.0303886
	speed: 0.3627s/iter; left time: 4814.8802s
	iters: 200, epoch: 6 | loss: 0.0336765
	speed: 0.2326s/iter; left time: 3064.9467s
	iters: 300, epoch: 6 | loss: 0.0232310
	speed: 0.2348s/iter; left time: 3070.3875s
	iters: 400, epoch: 6 | loss: 0.0308091
	speed: 0.2328s/iter; left time: 3020.6524s
	iters: 500, epoch: 6 | loss: 0.0415005
	speed: 0.2315s/iter; left time: 2981.3947s
Epoch: 6 cost time: 124.87584519386292
Test is reading ....
[0.7929636534338371, 0.9264408167706577, 0.8258220656944641, 0.8946159283694627, 0.9904642118033256, 0.9706700920573752, 0.6797693951183337, 0.7068650972159746, 0.8834825636192272, 0.8504770452461319, 0.9446241052287344, 0.7128960007131635, 0.6075471698113207, 0.6632189312020059, 0.7997215157929157, 0.7039764421645327, 0.6858293838862559, 0.8900375939849624, 0.7355682815700372, 0.7511602870813396, 0.873477185796109, 0.6894012765878945, 0.6898362232020293]
Epoch: 6, Steps: 535, | Train Loss: 0.02967

	iters: 100, epoch: 7 | loss: 0.0259532
	speed: 0.3596s/iter; left time: 4582.0753s
	iters: 200, epoch: 7 | loss: 0.0300349
	speed: 0.2334s/iter; left time: 2950.1446s
	iters: 300, epoch: 7 | loss: 0.0305214
	speed: 0.2316s/iter; left time: 2904.8565s
	iters: 400, epoch: 7 | loss: 0.0199261
	speed: 0.2304s/iter; left time: 2866.5363s
	iters: 500, epoch: 7 | loss: 0.0264503
	speed: 0.2325s/iter; left time: 2869.8414s
Epoch: 7 cost time: 124.15123176574707
Test is reading ....
[0.7937034436562318, 0.9281159353891, 0.8328171456888007, 0.8937323279924599, 0.9914632840933418, 0.9748269464069078, 0.6783126644339937, 0.7085145199180286, 0.8819509896324222, 0.8523891284412619, 0.952727008466262, 0.7091407494901996, 0.6050471698113208, 0.6602413414825261, 0.8011077166960789, 0.7146040307517393, 0.6785545023696683, 0.9102443609022557, 0.7383846089537265, 0.7579485645933015, 0.876567039204972, 0.6964437249801686, 0.6944730865821952]
Epoch: 7, Steps: 535, | Train Loss: 0.02806

	iters: 100, epoch: 8 | loss: 0.0239532
	speed: 0.3560s/iter; left time: 4345.5146s
	iters: 200, epoch: 8 | loss: 0.0270400
	speed: 0.2328s/iter; left time: 2817.7437s
	iters: 300, epoch: 8 | loss: 0.0253264
	speed: 0.2328s/iter; left time: 2794.5261s
	iters: 400, epoch: 8 | loss: 0.0288659
	speed: 0.2344s/iter; left time: 2790.6911s
	iters: 500, epoch: 8 | loss: 0.0281358
	speed: 0.2335s/iter; left time: 2756.1634s
Epoch: 8 cost time: 124.69819641113281
Test is reading ....
[0.7923242953386043, 0.9301203508299712, 0.8370911793855302, 0.8947337417530632, 0.9921947477342468, 0.9766734460857777, 0.6726387719907476, 0.7102701554455941, 0.8787111215834118, 0.8510965211792481, 0.954725482358926, 0.7121159782039425, 0.5984905660377359, 0.6865695032126625, 0.8016524225637963, 0.7206559107766439, 0.6742180094786729, 0.9285714285714286, 0.7418436232913933, 0.7583133971291867, 0.8780647925749172, 0.701646005128489, 0.6919364123455697]
Epoch: 8, Steps: 535, | Train Loss: 0.02651

	iters: 100, epoch: 9 | loss: 0.0238244
	speed: 0.3586s/iter; left time: 4185.2487s
	iters: 200, epoch: 9 | loss: 0.0263641
	speed: 0.2336s/iter; left time: 2703.3523s
	iters: 300, epoch: 9 | loss: 0.0402865
	speed: 0.2337s/iter; left time: 2681.2711s
	iters: 400, epoch: 9 | loss: 0.0292158
	speed: 0.2314s/iter; left time: 2631.4651s
	iters: 500, epoch: 9 | loss: 0.0192850
	speed: 0.2325s/iter; left time: 2620.7242s
Epoch: 9 cost time: 124.35537767410278
Test is reading ....
[0.7907155878731794, 0.9315234416385809, 0.8401263627353814, 0.8950871819038643, 0.9927656461856847, 0.9786269892242918, 0.6693780495700438, 0.7120445344129555, 0.875294533459001, 0.851223343023823, 0.9589404454779986, 0.7068675410347556, 0.5907075471698113, 0.7020843128036358, 0.8047873692217191, 0.7271578327603476, 0.6706398104265403, 0.9457236842105263, 0.7402395184550433, 0.7623325358851675, 0.878807772593079, 0.7045584518604608, 0.68939341223803]
Epoch: 9, Steps: 535, | Train Loss: 0.02489

	iters: 100, epoch: 10 | loss: 0.0192613
	speed: 0.3566s/iter; left time: 3971.0467s
	iters: 200, epoch: 10 | loss: 0.0233856
	speed: 0.2239s/iter; left time: 2470.6965s
	iters: 300, epoch: 10 | loss: 0.0234545
	speed: 0.2275s/iter; left time: 2487.7457s
	iters: 400, epoch: 10 | loss: 0.0238134
	speed: 0.2325s/iter; left time: 2519.5197s
	iters: 500, epoch: 10 | loss: 0.0172775
	speed: 0.2313s/iter; left time: 2483.2411s
Epoch: 10 cost time: 122.78348541259766
Test is reading ....
[0.7900941640863681, 0.9328234482245173, 0.8431969418094295, 0.8954406220546653, 0.9931581388710483, 0.9808570613002212, 0.6699666276243225, 0.7122694556905083, 0.8704641847313854, 0.8530110432560045, 0.9626103702627085, 0.706120948061644, 0.5775943396226415, 0.7011440213132738, 0.8079934031054454, 0.7324297528491378, 0.6668483412322275, 0.9485432330827067, 0.7425542365087991, 0.7651674641148325, 0.88042345929924, 0.7068067777224344, 0.6902727082951146]
Epoch: 10, Steps: 535, | Train Loss: 0.02306

	iters: 100, epoch: 11 | loss: 0.0165664
	speed: 0.3608s/iter; left time: 3824.3854s
	iters: 200, epoch: 11 | loss: 0.0185226
	speed: 0.2343s/iter; left time: 2460.4624s
	iters: 300, epoch: 11 | loss: 0.0176184
	speed: 0.2326s/iter; left time: 2418.8677s
	iters: 400, epoch: 11 | loss: 0.0225593
	speed: 0.2318s/iter; left time: 2387.8577s
	iters: 500, epoch: 11 | loss: 0.0176742
	speed: 0.2349s/iter; left time: 2396.1271s
Epoch: 11 cost time: 124.96140933036804
Test is reading ....
[0.7889481617782226, 0.9333102348315861, 0.8455330596063995, 0.8956173421300659, 0.993514950403197, 0.9830068507814173, 0.6652697747511787, 0.7107699805068226, 0.863100848256362, 0.8557182018613545, 0.9639184622651793, 0.7022988377664613, 0.5732075471698113, 0.7096066447265319, 0.8125803063503995, 0.7370705990633714, 0.6643601895734598, 0.9548872180451128, 0.7425437863144254, 0.7700478468899521, 0.8819212126691852, 0.7072795026472596, 0.6916201187998557]
Epoch: 11, Steps: 535, | Train Loss: 0.02110

	iters: 100, epoch: 12 | loss: 0.0209990
	speed: 0.3637s/iter; left time: 3661.4790s
	iters: 200, epoch: 12 | loss: 0.0205482
	speed: 0.2346s/iter; left time: 2337.6527s
	iters: 300, epoch: 12 | loss: 0.0307090
	speed: 0.2335s/iter; left time: 2303.3201s
	iters: 400, epoch: 12 | loss: 0.0161922
	speed: 0.2336s/iter; left time: 2281.2454s
	iters: 500, epoch: 12 | loss: 0.0162545
	speed: 0.2322s/iter; left time: 2244.3854s
Epoch: 12 cost time: 125.24324703216553
Test is reading ....
[0.7881590522076687, 0.9328635365333349, 0.8478426306102222, 0.8969721960414703, 0.9938539213587383, 0.9838275173053593, 0.6584481551020888, 0.7110323886639676, 0.855619698397738, 0.8558352681794237, 0.9642818211547546, 0.6950446284307061, 0.5656132075471699, 0.6944052656323461, 0.8140518119245266, 0.7414085974933001, 0.6645497630331754, 0.9558270676691729, 0.7414047151277013, 0.7710167464114832, 0.88249122379423, 0.7063525005995536, 0.6895926771718297]
Epoch: 12, Steps: 535, | Train Loss: 0.01917

	iters: 100, epoch: 13 | loss: 0.0145276
	speed: 0.3626s/iter; left time: 3455.6423s
	iters: 200, epoch: 13 | loss: 0.0216739
	speed: 0.2351s/iter; left time: 2217.2134s
	iters: 300, epoch: 13 | loss: 0.0175151
	speed: 0.2329s/iter; left time: 2172.7726s
	iters: 400, epoch: 13 | loss: 0.0206271
	speed: 0.2318s/iter; left time: 2139.4688s
	iters: 500, epoch: 13 | loss: 0.0221080
	speed: 0.2347s/iter; left time: 2143.2410s
Epoch: 13 cost time: 125.20555281639099
Test is reading ....
[0.7857137092543721, 0.9324368823894924, 0.8483956888007929, 0.8972667295004713, 0.9942196531791907, 0.9848622707485906, 0.6529331787334977, 0.7109199280251912, 0.8504948162111217, 0.8577851540397635, 0.964172813487882, 0.6892056027902519, 0.5522641509433962, 0.6881366556965993, 0.8161702112534632, 0.7468040253377006, 0.6664691943127963, 0.9591165413533834, 0.741007607741504, 0.7708492822966507, 0.8825659149071667, 0.7083886767391665, 0.6901778202314003]
Epoch: 13, Steps: 535, | Train Loss: 0.01739

	iters: 100, epoch: 14 | loss: 0.0123593
	speed: 0.3721s/iter; left time: 3347.3445s
	iters: 200, epoch: 14 | loss: 0.0177122
	speed: 0.2329s/iter; left time: 2072.3075s
	iters: 300, epoch: 14 | loss: 0.0133543
	speed: 0.2333s/iter; left time: 2051.9676s
	iters: 400, epoch: 14 | loss: 0.0301446
	speed: 0.2328s/iter; left time: 2024.7477s
	iters: 500, epoch: 14 | loss: 0.0180034
	speed: 0.2335s/iter; left time: 2007.5008s
Epoch: 14 cost time: 125.97386336326599
Test is reading ....
[0.7839444897285732, 0.9325972356247619, 0.8494973807164095, 0.8973845428840717, 0.9944783415399986, 0.9854331692000285, 0.6496547989711656, 0.7092517618833407, 0.8478440150801132, 0.8587229040251303, 0.9644998364884997, 0.6837120156895956, 0.5479245283018868, 0.6846889202319385, 0.818750677550121, 0.7500439890636421, 0.6652132701421801, 0.9619360902255639, 0.740709777201856, 0.7739234449760766, 0.8821649415640319, 0.7083287213828472, 0.6888557132103162]
Epoch: 14, Steps: 535, | Train Loss: 0.01536

	iters: 100, epoch: 15 | loss: 0.0100518
	speed: 0.3611s/iter; left time: 3055.3649s
	iters: 200, epoch: 15 | loss: 0.0129053
	speed: 0.2326s/iter; left time: 1944.3956s
	iters: 300, epoch: 15 | loss: 0.0135465
	speed: 0.2321s/iter; left time: 1917.7580s
	iters: 400, epoch: 15 | loss: 0.0128709
	speed: 0.2304s/iter; left time: 1880.2146s
	iters: 500, epoch: 15 | loss: 0.0194277
	speed: 0.2345s/iter; left time: 1890.0889s
Epoch: 15 cost time: 124.56510186195374
Test is reading ....
[0.7832226338146004, 0.9326430508348391, 0.850771626787484, 0.8965009425070688, 0.9948173124955398, 0.985861343038607, 0.6448284589260804, 0.7071275053731194, 0.8502591894439209, 0.8606520593916454, 0.9654445696013954, 0.6782184285889393, 0.5437264150943396, 0.6676069581570286, 0.8202701670016652, 0.7550672017541485, 0.6676066350710901, 0.9640507518796994, 0.7405895999665594, 0.7760526315789473, 0.8813708571001765, 0.7100927924437803, 0.6897919421056293]
Epoch: 15, Steps: 535, | Train Loss: 0.01431

	iters: 100, epoch: 16 | loss: 0.0099950
	speed: 0.3646s/iter; left time: 2889.9851s
	iters: 200, epoch: 16 | loss: 0.0095011
	speed: 0.2364s/iter; left time: 1850.3078s
	iters: 300, epoch: 16 | loss: 0.0094928
	speed: 0.2430s/iter; left time: 1877.6008s
	iters: 400, epoch: 16 | loss: 0.0138669
	speed: 0.2432s/iter; left time: 1854.3814s
	iters: 500, epoch: 16 | loss: 0.0119720
	speed: 0.2426s/iter; left time: 1825.7294s
Epoch: 16 cost time: 128.89260983467102
Test is reading ....
[0.7835849068447184, 0.9330038456141959, 0.8523378875831799, 0.8957940622054665, 0.9949957182616141, 0.9863251980304004, 0.6412087038922667, 0.7058154645873944, 0.8476672950047125, 0.8612178799289798, 0.9651902183786927, 0.6740285933965523, 0.5351415094339623, 0.667920388653816, 0.8234886411499068, 0.7581210579031429, 0.6680805687203792, 0.9647556390977443, 0.7400461898591314, 0.7775000000000001, 0.881838659333834, 0.7097688029221318, 0.6896084918491153]
Epoch: 16, Steps: 535, | Train Loss: 0.01266

	iters: 100, epoch: 17 | loss: 0.0053624
	speed: 0.3647s/iter; left time: 2695.4498s
	iters: 200, epoch: 17 | loss: 0.0300470
	speed: 0.2335s/iter; left time: 1702.7845s
	iters: 300, epoch: 17 | loss: 0.0046271
	speed: 0.2335s/iter; left time: 1679.2509s
	iters: 400, epoch: 17 | loss: 0.0089271
	speed: 0.2311s/iter; left time: 1638.4058s
	iters: 500, epoch: 17 | loss: 0.0089692
	speed: 0.2334s/iter; left time: 1631.4011s
Epoch: 17 cost time: 124.68184280395508
Test is reading ....
[0.7833634181357108, 0.9335078129250435, 0.8538466303270565, 0.8947337417530632, 0.9951473631627774, 0.9865125240847784, 0.6376242635417095, 0.7045284150547308, 0.8459000942507069, 0.8627299865373733, 0.9658079284909705, 0.667688124714456, 0.5258018867924529, 0.6574204670114402, 0.8259820255949557, 0.7607113369968326, 0.6689336492890996, 0.9671052631578947, 0.7398215106800986, 0.7771411483253589, 0.8818032793329692, 0.7100997103695094, 0.6895705366236295]
Epoch: 17, Steps: 535, | Train Loss: 0.01149

	iters: 100, epoch: 18 | loss: 0.0103094
	speed: 0.3704s/iter; left time: 2539.1354s
	iters: 200, epoch: 18 | loss: 0.0099117
	speed: 0.2280s/iter; left time: 1540.4125s
	iters: 300, epoch: 18 | loss: 0.0121129
	speed: 0.2304s/iter; left time: 1533.4502s
	iters: 400, epoch: 18 | loss: 0.0101928
	speed: 0.2296s/iter; left time: 1504.9881s
	iters: 500, epoch: 18 | loss: 0.0092260
	speed: 0.2296s/iter; left time: 1482.0118s
Epoch: 18 cost time: 124.39730501174927
Test is reading ....
[0.7842036404852666, 0.9336166240489765, 0.8539749398272688, 0.8946159283694628, 0.9951652037393849, 0.9865838863912082, 0.6318973990735781, 0.7045284150547308, 0.8446041470311028, 0.8633689735235012, 0.9659532720468007, 0.6623393989369408, 0.5130660377358491, 0.6555398840307162, 0.826691120672343, 0.7630444492569232, 0.671563981042654, 0.9696898496240601, 0.7382801070099905, 0.7786602870813397, 0.8813276148768971, 0.7073233161768775, 0.6866796136158044]
Epoch: 18, Steps: 535, | Train Loss: 0.01052

	iters: 100, epoch: 19 | loss: 0.0066919
	speed: 0.3560s/iter; left time: 2250.3475s
	iters: 200, epoch: 19 | loss: 0.0096862
	speed: 0.2345s/iter; left time: 1458.5865s
	iters: 300, epoch: 19 | loss: 0.0092127
	speed: 0.2334s/iter; left time: 1428.8691s
	iters: 400, epoch: 19 | loss: 0.0092957
	speed: 0.2270s/iter; left time: 1366.8077s
	iters: 500, epoch: 19 | loss: 0.0085653
	speed: 0.2325s/iter; left time: 1376.3896s
Epoch: 19 cost time: 123.8825511932373
Test is reading ....
[0.7836082214456667, 0.9336624392590536, 0.8540059110859408, 0.8950871819038643, 0.9951562834510811, 0.9866909298508528, 0.6259821896280775, 0.7031226570700255, 0.8423656927426957, 0.8647591360505726, 0.9664983103811635, 0.6598878996222463, 0.5064622641509434, 0.6535025858015985, 0.8284132087174265, 0.7651068595869088, 0.6740047393364929, 0.9710996240601504, 0.7361116916774652, 0.7788636363636363, 0.8810760237596362, 0.7059904624863949, 0.6850412130490066]
Epoch: 19, Steps: 535, | Train Loss: 0.00935

	iters: 100, epoch: 20 | loss: 0.0100765
	speed: 0.3707s/iter; left time: 2144.7340s
	iters: 200, epoch: 20 | loss: 0.0106532
	speed: 0.2304s/iter; left time: 1310.2269s
	iters: 300, epoch: 20 | loss: 0.0060637
	speed: 0.2331s/iter; left time: 1301.9037s
	iters: 400, epoch: 20 | loss: 0.0190305
	speed: 0.2312s/iter; left time: 1268.4182s
	iters: 500, epoch: 20 | loss: 0.0077518
	speed: 0.2314s/iter; left time: 1246.0980s
Epoch: 20 cost time: 125.12904953956604
Test is reading ....
[0.7838844097953607, 0.9334763149681156, 0.8542005875690216, 0.8949693685202638, 0.9952008848925997, 0.9868514950403197, 0.6234748471168503, 0.700823461788374, 0.8398327049952874, 0.8656151835014536, 0.9666436539369936, 0.6539820149095731, 0.4997641509433962, 0.6456668233819151, 0.8304027624495949, 0.765726936195555, 0.674431279620853, 0.9729793233082707, 0.7350875726288508, 0.7802033492822967, 0.8806278770820147, 0.7055915287693472, 0.6828746022608664]
Epoch: 20, Steps: 535, | Train Loss: 0.00815

	iters: 100, epoch: 21 | loss: 0.0089976
	speed: 0.3615s/iter; left time: 1898.3603s
	iters: 200, epoch: 21 | loss: 0.0060769
	speed: 0.2320s/iter; left time: 1194.9228s
	iters: 300, epoch: 21 | loss: 0.0034404
	speed: 0.2314s/iter; left time: 1168.9815s
	iters: 400, epoch: 21 | loss: 0.0121299
	speed: 0.2314s/iter; left time: 1145.6113s
	iters: 500, epoch: 21 | loss: 0.0180582
	speed: 0.2309s/iter; left time: 1119.9159s
Epoch: 21 cost time: 124.05699920654297
Test is reading ....
[0.7851783701479849, 0.9334992225731541, 0.8544749044315447, 0.8946159283694628, 0.9952098051809034, 0.9870745022479127, 0.6222094043001514, 0.6993864647373418, 0.8394792648444863, 0.8661931984469202, 0.9656625849351405, 0.6485218573450262, 0.4948584905660377, 0.6383012067074126, 0.8322092665753196, 0.7661625971143174, 0.675260663507109, 0.9732142857142857, 0.7326840279229194, 0.7813397129186602, 0.8799163459535106, 0.7061818584315678, 0.6806257551508405]
Epoch: 21, Steps: 535, | Train Loss: 0.00785

	iters: 100, epoch: 22 | loss: 0.0030494
	speed: 0.3572s/iter; left time: 1684.4958s
	iters: 200, epoch: 22 | loss: 0.0066782
	speed: 0.2316s/iter; left time: 1069.2443s
	iters: 300, epoch: 22 | loss: 0.0046364
	speed: 0.2289s/iter; left time: 1033.6333s
	iters: 400, epoch: 22 | loss: 0.0080130
	speed: 0.2343s/iter; left time: 1034.6165s
	iters: 500, epoch: 22 | loss: 0.0115618
	speed: 0.2309s/iter; left time: 996.4613s
Epoch: 22 cost time: 124.07304763793945
Test is reading ....
[0.7860033483353823, 0.9338199290436934, 0.8546651564491009, 0.8936145146088597, 0.9952811674873331, 0.987128023977735, 0.6215443110988164, 0.6964749837556855, 0.8376531573986806, 0.8672687452441808, 0.9654809054903528, 0.6448000356581718, 0.4875471698113208, 0.6384579219558063, 0.834061088807494, 0.7666710091767954, 0.6764454976303318, 0.974624060150376, 0.72986770053923, 0.7833971291866029, 0.879503579276754, 0.7059005294519158, 0.6773805833718157]
Epoch: 22, Steps: 535, | Train Loss: 0.00754

	iters: 100, epoch: 23 | loss: 0.0051559
	speed: 0.3595s/iter; left time: 1503.1248s
	iters: 200, epoch: 23 | loss: 0.0055802
	speed: 0.2306s/iter; left time: 941.1438s
	iters: 300, epoch: 23 | loss: 0.0055502
	speed: 0.2317s/iter; left time: 922.3177s
	iters: 400, epoch: 23 | loss: 0.0022776
	speed: 0.2308s/iter; left time: 895.8617s
	iters: 500, epoch: 23 | loss: 0.0039315
	speed: 0.2314s/iter; left time: 875.0316s
Epoch: 23 cost time: 123.83003830909729
Test is reading ....
[0.7856222442814217, 0.9338356780221574, 0.8545899405351832, 0.89379123468426, 0.9953079283522444, 0.9871369442660387, 0.6212441362911342, 0.6940633278352576, 0.8364161168708766, 0.8682345423682516, 0.9644998364884998, 0.641679945621288, 0.4807547169811321, 0.6343833254975709, 0.8347737382461715, 0.7670474540483473, 0.6772748815165877, 0.9755639097744361, 0.7271611001964637, 0.7841985645933015, 0.8784067992499439, 0.7054543232423857, 0.6744959862349049]
Epoch: 23, Steps: 535, | Train Loss: 0.00673

	iters: 100, epoch: 24 | loss: 0.0031337
	speed: 0.3609s/iter; left time: 1315.7994s
	iters: 200, epoch: 24 | loss: 0.0043364
	speed: 0.2343s/iter; left time: 830.9260s
	iters: 300, epoch: 24 | loss: 0.0094719
	speed: 0.2316s/iter; left time: 798.1439s
	iters: 400, epoch: 24 | loss: 0.0040913
	speed: 0.2336s/iter; left time: 781.4729s
	iters: 500, epoch: 24 | loss: 0.0148870
	speed: 0.2299s/iter; left time: 746.4122s
Epoch: 24 cost time: 124.52683329582214
Test is reading ....
[0.7852061683260386, 0.9335965798945677, 0.8545722426730851, 0.8932021677662583, 0.9953079283522444, 0.9868336544637122, 0.6222388332028651, 0.691582945968911, 0.8354147031102733, 0.8688832848808852, 0.9642454852657971, 0.6403204778195029, 0.4734433962264151, 0.6306221595361229, 0.8359893298074069, 0.7668105898595057, 0.6781042654028436, 0.9760338345864662, 0.7255674455544873, 0.784677033492823, 0.8772313969989897, 0.7050542365377165, 0.6720288965783365]
Epoch: 24, Steps: 535, | Train Loss: 0.00632

	iters: 100, epoch: 25 | loss: 0.0137682
	speed: 0.3611s/iter; left time: 1123.4059s
	iters: 200, epoch: 25 | loss: 0.0032577
	speed: 0.2326s/iter; left time: 700.4866s
	iters: 300, epoch: 25 | loss: 0.0055449
	speed: 0.2330s/iter; left time: 678.3673s
	iters: 400, epoch: 25 | loss: 0.0041790
	speed: 0.2318s/iter; left time: 651.6868s
	iters: 500, epoch: 25 | loss: 0.0034789
	speed: 0.2381s/iter; left time: 645.5556s
Epoch: 25 cost time: 125.15043139457703
Test is reading ....
[0.7861871749967047, 0.9332901906771773, 0.8547492212940676, 0.8920240339302545, 0.9952811674873332, 0.9865660458146007, 0.6209321899223665, 0.6896492477632828, 0.8347078228086712, 0.8695710494995416, 0.9637004469314342, 0.6378244057899957, 0.4691981132075472, 0.6320325967716659, 0.8372742314138005, 0.7674991878942097, 0.6788625592417061, 0.9760338345864662, 0.7230019228357647, 0.7840909090909092, 0.8751714947264144, 0.704842086815356, 0.6695554810508537]
Epoch: 25, Steps: 535, | Train Loss: 0.00611

	iters: 100, epoch: 26 | loss: 0.0023255
	speed: 0.3621s/iter; left time: 932.6641s
	iters: 200, epoch: 26 | loss: 0.0075238
	speed: 0.2344s/iter; left time: 580.3141s
	iters: 300, epoch: 26 | loss: 0.0038272
	speed: 0.2305s/iter; left time: 547.6537s
	iters: 400, epoch: 26 | loss: 0.0042270
	speed: 0.2336s/iter; left time: 531.6350s
	iters: 500, epoch: 26 | loss: 0.0035093
	speed: 0.2343s/iter; left time: 509.8030s
Epoch: 26 cost time: 125.1718521118164
Test is reading ....
[0.7869260685036779, 0.9325170590071271, 0.8546209117938552, 0.8913171536286522, 0.9952900877756369, 0.9865838863912082, 0.6219033437119263, 0.687421902334183, 0.8352379830348727, 0.8698149376621855, 0.9639184622651793, 0.6356291995854737, 0.4662735849056604, 0.6368907694718696, 0.8377131950331356, 0.7680016783519668, 0.6800236966824644, 0.9750939849624061, 0.7206036032270199, 0.7844377990430622, 0.8734968413521451, 0.7046045713653217, 0.6676387421638273]
Epoch: 26, Steps: 535, | Train Loss: 0.00522

	iters: 100, epoch: 27 | loss: 0.0047394
	speed: 0.3640s/iter; left time: 742.8970s
	iters: 200, epoch: 27 | loss: 0.0068468
	speed: 0.2356s/iter; left time: 457.3038s
	iters: 300, epoch: 27 | loss: 0.0045822
	speed: 0.2315s/iter; left time: 426.2577s
	iters: 400, epoch: 27 | loss: 0.0033294
	speed: 0.2319s/iter; left time: 403.7513s
	iters: 500, epoch: 27 | loss: 0.0037397
	speed: 0.2392s/iter; left time: 392.5801s
Epoch: 27 cost time: 126.11168956756592
Test is reading ....
[0.7891032935460701, 0.9321677180302895, 0.854735947897494, 0.889078699340245, 0.9952276457575109, 0.9863519588953116, 0.6219916304200682, 0.6842667566351777, 0.8397737983034873, 0.8708343901820382, 0.9627920497074962, 0.6337460023846403, 0.4634433962264151, 0.6334430340072089, 0.8389892107363038, 0.7688966866083755, 0.6805450236966825, 0.9732142857142857, 0.7185344647410443, 0.7841028708133971, 0.8715705968606147, 0.7051095799435497, 0.6648427072197165]
Epoch: 27, Steps: 535, | Train Loss: 0.00556

	iters: 100, epoch: 28 | loss: 0.0041117
	speed: 0.3740s/iter; left time: 563.2473s
	iters: 200, epoch: 28 | loss: 0.0020253
	speed: 0.2365s/iter; left time: 332.5170s
	iters: 300, epoch: 28 | loss: 0.0019275
	speed: 0.2355s/iter; left time: 307.5055s
	iters: 400, epoch: 28 | loss: 0.0197829
	speed: 0.2368s/iter; left time: 285.5875s
	iters: 500, epoch: 28 | loss: 0.0044108
	speed: 0.2368s/iter; left time: 261.8714s
Epoch: 28 cost time: 126.73756003379822
Test is reading ....
[0.7897018510896437, 0.9318441481091204, 0.854399688517627, 0.8881950989632421, 0.9951652037393849, 0.9863519588953115, 0.6224389497413199, 0.6826735642525117, 0.8423067860508954, 0.8712343667687745, 0.9621016678173031, 0.6306927714199753, 0.46419811320754717, 0.6273311393198557, 0.8400572963039973, 0.7694296310332691, 0.6812085308056872, 0.9725093984962407, 0.7169303599046941, 0.7834688995215311, 0.8688777856836791, 0.7044362351725791, 0.6619517842118914]
Epoch: 28, Steps: 535, | Train Loss: 0.00498

	iters: 100, epoch: 29 | loss: 0.0018358
	speed: 0.3621s/iter; left time: 351.5622s
	iters: 200, epoch: 29 | loss: 0.0049443
	speed: 0.2348s/iter; left time: 204.5296s
	iters: 300, epoch: 29 | loss: 0.0053131
	speed: 0.2352s/iter; left time: 181.3733s
	iters: 400, epoch: 29 | loss: 0.0039476
	speed: 0.2319s/iter; left time: 155.6047s
	iters: 500, epoch: 29 | loss: 0.0045066
	speed: 0.2314s/iter; left time: 132.1518s
Epoch: 29 cost time: 124.96243643760681
Test is reading ....
[0.7919669542433023, 0.9316293893118841, 0.8547713436216905, 0.8879594721960415, 0.9950135588382216, 0.9863296581745522, 0.6219092294924692, 0.6811490978157645, 0.8440739868049011, 0.8713172887440735, 0.961810980705643, 0.628820717397845, 0.4678301886792453, 0.6232565428616204, 0.8409316691813773, 0.7701072318020628, 0.682085308056872, 0.9713345864661653, 0.7155770597333111, 0.7826076555023923, 0.8670655434171577, 0.7053286475916394, 0.6599338313902365]
Epoch: 29, Steps: 535, | Train Loss: 0.00445

	iters: 100, epoch: 30 | loss: 0.0041556
	speed: 0.3638s/iter; left time: 158.5962s
	iters: 200, epoch: 30 | loss: 0.0029861
	speed: 0.2304s/iter; left time: 77.4189s
	iters: 300, epoch: 30 | loss: 0.0098496
	speed: 0.2315s/iter; left time: 54.6396s
	iters: 400, epoch: 30 | loss: 0.0077269
	speed: 0.2319s/iter; left time: 31.5330s
	iters: 500, epoch: 30 | loss: 0.0030943
	speed: 0.2321s/iter; left time: 8.3563s
Epoch: 30 cost time: 124.38059043884277
Test is reading ....
[0.7926892585149855, 0.9311368758035559, 0.8541386450516778, 0.8854264844486334, 0.9948975950902733, 0.9862181545707557, 0.6223800919358922, 0.6792997450892189, 0.8450164938737041, 0.8716587321717753, 0.9605392245921297, 0.6248203162434116, 0.46933962264150947, 0.620122237893747, 0.8413546381749066, 0.770453222706478, 0.6827014218009478, 0.9713345864661653, 0.7136907996488735, 0.7811124401913876, 0.8664365656240048, 0.7045953474643496, 0.6577387541829821]
Epoch: 30, Steps: 535, | Train Loss: 0.00447

>>>>>>>testing : my_classification_PTB-XL-Indep_Medformer_my_data_ftM_sl96_ll48_pl96_dm128_nh8_el6_dl1_df256_fc1_ebtimeF_dtTrue_Exp_seed41<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
Traceback (most recent call last):
  File "/data/0shared/zhangshanwei/cinc/baseline/Medformer-main/run.py", line 301, in <module>
    exp.test(setting)
TypeError: Exp_Basic.test() takes 1 positional argument but 2 were given
