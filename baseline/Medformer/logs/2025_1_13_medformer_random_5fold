nohup: ignoring input
Args in experiment:
Namespace(task_name='my_classification', is_training=1, model_id='PTB-XL-Indep', model='Medformer', data='my_data', root_path='./', data_path='ETTh1.csv', features='M', target='OT', freq='h', seq_len=96, label_len=48, pred_len=96, seasonal_patterns='Monthly', inverse=False, mask_rate=0.25, anomaly_ratio=0.25, expand=2, d_conv=4, top_k=5, num_kernels=6, enc_in=7, dec_in=7, c_out=7, d_model=128, n_heads=8, e_layers=6, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, no_inter_attn=False, chunk_size=16, patch_len=16, stride=8, sampling_rate=256, patch_len_list='2,4,8,8,16,16,16,16,32,32,32,32,32,32,32,32', single_channel=False, augmentations='flip0.5,shuffle0.5,frequency0.1,jitter0.2,scale0.2,mask0.1,drop0.5', num_workers=0, itr=5, train_epochs=30, batch_size=32, patience=10, learning_rate=0.0001, des='Exp', loss='MSE', lradj='type1', use_amp=False, swa=True, use_gpu=True, gpu=8, use_multi_gpu=False, devices='0,1,2,3', p_hidden_dims=[128, 128], p_hidden_layers=2)
Use GPU: cuda:8
>>>>>>>start training : my_classification_PTB-XL-Indep_Medformer_my_data_ftM_sl96_ll48_pl96_dm128_nh8_el6_dl1_df256_fc1_ebtimeF_dtTrue_Exp_seed41>>>>>>>>>>>>>>>>>>>>>>>>>>
TRAIN
Label to index mapping:
{'NORM': 0, 'LAFB/LPFB': 1, 'IRBBB': 2, 'ILBBB': 3, 'CLBBB': 4, 'CRBBB': 5, '_AVB': 6, 'IVCD': 7, 'WPW': 8, 'LVH': 9, 'RVH': 10, 'LAO/LAE': 11, 'RAO/RAE': 12, 'SEHYP': 13, 'AMI': 14, 'IMI': 15, 'LMI': 16, 'PMI': 17, 'ISCA': 18, 'ISCI': 19, 'ISC_': 20, 'STTC': 21, 'NST_': 22}
删除train中缺失label的数量:334
(17084, 1000, 12)
VAL
Label to index mapping:
{'NORM': 0, 'LAFB/LPFB': 1, 'IRBBB': 2, 'ILBBB': 3, 'CLBBB': 4, 'CRBBB': 5, '_AVB': 6, 'IVCD': 7, 'WPW': 8, 'LVH': 9, 'RVH': 10, 'LAO/LAE': 11, 'RAO/RAE': 12, 'SEHYP': 13, 'AMI': 14, 'IMI': 15, 'LMI': 16, 'PMI': 17, 'ISCA': 18, 'ISCI': 19, 'ISC_': 20, 'STTC': 21, 'NST_': 22}
删除val中缺失label的数量:37
(2146, 1000, 12)
TEST
Label to index mapping:
{'NORM': 0, 'LAFB/LPFB': 1, 'IRBBB': 2, 'ILBBB': 3, 'CLBBB': 4, 'CRBBB': 5, '_AVB': 6, 'IVCD': 7, 'WPW': 8, 'LVH': 9, 'RVH': 10, 'LAO/LAE': 11, 'RAO/RAE': 12, 'SEHYP': 13, 'AMI': 14, 'IMI': 15, 'LMI': 16, 'PMI': 17, 'ISCA': 18, 'ISCI': 19, 'ISC_': 20, 'STTC': 21, 'NST_': 22}
删除test中缺失label的数量:40
(2158, 1000, 12)
(17084, 1000, 12)
torch.Size([17084, 23])
(2146, 1000, 12)
torch.Size([2146, 23])
(2158, 1000, 12)
torch.Size([2158, 23])
	iters: 100, epoch: 1 | loss: 0.0577484
	speed: 0.3816s/iter; left time: 6075.9378s
	iters: 200, epoch: 1 | loss: 0.0690128
	speed: 0.2773s/iter; left time: 4386.4772s
	iters: 300, epoch: 1 | loss: 0.0613392
	speed: 0.2531s/iter; left time: 3978.3366s
	iters: 400, epoch: 1 | loss: 0.0505010
	speed: 0.2521s/iter; left time: 3937.5041s
	iters: 500, epoch: 1 | loss: 0.0520237
	speed: 0.2553s/iter; left time: 3961.7887s
Epoch: 1 cost time: 151.96465706825256
Test is reading ....
[0.7199333498438023, 0.8876019433097807, 0.7641696341293115, 0.8619767441860464, 0.9877306013237572, 0.9223524855654133, 0.6540985243667465, 0.6041853130460726, 0.6723255813953488, 0.8279669531941078, 0.9083954644299472, 0.6558196057250878, 0.5161545623836127, 0.21521335807050096, 0.7690678863337992, 0.6623041502362473, 0.5184752104770813, 0.9086270871985157, 0.576187872634018, 0.6188857412653447, 0.8101639470443349, 0.6016026356935448, 0.5439817270667823]
文件 'existing_file.xlsx' 不存在，将创建新文件。
	iters: 100, epoch: 2 | loss: 0.0419714
	speed: 0.4179s/iter; left time: 6429.9123s
	iters: 200, epoch: 2 | loss: 0.0387667
	speed: 0.2706s/iter; left time: 4136.3089s
	iters: 300, epoch: 2 | loss: 0.0291141
	speed: 0.2649s/iter; left time: 4023.3851s
	iters: 400, epoch: 2 | loss: 0.0569859
	speed: 0.2562s/iter; left time: 3864.8210s
	iters: 500, epoch: 2 | loss: 0.0427737
	speed: 0.2526s/iter; left time: 3785.3360s
Epoch: 2 cost time: 140.1404356956482
Test is reading ....
[0.7215709276711115, 0.9007088394623998, 0.7772308336824467, 0.853953488372093, 0.9920257710181665, 0.934498662160259, 0.6801776399266883, 0.6011653606590315, 0.6003488372093024, 0.8407368947348178, 0.9109583721652686, 0.7196867404806914, 0.5636871508379888, 0.3613172541743971, 0.7864294385860895, 0.6690433362227489, 0.5298175865294668, 0.8133116883116883, 0.6439584472389284, 0.6283876298394713, 0.8322313731527095, 0.6068470329833967, 0.6003419934222433]
Epoch: 2, Steps: 534, | Train Loss: 0.04420

	iters: 100, epoch: 3 | loss: 0.0437698
	speed: 0.3868s/iter; left time: 5744.5289s
	iters: 200, epoch: 3 | loss: 0.0316468
	speed: 0.2750s/iter; left time: 4056.3520s
	iters: 300, epoch: 3 | loss: 0.0459076
	speed: 0.2829s/iter; left time: 4145.1698s
	iters: 400, epoch: 3 | loss: 0.0372745
	speed: 0.2704s/iter; left time: 3935.1022s
	iters: 500, epoch: 3 | loss: 0.0438366
	speed: 0.2607s/iter; left time: 3767.6351s
Epoch: 3 cost time: 142.61595344543457
Test is reading ....
[0.7414782083534284, 0.9029107302655538, 0.7917670367267142, 0.8704651162790698, 0.9936540628080551, 0.9437843261512464, 0.6861459655058979, 0.600739157701183, 0.6276162790697675, 0.8460900542286834, 0.9130552966759864, 0.7246151768836079, 0.5772346368715084, 0.3525046382189239, 0.7959827919648781, 0.6805341911390143, 0.5257951356407857, 0.8692022263450835, 0.698117628680778, 0.644605760151086, 0.8408674568965518, 0.6658639527957709, 0.6308218451418836]
Epoch: 3, Steps: 534, | Train Loss: 0.03724

	iters: 100, epoch: 4 | loss: 0.0395493
	speed: 0.3872s/iter; left time: 5544.3434s
	iters: 200, epoch: 4 | loss: 0.0311149
	speed: 0.2524s/iter; left time: 3588.7818s
	iters: 300, epoch: 4 | loss: 0.0285380
	speed: 0.2515s/iter; left time: 3550.3804s
	iters: 400, epoch: 4 | loss: 0.0227991
	speed: 0.2338s/iter; left time: 3277.3602s
	iters: 500, epoch: 4 | loss: 0.0313051
	speed: 0.2309s/iter; left time: 3213.5742s
Epoch: 4 cost time: 130.0445339679718
Test is reading ....
[0.7523221105593139, 0.9017956701793413, 0.8007086999022484, 0.8778488372093023, 0.9941821574426136, 0.950772778481904, 0.6792083744536868, 0.610054736637015, 0.6938372093023256, 0.8518350255759394, 0.9252096924510718, 0.708704653884238, 0.5708566108007449, 0.3687384044526902, 0.8007682914778582, 0.6889343735229324, 0.5323433115060805, 0.823051948051948, 0.7286573459345466, 0.652880075542965, 0.852794027093596, 0.7139755974983247, 0.6602782128971462]
Epoch: 4, Steps: 534, | Train Loss: 0.03378

	iters: 100, epoch: 5 | loss: 0.0219669
	speed: 0.3652s/iter; left time: 5034.4444s
	iters: 200, epoch: 5 | loss: 0.0390160
	speed: 0.2384s/iter; left time: 3262.6141s
	iters: 300, epoch: 5 | loss: 0.0239338
	speed: 0.2336s/iter; left time: 3173.5532s
	iters: 400, epoch: 5 | loss: 0.0367739
	speed: 0.2351s/iter; left time: 3169.9852s
	iters: 500, epoch: 5 | loss: 0.0314440
	speed: 0.2348s/iter; left time: 3142.7263s
Epoch: 5 cost time: 125.670250415802
Test is reading ....
[0.7636117954266001, 0.8988231175950835, 0.8093230694037146, 0.8788372093023257, 0.9947366568089001, 0.95905506266723, 0.6787325532214861, 0.62477700452384, 0.7059302325581396, 0.8546618399292335, 0.9228797763280522, 0.7073431451975876, 0.5649441340782123, 0.35064935064935066, 0.802314050170104, 0.6991091247075094, 0.5334190832553789, 0.8671150278293136, 0.7404150068994246, 0.6653682719546742, 0.8581704125615764, 0.7253089866726231, 0.6705941823673682]
Epoch: 5, Steps: 534, | Train Loss: 0.03159

	iters: 100, epoch: 6 | loss: 0.0247870
	speed: 0.3620s/iter; left time: 4796.8880s
	iters: 200, epoch: 6 | loss: 0.0317939
	speed: 0.2322s/iter; left time: 3054.1571s
	iters: 300, epoch: 6 | loss: 0.0276063
	speed: 0.2343s/iter; left time: 3058.2911s
	iters: 400, epoch: 6 | loss: 0.0306027
	speed: 0.2356s/iter; left time: 3051.0284s
	iters: 500, epoch: 6 | loss: 0.0245650
	speed: 0.2366s/iter; left time: 3040.9300s
Epoch: 6 cost time: 125.7522497177124
Test is reading ....
[0.7649578331312974, 0.8960989834604126, 0.819477901131127, 0.8798837209302325, 0.9952383467117307, 0.9655330235178143, 0.6669780064852671, 0.6317180241230874, 0.7204069767441861, 0.8560127495096342, 0.9178316247281765, 0.6956521739130435, 0.5549813780260708, 0.3293135435992579, 0.8064801874673555, 0.7040236364213337, 0.5392890551917681, 0.8399814471243042, 0.7490692285662215, 0.6830146364494807, 0.8591209975369458, 0.731984308688854, 0.6709935907437109]
Epoch: 6, Steps: 534, | Train Loss: 0.02968

	iters: 100, epoch: 7 | loss: 0.0285242
	speed: 0.3769s/iter; left time: 4793.2914s
	iters: 200, epoch: 7 | loss: 0.0261101
	speed: 0.2570s/iter; left time: 3242.3662s
	iters: 300, epoch: 7 | loss: 0.0229649
	speed: 0.2426s/iter; left time: 3036.9552s
	iters: 400, epoch: 7 | loss: 0.0238761
	speed: 0.2465s/iter; left time: 3060.9357s
	iters: 500, epoch: 7 | loss: 0.0305694
	speed: 0.2619s/iter; left time: 3225.3698s
Epoch: 7 cost time: 134.1257245540619
Test is reading ....
[0.7717471117541503, 0.8955739171919682, 0.8276558790671693, 0.8769186046511628, 0.9955464019152233, 0.9708403745951275, 0.6583897269608534, 0.6392374620222722, 0.7409302325581395, 0.8561233221799162, 0.9133659521590556, 0.6846475830407777, 0.5493482309124766, 0.27968460111317256, 0.8095364135575036, 0.7079368737859862, 0.5501169317118803, 0.7884972170686457, 0.7556978833085995, 0.6850094428706326, 0.8603602216748768, 0.7344017571290299, 0.6695644576471103]
Epoch: 7, Steps: 534, | Train Loss: 0.02790

	iters: 100, epoch: 8 | loss: 0.0206418
	speed: 0.4022s/iter; left time: 4900.3562s
	iters: 200, epoch: 8 | loss: 0.0289631
	speed: 0.2564s/iter; left time: 3098.1761s
	iters: 300, epoch: 8 | loss: 0.0244997
	speed: 0.2426s/iter; left time: 2906.8906s
	iters: 400, epoch: 8 | loss: 0.0324441
	speed: 0.2639s/iter; left time: 3135.3429s
	iters: 500, epoch: 8 | loss: 0.0248080
	speed: 0.2594s/iter; left time: 3056.7004s
Epoch: 8 cost time: 139.18190574645996
Test is reading ....
[0.7756288098993295, 0.896485725819428, 0.8333158776707164, 0.8728488372093023, 0.9959248697366568, 0.9756636389240951, 0.6515637482964425, 0.6397306397306398, 0.7459883720930233, 0.8573179877697013, 0.9099487418452935, 0.6823971554595374, 0.5344972067039107, 0.23631725417439703, 0.8126879261423792, 0.7096621722058266, 0.5543264733395696, 0.6996753246753247, 0.7560571740998204, 0.6925991501416431, 0.8617495381773398, 0.7345018055245328, 0.6715927033082247]
Epoch: 8, Steps: 534, | Train Loss: 0.02635

	iters: 100, epoch: 9 | loss: 0.0304759
	speed: 0.4265s/iter; left time: 4968.5520s
	iters: 200, epoch: 9 | loss: 0.0294798
	speed: 0.2687s/iter; left time: 3103.4316s
	iters: 300, epoch: 9 | loss: 0.0212040
	speed: 0.2885s/iter; left time: 3303.0165s
	iters: 400, epoch: 9 | loss: 0.0220578
	speed: 0.2584s/iter; left time: 2932.4390s
	iters: 500, epoch: 9 | loss: 0.0324553
	speed: 0.2769s/iter; left time: 3115.3862s
Epoch: 9 cost time: 146.23403882980347
Test is reading ....
[0.7754402429645849, 0.8984815422269019, 0.8375096006144394, 0.8709883720930233, 0.996065694972539, 0.9784097310237995, 0.6439212369002303, 0.6386955754044361, 0.7439534883720931, 0.8591171974154841, 0.9039686237962099, 0.6721464578269871, 0.5292830540037243, 0.21846011131725418, 0.8140042914213923, 0.7139762533466278, 0.5644761459307764, 0.6451762523191095, 0.7580827410242391, 0.6965533522190746, 0.8636237684729063, 0.7329871193507558, 0.6686408257768182]
Epoch: 9, Steps: 534, | Train Loss: 0.02506

	iters: 100, epoch: 10 | loss: 0.0165884
	speed: 0.4118s/iter; left time: 4576.7947s
	iters: 200, epoch: 10 | loss: 0.0285891
	speed: 0.2835s/iter; left time: 3122.5273s
	iters: 300, epoch: 10 | loss: 0.0241385
	speed: 0.2832s/iter; left time: 3090.8895s
	iters: 400, epoch: 10 | loss: 0.0314143
	speed: 0.2767s/iter; left time: 2992.4421s
	iters: 500, epoch: 10 | loss: 0.0282245
	speed: 0.2472s/iter; left time: 2648.6061s
Epoch: 10 cost time: 145.20283126831055
Test is reading ....
[0.7759772676911847, 0.89981679139343, 0.8401672252478705, 0.8684302325581396, 0.9962945359808478, 0.9803284748626955, 0.6343519432304149, 0.6387747273823223, 0.7608720930232559, 0.8598154878658514, 0.8981826654240446, 0.6602979566117562, 0.5169459962756052, 0.17439703153988867, 0.8170569883821059, 0.7171145260773929, 0.5759354536950421, 0.6173469387755102, 0.7591866489624828, 0.7002478753541076, 0.8624268780788177, 0.7325403916313007, 0.6705879416114879]
Epoch: 10, Steps: 534, | Train Loss: 0.02305

	iters: 100, epoch: 11 | loss: 0.0232348
	speed: 0.4050s/iter; left time: 4285.0293s
	iters: 200, epoch: 11 | loss: 0.0242603
	speed: 0.2888s/iter; left time: 3027.1876s
	iters: 300, epoch: 11 | loss: 0.0219473
	speed: 0.2832s/iter; left time: 2940.3072s
	iters: 400, epoch: 11 | loss: 0.0199694
	speed: 0.2723s/iter; left time: 2799.0874s
	iters: 500, epoch: 11 | loss: 0.0232779
	speed: 0.2834s/iter; left time: 2885.4940s
Epoch: 11 cost time: 150.197762966156
Test is reading ....
[0.7758243286104701, 0.9018944729717904, 0.8419302471721827, 0.8677325581395349, 0.9964529643712153, 0.9819743698070694, 0.6298110813478077, 0.6390426263843986, 0.7711046511627907, 0.8594260797661629, 0.8913482447965206, 0.6532991268340985, 0.5092178770949721, 0.14749536178107603, 0.8187474413811601, 0.7211070971060749, 0.5757951356407858, 0.6298701298701299, 0.7608893748860944, 0.698270774315392, 0.8632312192118227, 0.7316306492442856, 0.6731279292547914]
Epoch: 11, Steps: 534, | Train Loss: 0.02132

	iters: 100, epoch: 12 | loss: 0.0164927
	speed: 0.4047s/iter; left time: 4065.8131s
	iters: 200, epoch: 12 | loss: 0.0156066
	speed: 0.2494s/iter; left time: 2480.5196s
	iters: 300, epoch: 12 | loss: 0.0167805
	speed: 0.2658s/iter; left time: 2617.1907s
	iters: 400, epoch: 12 | loss: 0.0229254
	speed: 0.2948s/iter; left time: 2873.3743s
	iters: 500, epoch: 12 | loss: 0.0168492
	speed: 0.2625s/iter; left time: 2532.3527s
Epoch: 12 cost time: 142.12296223640442
Test is reading ....
[0.7745851744678633, 0.9044887520078139, 0.8439594679514034, 0.8674418604651163, 0.996558583298127, 0.9831537811575835, 0.6224152920719959, 0.6390974239075505, 0.7670348837209302, 0.8605053651782624, 0.8864554209381796, 0.6464128184355027, 0.5055865921787709, 0.12987012987012986, 0.8214242860571155, 0.7237167571070436, 0.5835827876520112, 0.6282467532467533, 0.7614986070972949, 0.6999527856468366, 0.8628463669950739, 0.7313142171096717, 0.6723665570373885]
Epoch: 12, Steps: 534, | Train Loss: 0.01920

	iters: 100, epoch: 13 | loss: 0.0168958
	speed: 0.4171s/iter; left time: 3967.6459s
	iters: 200, epoch: 13 | loss: 0.0166836
	speed: 0.2752s/iter; left time: 2590.4082s
	iters: 300, epoch: 13 | loss: 0.0206605
	speed: 0.2714s/iter; left time: 2527.5538s
	iters: 400, epoch: 13 | loss: 0.0155591
	speed: 0.2701s/iter; left time: 2488.2514s
	iters: 500, epoch: 13 | loss: 0.0173276
	speed: 0.2610s/iter; left time: 2378.4583s
Epoch: 13 cost time: 143.6121551990509
Test is reading ....
[0.7744713391293769, 0.9061401701101792, 0.8450329912023461, 0.8655813953488373, 0.9966201943388255, 0.9841659625404873, 0.6156128107523849, 0.640972716922084, 0.7444186046511628, 0.8604957501634553, 0.8820285803044423, 0.6424070573408948, 0.5067039106145251, 0.10923005565862709, 0.8229118141136944, 0.7277201843213297, 0.5905285313376988, 0.6312615955473098, 0.7591189564945716, 0.7012157695939566, 0.8610491071428572, 0.7304928895837988, 0.6703133483527525]
Epoch: 13, Steps: 534, | Train Loss: 0.01723

	iters: 100, epoch: 14 | loss: 0.0116597
	speed: 0.4038s/iter; left time: 3625.5369s
	iters: 200, epoch: 14 | loss: 0.0100255
	speed: 0.2879s/iter; left time: 2556.6549s
	iters: 300, epoch: 14 | loss: 0.0138916
	speed: 0.2803s/iter; left time: 2460.8652s
	iters: 400, epoch: 14 | loss: 0.0146412
	speed: 0.2590s/iter; left time: 2247.7676s
	iters: 500, epoch: 14 | loss: 0.0170630
	speed: 0.2798s/iter; left time: 2400.4674s
Epoch: 14 cost time: 147.8526623249054
Test is reading ....
[0.7730323214153817, 0.9078311093295243, 0.847066575897221, 0.864593023255814, 0.9966730038022813, 0.9853101675820307, 0.6108193524131774, 0.6407596154431597, 0.7340697674418605, 0.8595054036383214, 0.8792715128922026, 0.6370622918354487, 0.5020949720670391, 0.09647495361781072, 0.8224530272872289, 0.7312760026522496, 0.5965622076707202, 0.6426252319109462, 0.7599312661095056, 0.7023961284230406, 0.8569273399014777, 0.726502587298042, 0.6691650492707676]
Epoch: 14, Steps: 534, | Train Loss: 0.01552

	iters: 100, epoch: 15 | loss: 0.0098060
	speed: 0.3977s/iter; left time: 3358.6251s
	iters: 200, epoch: 15 | loss: 0.0061002
	speed: 0.2817s/iter; left time: 2350.7588s
	iters: 300, epoch: 15 | loss: 0.0133257
	speed: 0.2835s/iter; left time: 2337.1590s
	iters: 400, epoch: 15 | loss: 0.0175896
	speed: 0.2603s/iter; left time: 2120.3819s
	iters: 500, epoch: 15 | loss: 0.0100251
	speed: 0.2863s/iter; left time: 2303.3145s
Epoch: 15 cost time: 146.6516649723053
Test is reading ....
[0.7741228813375218, 0.9093103282793352, 0.8476818880044686, 0.863546511627907, 0.9966377974933108, 0.9860318969159273, 0.6049391418769678, 0.6386346892676007, 0.7078488372093024, 0.8599188492750278, 0.8737962100031066, 0.6303110090917274, 0.5003258845437617, 0.08557513914656767, 0.8238664436256863, 0.7357554318507125, 0.6016838166510758, 0.6521335807050093, 0.759363690801635, 0.7034820585457979, 0.8538870073891626, 0.7244387983024347, 0.6652458545779065]
Epoch: 15, Steps: 534, | Train Loss: 0.01431

	iters: 100, epoch: 16 | loss: 0.0140137
	speed: 0.4243s/iter; left time: 3357.0012s
	iters: 200, epoch: 16 | loss: 0.0083507
	speed: 0.2688s/iter; left time: 2099.8515s
	iters: 300, epoch: 16 | loss: 0.0119031
	speed: 0.2759s/iter; left time: 2127.5027s
	iters: 400, epoch: 16 | loss: 0.0170075
	speed: 0.2696s/iter; left time: 2051.5504s
	iters: 500, epoch: 16 | loss: 0.0100348
	speed: 0.2822s/iter; left time: 2119.4092s
Epoch: 16 cost time: 147.1582474708557
Test is reading ....
[0.7757617626229052, 0.9108601206523242, 0.8485808546292417, 0.8623255813953489, 0.9965497817208844, 0.9869208562174341, 0.5988768269185583, 0.6383667902655246, 0.6992441860465117, 0.8601327833544863, 0.8700877601739669, 0.6211517688360788, 0.5006052141527001, 0.06632653061224492, 0.8238858538375753, 0.7392010181431915, 0.6040458372310571, 0.648886827458256, 0.7578744565075894, 0.7014282341831917, 0.8487838669950739, 0.7232382175563993, 0.6629617379256975]
Epoch: 16, Steps: 534, | Train Loss: 0.01308

	iters: 100, epoch: 17 | loss: 0.0107370
	speed: 0.4272s/iter; left time: 3151.7399s
	iters: 200, epoch: 17 | loss: 0.0158399
	speed: 0.2639s/iter; left time: 1920.6399s
	iters: 300, epoch: 17 | loss: 0.0081580
	speed: 0.2549s/iter; left time: 1829.6625s
	iters: 400, epoch: 17 | loss: 0.0089514
	speed: 0.2760s/iter; left time: 1953.0492s
	iters: 500, epoch: 17 | loss: 0.0076301
	speed: 0.2798s/iter; left time: 1952.0388s
Epoch: 17 cost time: 145.66818165779114
Test is reading ....
[0.7764751886755563, 0.9115122190824889, 0.850252234324815, 0.8619186046511629, 0.9965673848753697, 0.9874929587382059, 0.5948059119319518, 0.6391887531128038, 0.6881976744186046, 0.8606015153263336, 0.867117117117117, 0.6119700243046179, 0.5008379888268155, 0.06238404452690166, 0.8238876184022924, 0.7422323992003167, 0.6029232927970065, 0.6410018552875696, 0.7572808456351376, 0.7029036827195467, 0.8451008312807882, 0.7222726342044524, 0.6617822350643109]
Epoch: 17, Steps: 534, | Train Loss: 0.01147

	iters: 100, epoch: 18 | loss: 0.0067884
	speed: 0.4226s/iter; left time: 2891.8140s
	iters: 200, epoch: 18 | loss: 0.0120409
	speed: 0.2852s/iter; left time: 1923.4198s
	iters: 300, epoch: 18 | loss: 0.0103552
	speed: 0.2753s/iter; left time: 1829.0861s
	iters: 400, epoch: 18 | loss: 0.0055447
	speed: 0.2586s/iter; left time: 1692.2913s
	iters: 500, epoch: 18 | loss: 0.0085220
	speed: 0.2655s/iter; left time: 1710.9281s
Epoch: 18 cost time: 144.40454292297363
Test is reading ....
[0.7765229821382795, 0.9117606375320756, 0.8517097821533305, 0.8611046511627908, 0.9964969722574286, 0.9876777918603015, 0.5888493350251421, 0.6381780432413344, 0.6813953488372092, 0.8612216837813932, 0.8636999068033551, 0.6078517418309479, 0.5019553072625699, 0.05728200371057518, 0.824625206454072, 0.7451251551181904, 0.6042797006548176, 0.6375231910946197, 0.755473977453201, 0.7038007554296506, 0.8398591440886699, 0.7204647829647829, 0.6600597864413338]
Epoch: 18, Steps: 534, | Train Loss: 0.01050

	iters: 100, epoch: 19 | loss: 0.0074916
	speed: 0.3941s/iter; left time: 2486.4960s
	iters: 200, epoch: 19 | loss: 0.0085284
	speed: 0.2799s/iter; left time: 1738.1947s
	iters: 300, epoch: 19 | loss: 0.0091971
	speed: 0.2692s/iter; left time: 1644.2569s
	iters: 400, epoch: 19 | loss: 0.0073177
	speed: 0.2576s/iter; left time: 1547.7197s
	iters: 500, epoch: 19 | loss: 0.0082340
	speed: 0.2668s/iter; left time: 1576.5116s
Epoch: 19 cost time: 142.75079822540283
Test is reading ....
[0.7770947657468597, 0.9126809149703168, 0.853128054740958, 0.8595930232558139, 0.9963737501760316, 0.9882146880721026, 0.5841821749142346, 0.6380593152745051, 0.6708720930232558, 0.861627918156994, 0.8630397639018329, 0.6047574039067423, 0.5056797020484172, 0.056354359925788466, 0.8254069086237807, 0.747104321262925, 0.607132834424696, 0.6280148423005566, 0.754427347757036, 0.7020656279508971, 0.8354141009852216, 0.7181078289032834, 0.6613516229085667]
Epoch: 19, Steps: 534, | Train Loss: 0.00935

	iters: 100, epoch: 20 | loss: 0.0151636
	speed: 0.4155s/iter; left time: 2399.4597s
	iters: 200, epoch: 20 | loss: 0.0032380
	speed: 0.2608s/iter; left time: 1479.7573s
	iters: 300, epoch: 20 | loss: 0.0037716
	speed: 0.2733s/iter; left time: 1523.5354s
	iters: 400, epoch: 20 | loss: 0.0065498
	speed: 0.2737s/iter; left time: 1498.4950s
	iters: 500, epoch: 20 | loss: 0.0105442
	speed: 0.2752s/iter; left time: 1478.9409s
Epoch: 20 cost time: 145.53667855262756
Test is reading ....
[0.7778733647032243, 0.9132596170403765, 0.8542364893171345, 0.8600581395348837, 0.9962945359808478, 0.9885931558935361, 0.5815181634475305, 0.6372525739614348, 0.6630813953488371, 0.8612962001461482, 0.8607486797141969, 0.6009429291565397, 0.5089851024208566, 0.06076066790352508, 0.8255498383658718, 0.7489264902620014, 0.6095416276894293, 0.6192022263450836, 0.7531307766408916, 0.703399433427762, 0.8313308189655173, 0.7151785049512323, 0.6620568283230465]
Epoch: 20, Steps: 534, | Train Loss: 0.00866

	iters: 100, epoch: 21 | loss: 0.0140587
	speed: 0.4160s/iter; left time: 2180.1439s
	iters: 200, epoch: 21 | loss: 0.0122125
	speed: 0.2906s/iter; left time: 1493.9694s
	iters: 300, epoch: 21 | loss: 0.0060754
	speed: 0.2746s/iter; left time: 1384.2308s
	iters: 400, epoch: 21 | loss: 0.0042870
	speed: 0.2937s/iter; left time: 1451.2698s
	iters: 500, epoch: 21 | loss: 0.0193168
	speed: 0.2696s/iter; left time: 1305.0025s
Epoch: 21 cost time: 149.08509850502014
Test is reading ....
[0.7782270363273766, 0.9137169328225699, 0.8549870828096635, 0.8601744186046513, 0.9961537107449655, 0.9889540205604845, 0.578128671460125, 0.6359465663263133, 0.6590697674418605, 0.8612457213184108, 0.8558946877912396, 0.5980061211630209, 0.5128026070763502, 0.06771799628942488, 0.8269720775279155, 0.7496864232542836, 0.6105472404115996, 0.6094619666048238, 0.7520893540576427, 0.7042138810198301, 0.8285483374384237, 0.712435317548954, 0.6619320132054394]
Epoch: 21, Steps: 534, | Train Loss: 0.00787

	iters: 100, epoch: 22 | loss: 0.0085426
	speed: 0.4270s/iter; left time: 2009.9688s
	iters: 200, epoch: 22 | loss: 0.0063378
	speed: 0.2695s/iter; left time: 1241.5689s
	iters: 300, epoch: 22 | loss: 0.0056301
	speed: 0.2746s/iter; left time: 1237.6570s
	iters: 400, epoch: 22 | loss: 0.0073504
	speed: 0.2655s/iter; left time: 1169.8703s
	iters: 500, epoch: 22 | loss: 0.0032902
	speed: 0.2722s/iter; left time: 1172.4933s
Epoch: 22 cost time: 145.66169333457947
Test is reading ....
[0.7790768909918012, 0.9144141982435686, 0.8560169669040636, 0.8601162790697674, 0.9961889170539361, 0.9891124489508519, 0.5764309882983224, 0.6347805968059131, 0.6551744186046511, 0.8614716741663783, 0.8541084187635911, 0.597004680889369, 0.5172253258845438, 0.07676252319109461, 0.8273991021894718, 0.7519996258791423, 0.6124415341440598, 0.5967068645640075, 0.7508760967481579, 0.7046742209631729, 0.826096828817734, 0.7110160263569354, 0.6626434593757995]
Epoch: 22, Steps: 534, | Train Loss: 0.00748

	iters: 100, epoch: 23 | loss: 0.0048825
	speed: 0.3981s/iter; left time: 1661.3974s
	iters: 200, epoch: 23 | loss: 0.0049000
	speed: 0.2785s/iter; left time: 1134.2350s
	iters: 300, epoch: 23 | loss: 0.0046128
	speed: 0.2739s/iter; left time: 1088.3814s
	iters: 400, epoch: 23 | loss: 0.0147736
	speed: 0.2837s/iter; left time: 1098.6842s
	iters: 500, epoch: 23 | loss: 0.0070987
	speed: 0.2690s/iter; left time: 1015.0218s
Epoch: 23 cost time: 145.83820962905884
Test is reading ....
[0.7794149211190623, 0.9149449103858672, 0.8570992179863147, 0.859767441860465, 0.9961097028587522, 0.9892884804957048, 0.5757789369801213, 0.6332097344755573, 0.6516279069767441, 0.8611423599092343, 0.8518173345759552, 0.5942929156539742, 0.522486033519553, 0.08487940630797774, 0.8280184644052005, 0.7536447555437529, 0.6122778297474276, 0.5846474953617811, 0.7510947954906403, 0.7061024551463645, 0.8242918719211823, 0.7099666815575907, 0.6643222227076142]
Epoch: 23, Steps: 534, | Train Loss: 0.00682

	iters: 100, epoch: 24 | loss: 0.0083271
	speed: 0.4200s/iter; left time: 1528.4776s
	iters: 200, epoch: 24 | loss: 0.0034832
	speed: 0.2793s/iter; left time: 988.4972s
	iters: 300, epoch: 24 | loss: 0.0060145
	speed: 0.2817s/iter; left time: 968.7800s
	iters: 400, epoch: 24 | loss: 0.0077851
	speed: 0.2766s/iter; left time: 923.6998s
	iters: 500, epoch: 24 | loss: 0.0091265
	speed: 0.2655s/iter; left time: 859.7983s
Epoch: 24 cost time: 146.80689334869385
Test is reading ....
[0.781078133621832, 0.9154502160958218, 0.8578410836475352, 0.8586046511627907, 0.99596887762287, 0.9894733136178003, 0.5754617228253208, 0.6320772523304169, 0.6490697674418605, 0.8609861159186184, 0.851040695868282, 0.5932014582770726, 0.5284450651769088, 0.09067717996289426, 0.8296700969804769, 0.7551061651442954, 0.615598690364827, 0.5716604823747681, 0.7515894712176832, 0.7070349386213409, 0.8221482450738917, 0.7092011949966496, 0.6650461503897352]
Epoch: 24, Steps: 534, | Train Loss: 0.00619

	iters: 100, epoch: 25 | loss: 0.0083119
	speed: 0.4227s/iter; left time: 1312.5013s
	iters: 200, epoch: 25 | loss: 0.0083752
	speed: 0.2828s/iter; left time: 849.8481s
	iters: 300, epoch: 25 | loss: 0.0032952
	speed: 0.2614s/iter; left time: 759.2939s
	iters: 400, epoch: 25 | loss: 0.0093674
	speed: 0.2873s/iter; left time: 806.0049s
	iters: 500, epoch: 25 | loss: 0.0032121
	speed: 0.2819s/iter; left time: 762.6374s
Epoch: 25 cost time: 149.5267825126648
Test is reading ....
[0.781307107756879, 0.9160345640397357, 0.8588491481636643, 0.8573837209302324, 0.9958808618504436, 0.9895877341219547, 0.5735819352413177, 0.6323816830145944, 0.6474418604651164, 0.8605269989615782, 0.8497980739360049, 0.5924925735889819, 0.534217877094972, 0.09763450834879406, 0.8310146952949646, 0.75633040884395, 0.6172357343311505, 0.564935064935065, 0.7510531385873103, 0.7083451369216242, 0.8196428571428571, 0.708486895986896, 0.6658824116777025]
Epoch: 25, Steps: 534, | Train Loss: 0.00566

	iters: 100, epoch: 26 | loss: 0.0056140
	speed: 0.4183s/iter; left time: 1075.4206s
	iters: 200, epoch: 26 | loss: 0.0042752
	speed: 0.2829s/iter; left time: 699.1151s
	iters: 300, epoch: 26 | loss: 0.0021695
	speed: 0.2897s/iter; left time: 686.8059s
	iters: 400, epoch: 26 | loss: 0.0041863
	speed: 0.2879s/iter; left time: 653.7249s
	iters: 500, epoch: 26 | loss: 0.0036232
	speed: 0.2719s/iter; left time: 590.3417s
Epoch: 26 cost time: 149.64978623390198
Test is reading ....
[0.7817359454633142, 0.9164551816418767, 0.8598048456919425, 0.8573255813953486, 0.995722433460076, 0.9896493451626531, 0.5726009210959162, 0.6324182146966957, 0.6466279069767441, 0.8594068497365486, 0.8500698974836906, 0.5916149068322982, 0.5375698324022347, 0.10714285714285715, 0.8320187326190376, 0.7576147791100266, 0.6199017773620206, 0.5679499072356216, 0.7508292327319118, 0.7088408876298395, 0.818157327586207, 0.708428728315092, 0.6676859901271243]
Epoch: 26, Steps: 534, | Train Loss: 0.00594

	iters: 100, epoch: 27 | loss: 0.0029701
	speed: 0.3873s/iter; left time: 788.9216s
	iters: 200, epoch: 27 | loss: 0.0041206
	speed: 0.2700s/iter; left time: 522.9916s
	iters: 300, epoch: 27 | loss: 0.0032728
	speed: 0.2646s/iter; left time: 486.1293s
	iters: 400, epoch: 27 | loss: 0.0043033
	speed: 0.2937s/iter; left time: 510.2395s
	iters: 500, epoch: 27 | loss: 0.0044554
	speed: 0.2840s/iter; left time: 464.9485s
Epoch: 27 cost time: 144.25057864189148
Test is reading ....
[0.7825536481619069, 0.9167628817669327, 0.8604987082809663, 0.8569186046511628, 0.9955728066469511, 0.9896845514716237, 0.5721309741999153, 0.6328505062682277, 0.6461627906976743, 0.8594525210568824, 0.8492155949052501, 0.5903659195247097, 0.5398975791433893, 0.11294063079777361, 0.8327739663179887, 0.7597659740420252, 0.6237371375116931, 0.5630797773654916, 0.7504595277148585, 0.7100330500472143, 0.815625, 0.7077260628396993, 0.6676922308830046]
Epoch: 27, Steps: 534, | Train Loss: 0.00499

	iters: 100, epoch: 28 | loss: 0.0159384
	speed: 0.3853s/iter; left time: 579.1225s
	iters: 200, epoch: 28 | loss: 0.0021727
	speed: 0.2826s/iter; left time: 396.4564s
	iters: 300, epoch: 28 | loss: 0.0020983
	speed: 0.2685s/iter; left time: 349.9043s
	iters: 400, epoch: 28 | loss: 0.0086710
	speed: 0.2521s/iter; left time: 303.2218s
	iters: 500, epoch: 28 | loss: 0.0097026
	speed: 0.2692s/iter; left time: 296.9379s
Epoch: 28 cost time: 142.9767668247223
Test is reading ....
[0.7827422150966514, 0.916771350577714, 0.8609438276776986, 0.8571511627906977, 0.9952735530207013, 0.9897637656668075, 0.5716962733211147, 0.6317545558051887, 0.6442441860465116, 0.8597842390677282, 0.8487496116806462, 0.5886218381492484, 0.5431564245810057, 0.1224489795918367, 0.8335027315461823, 0.760970175552872, 0.6262862488306828, 0.560064935064935, 0.7503710067952823, 0.7126298394711992, 0.8135698891625616, 0.7068535477626386, 0.6686283442650575]
Epoch: 28, Steps: 534, | Train Loss: 0.00472

	iters: 100, epoch: 29 | loss: 0.0046008
	speed: 0.4351s/iter; left time: 421.5920s
	iters: 200, epoch: 29 | loss: 0.0027285
	speed: 0.2600s/iter; left time: 225.9352s
	iters: 300, epoch: 29 | loss: 0.0069179
	speed: 0.2717s/iter; left time: 208.9574s
	iters: 400, epoch: 29 | loss: 0.0032546
	speed: 0.2699s/iter; left time: 180.5656s
	iters: 500, epoch: 29 | loss: 0.0053440
	speed: 0.2689s/iter; left time: 153.0237s
Epoch: 29 cost time: 144.12736439704895
Test is reading ....
[0.7828977610935145, 0.9167290065238072, 0.8614107666527021, 0.8556976744186047, 0.995185537248275, 0.9898165751302634, 0.5715846609333145, 0.6307073142516181, 0.641453488372093, 0.8596352063382178, 0.8459537123330226, 0.5865064362228823, 0.5477188081936686, 0.13033395176252316, 0.8343267832691033, 0.7612641276553813, 0.6303086997193639, 0.5586734693877551, 0.7506079304329715, 0.7141761095372994, 0.8117957204433498, 0.7052737137964411, 0.6696705504970761]
Epoch: 29, Steps: 534, | Train Loss: 0.00472

	iters: 100, epoch: 30 | loss: 0.0025943
	speed: 0.4071s/iter; left time: 177.1035s
	iters: 200, epoch: 30 | loss: 0.0017652
	speed: 0.2637s/iter; left time: 88.3553s
	iters: 300, epoch: 30 | loss: 0.0025972
	speed: 0.2418s/iter; left time: 56.8297s
	iters: 400, epoch: 30 | loss: 0.0064736
	speed: 0.2440s/iter; left time: 32.9370s
	iters: 500, epoch: 30 | loss: 0.0015051
	speed: 0.2670s/iter; left time: 9.3460s
Epoch: 30 cost time: 138.13049387931824
Test is reading ....
[0.7825831932115903, 0.9168362781270378, 0.862065354000838, 0.8544186046511629, 0.9950007041261794, 0.989851781439234, 0.5700808308661122, 0.6295504776517434, 0.6383720930232558, 0.859019845390562, 0.8449440820130475, 0.5832883247817086, 0.5538175046554935, 0.12987012987012986, 0.834505004305538, 0.7615948237707041, 0.6346819457436856, 0.5561224489795917, 0.7501887578432138, 0.7148843248347497, 0.8084398091133006, 0.7038660561387833, 0.6699950698028544]
Epoch: 30, Steps: 534, | Train Loss: 0.00452

>>>>>>>testing : my_classification_PTB-XL-Indep_Medformer_my_data_ftM_sl96_ll48_pl96_dm128_nh8_el6_dl1_df256_fc1_ebtimeF_dtTrue_Exp_seed41<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
Traceback (most recent call last):
  File "/data/0shared/zhangshanwei/cinc/baseline/Medformer-main/run.py", line 301, in <module>
    exp.test(setting)
TypeError: Exp_Basic.test() takes 1 positional argument but 2 were given
