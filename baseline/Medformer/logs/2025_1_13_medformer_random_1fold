nohup: ignoring input
Args in experiment:
Namespace(task_name='my_classification', is_training=1, model_id='PTB-XL-Indep', model='Medformer', data='my_data', root_path='./', data_path='ETTh1.csv', features='M', target='OT', freq='h', seq_len=96, label_len=48, pred_len=96, seasonal_patterns='Monthly', inverse=False, mask_rate=0.25, anomaly_ratio=0.25, expand=2, d_conv=4, top_k=5, num_kernels=6, enc_in=7, dec_in=7, c_out=7, d_model=128, n_heads=8, e_layers=6, d_layers=1, d_ff=256, moving_avg=25, factor=1, distil=True, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, no_inter_attn=False, chunk_size=16, patch_len=16, stride=8, sampling_rate=256, patch_len_list='2,4,8,8,16,16,16,16,32,32,32,32,32,32,32,32', single_channel=False, augmentations='flip0.5,shuffle0.5,frequency0.1,jitter0.2,scale0.2,mask0.1,drop0.5', num_workers=0, itr=5, train_epochs=30, batch_size=32, patience=10, learning_rate=0.0001, des='Exp', loss='MSE', lradj='type1', use_amp=False, swa=True, use_gpu=True, gpu=8, use_multi_gpu=False, devices='0,1,2,3', p_hidden_dims=[128, 128], p_hidden_layers=2)
Use GPU: cuda:8
>>>>>>>start training : my_classification_PTB-XL-Indep_Medformer_my_data_ftM_sl96_ll48_pl96_dm128_nh8_el6_dl1_df256_fc1_ebtimeF_dtTrue_Exp_seed41>>>>>>>>>>>>>>>>>>>>>>>>>>
TRAIN
Label to index mapping:
{'NORM': 0, 'LAFB/LPFB': 1, 'IRBBB': 2, 'ILBBB': 3, 'CLBBB': 4, 'CRBBB': 5, '_AVB': 6, 'IVCD': 7, 'WPW': 8, 'LVH': 9, 'RVH': 10, 'LAO/LAE': 11, 'RAO/RAE': 12, 'SEHYP': 13, 'AMI': 14, 'IMI': 15, 'LMI': 16, 'PMI': 17, 'ISCA': 18, 'ISCI': 19, 'ISC_': 20, 'STTC': 21, 'NST_': 22}
删除train中缺失label的数量:332
(17111, 1000, 12)
VAL
Label to index mapping:
{'NORM': 0, 'LAFB/LPFB': 1, 'IRBBB': 2, 'ILBBB': 3, 'CLBBB': 4, 'CRBBB': 5, '_AVB': 6, 'IVCD': 7, 'WPW': 8, 'LVH': 9, 'RVH': 10, 'LAO/LAE': 11, 'RAO/RAE': 12, 'SEHYP': 13, 'AMI': 14, 'IMI': 15, 'LMI': 16, 'PMI': 17, 'ISCA': 18, 'ISCI': 19, 'ISC_': 20, 'STTC': 21, 'NST_': 22}
删除val中缺失label的数量:36
(2139, 1000, 12)
TEST
Label to index mapping:
{'NORM': 0, 'LAFB/LPFB': 1, 'IRBBB': 2, 'ILBBB': 3, 'CLBBB': 4, 'CRBBB': 5, '_AVB': 6, 'IVCD': 7, 'WPW': 8, 'LVH': 9, 'RVH': 10, 'LAO/LAE': 11, 'RAO/RAE': 12, 'SEHYP': 13, 'AMI': 14, 'IMI': 15, 'LMI': 16, 'PMI': 17, 'ISCA': 18, 'ISCI': 19, 'ISC_': 20, 'STTC': 21, 'NST_': 22}
删除test中缺失label的数量:43
(2138, 1000, 12)
(17111, 1000, 12)
torch.Size([17111, 23])
(2139, 1000, 12)
torch.Size([2139, 23])
(2138, 1000, 12)
torch.Size([2138, 23])
	iters: 100, epoch: 1 | loss: 0.0520636
	speed: 0.2507s/iter; left time: 3999.4191s
	iters: 200, epoch: 1 | loss: 0.0781516
	speed: 0.2329s/iter; left time: 3691.1582s
	iters: 300, epoch: 1 | loss: 0.0771067
	speed: 0.2323s/iter; left time: 3659.6555s
	iters: 400, epoch: 1 | loss: 0.0449395
	speed: 0.2301s/iter; left time: 3601.4445s
	iters: 500, epoch: 1 | loss: 0.0640900
	speed: 0.2325s/iter; left time: 3616.0480s
Epoch: 1 cost time: 126.13821697235107
Test is reading ....
[0.7333756050432858, 0.8639084471897359, 0.723745328585531, 0.8858568075117371, 0.9840584346342504, 0.8553834067996334, 0.6272351797862002, 0.620726541703297, 0.8109741784037559, 0.8375123865778071, 0.7585520361990951, 0.6752067491813287, 0.6111842105263158, 0.17142857142857146, 0.7513062227258738, 0.6375479781221451, 0.4631728045325779, 0.596630790828264, 0.6189453074683773, 0.44228020669183127, 0.8188316231343284, 0.5278600615860155, 0.5861547477268001]
文件 'existing_file.xlsx' 不存在，将创建新文件。
	iters: 100, epoch: 2 | loss: 0.0509073
	speed: 0.3599s/iter; left time: 5547.8475s
	iters: 200, epoch: 2 | loss: 0.0361115
	speed: 0.2313s/iter; left time: 3542.9680s
	iters: 300, epoch: 2 | loss: 0.0476519
	speed: 0.2319s/iter; left time: 3528.7526s
	iters: 400, epoch: 2 | loss: 0.0478346
	speed: 0.2317s/iter; left time: 3502.4224s
	iters: 500, epoch: 2 | loss: 0.0309406
	speed: 0.2307s/iter; left time: 3464.7825s
Epoch: 2 cost time: 124.15118837356567
Test is reading ....
[0.7437619054768064, 0.8925657543895672, 0.7469944295585955, 0.9300469483568075, 0.9893012013933319, 0.9211932090952735, 0.6323068513119534, 0.6630108016057936, 0.829225352112676, 0.8455442322264751, 0.8276561085972851, 0.7323638785591386, 0.5984492481203008, 0.22185792349726777, 0.7705815693174196, 0.6616607311418329, 0.5555240793201134, 0.47730463266261114, 0.676739572867558, 0.5617937723702373, 0.839727145522388, 0.5737521806835345, 0.5798786366471956]
Epoch: 2, Steps: 535, | Train Loss: 0.04433

	iters: 100, epoch: 3 | loss: 0.0486749
	speed: 0.3598s/iter; left time: 5353.8879s
	iters: 200, epoch: 3 | loss: 0.0299369
	speed: 0.2330s/iter; left time: 3443.2842s
	iters: 300, epoch: 3 | loss: 0.0333233
	speed: 0.2334s/iter; left time: 3426.3453s
	iters: 400, epoch: 3 | loss: 0.0415915
	speed: 0.2381s/iter; left time: 3471.8903s
	iters: 500, epoch: 3 | loss: 0.0383254
	speed: 0.2336s/iter; left time: 3382.7396s
Epoch: 3 cost time: 125.1137478351593
Test is reading ....
[0.7624689033582166, 0.9078654312854865, 0.7646400366661966, 0.9076291079812207, 0.9921269638160233, 0.9492166019290358, 0.6367832847424685, 0.6774887649774683, 0.8620892018779343, 0.8532287679483942, 0.8409411764705882, 0.7291446966753621, 0.5789943609022556, 0.3400468384074941, 0.7866333877110993, 0.6791591311675, 0.5407341831916903, 0.38675713617220403, 0.7200092742870392, 0.5778698036916234, 0.8582283893034827, 0.6413328806097718, 0.6512347429377996]
Epoch: 3, Steps: 535, | Train Loss: 0.03697

	iters: 100, epoch: 4 | loss: 0.0325980
	speed: 0.3593s/iter; left time: 5153.8613s
	iters: 200, epoch: 4 | loss: 0.0335556
	speed: 0.2308s/iter; left time: 3288.3247s
	iters: 300, epoch: 4 | loss: 0.0299416
	speed: 0.2336s/iter; left time: 3304.8353s
	iters: 400, epoch: 4 | loss: 0.0271350
	speed: 0.2324s/iter; left time: 3264.4202s
	iters: 500, epoch: 4 | loss: 0.0280543
	speed: 0.2316s/iter; left time: 3230.2210s
Epoch: 4 cost time: 124.42893052101135
Test is reading ....
[0.777708796784053, 0.9134577269784778, 0.7769884360456917, 0.888849765258216, 0.9936375915262672, 0.9599354078470738, 0.6447339650145772, 0.6838086572687984, 0.8897300469483569, 0.8591257504808906, 0.8437285067873302, 0.7386690348004662, 0.5735432330827067, 0.3333333333333333, 0.794540994134673, 0.6940865961833647, 0.5166666666666666, 0.342536265793168, 0.7428446299301853, 0.5811192142778613, 0.8698732898009951, 0.6801320703907081, 0.684379666912418]
Epoch: 4, Steps: 535, | Train Loss: 0.03376

	iters: 100, epoch: 5 | loss: 0.0264543
	speed: 0.3627s/iter; left time: 5009.2857s
	iters: 200, epoch: 5 | loss: 0.0348077
	speed: 0.2320s/iter; left time: 3180.4185s
	iters: 300, epoch: 5 | loss: 0.0377269
	speed: 0.2332s/iter; left time: 3174.5470s
	iters: 400, epoch: 5 | loss: 0.0350935
	speed: 0.2291s/iter; left time: 3095.8977s
	iters: 500, epoch: 5 | loss: 0.0327204
	speed: 0.2318s/iter; left time: 3108.4915s
Epoch: 5 cost time: 123.90272951126099
Test is reading ....
[0.7831788031513031, 0.9162724112461894, 0.7912935411084474, 0.8943661971830987, 0.9945706262884766, 0.9673460480949679, 0.650188289601555, 0.6918806597770825, 0.9076291079812207, 0.8630020207123011, 0.8511131221719458, 0.7481156685352722, 0.5631109022556391, 0.5391100702576113, 0.7982110485895284, 0.7066820669473165, 0.5201841359773371, 0.3284978942442677, 0.7498209547363269, 0.6105471469930737, 0.8780628109452736, 0.6975588052781323, 0.7079717953080398]
Epoch: 5, Steps: 535, | Train Loss: 0.03160

	iters: 100, epoch: 6 | loss: 0.0238838
	speed: 0.3576s/iter; left time: 4748.0240s
	iters: 200, epoch: 6 | loss: 0.0230610
	speed: 0.2307s/iter; left time: 3039.8089s
	iters: 300, epoch: 6 | loss: 0.0249263
	speed: 0.2328s/iter; left time: 3044.6387s
	iters: 400, epoch: 6 | loss: 0.0389156
	speed: 0.2325s/iter; left time: 3017.1812s
	iters: 500, epoch: 6 | loss: 0.0268108
	speed: 0.2302s/iter; left time: 2963.9070s
Epoch: 6 cost time: 124.05473804473877
Test is reading ....
[0.7871916718843969, 0.9182401236521882, 0.8027737625158651, 0.893661971830986, 0.9951126750550936, 0.9745210142713743, 0.6481353255587949, 0.6937864638727169, 0.8913732394366196, 0.8655740571628422, 0.8623710407239821, 0.7487262030304712, 0.5512687969924812, 0.6582357533177206, 0.7998904142731851, 0.7159441874916623, 0.5492445703493862, 0.31305568554047736, 0.7509184120359637, 0.6106693052857893, 0.8839474502487562, 0.7062382184547296, 0.7145125616741337]
Epoch: 6, Steps: 535, | Train Loss: 0.02966

	iters: 100, epoch: 7 | loss: 0.0251999
	speed: 0.3634s/iter; left time: 4630.4840s
	iters: 200, epoch: 7 | loss: 0.0253657
	speed: 0.2340s/iter; left time: 2957.8789s
	iters: 300, epoch: 7 | loss: 0.0316411
	speed: 0.2352s/iter; left time: 2949.8100s
	iters: 400, epoch: 7 | loss: 0.0232482
	speed: 0.2320s/iter; left time: 2886.7193s
	iters: 500, epoch: 7 | loss: 0.0291829
	speed: 0.2338s/iter; left time: 2885.5182s
Epoch: 7 cost time: 124.95109558105469
Test is reading ....
[0.7900511941022134, 0.9200795069882307, 0.8140380411789592, 0.9067488262910798, 0.9954503447785598, 0.9785449308252956, 0.6490524781341108, 0.6932762001954986, 0.8673122065727699, 0.86694872442536, 0.8712760180995475, 0.7514181051229394, 0.5362781954887218, 0.7183450429352068, 0.8008492893828153, 0.7224504683407719, 0.5525731822474031, 0.3341132428638278, 0.746296725661437, 0.6134300827011642, 0.8869169776119402, 0.7077076186350384, 0.714777216960623]
Epoch: 7, Steps: 535, | Train Loss: 0.02799

	iters: 100, epoch: 8 | loss: 0.0210944
	speed: 0.3610s/iter; left time: 4406.8422s
	iters: 200, epoch: 8 | loss: 0.0196051
	speed: 0.2320s/iter; left time: 2808.5740s
	iters: 300, epoch: 8 | loss: 0.0227216
	speed: 0.2334s/iter; left time: 2802.3874s
	iters: 400, epoch: 8 | loss: 0.0289518
	speed: 0.2339s/iter; left time: 2785.2066s
	iters: 500, epoch: 8 | loss: 0.0281378
	speed: 0.2331s/iter; left time: 2751.5308s
Epoch: 8 cost time: 125.08420395851135
Test is reading ....
[0.7916681753192677, 0.9219074832958327, 0.8230591594979552, 0.9065727699530517, 0.9956813819577734, 0.9823069872997862, 0.6514091350826045, 0.6917700001844327, 0.8605633802816902, 0.8687411350962753, 0.8800723981900452, 0.7475273352944442, 0.5351033834586466, 0.7634660421545668, 0.8020563334679435, 0.7273441101525336, 0.5557365439093485, 0.36359382311651844, 0.7408403534533838, 0.6174613063607823, 0.8899603544776119, 0.7095739324895503, 0.7154577591258814]
Epoch: 8, Steps: 535, | Train Loss: 0.02610

	iters: 100, epoch: 9 | loss: 0.0232933
	speed: 0.3648s/iter; left time: 4257.4123s
	iters: 200, epoch: 9 | loss: 0.0174755
	speed: 0.2349s/iter; left time: 2717.9865s
	iters: 300, epoch: 9 | loss: 0.0222292
	speed: 0.2334s/iter; left time: 2677.3246s
	iters: 400, epoch: 9 | loss: 0.0312406
	speed: 0.2316s/iter; left time: 2633.8697s
	iters: 500, epoch: 9 | loss: 0.0232867
	speed: 0.2324s/iter; left time: 2618.9638s
Epoch: 9 cost time: 124.88318133354187
Test is reading ....
[0.7930158068524326, 0.9233704346933362, 0.8298459314624173, 0.9112089201877934, 0.9961523423615555, 0.9839392484615721, 0.6503219144800777, 0.6923786279440063, 0.8477699530516432, 0.8692851730234907, 0.8843800904977376, 0.7445634678359327, 0.531296992481203, 0.7882903981264637, 0.8052914250947756, 0.7320908413923071, 0.556728045325779, 0.4080486663547028, 0.7395883247030941, 0.6255359695092901, 0.8905239427860696, 0.7079347609736679, 0.7169574724159877]
Epoch: 9, Steps: 535, | Train Loss: 0.02487

	iters: 100, epoch: 10 | loss: 0.0204568
	speed: 0.3609s/iter; left time: 4019.3896s
	iters: 200, epoch: 10 | loss: 0.0163863
	speed: 0.2302s/iter; left time: 2540.1463s
	iters: 300, epoch: 10 | loss: 0.0184528
	speed: 0.2314s/iter; left time: 2530.5932s
	iters: 400, epoch: 10 | loss: 0.0254978
	speed: 0.2336s/iter; left time: 2531.4410s
	iters: 500, epoch: 10 | loss: 0.0219784
	speed: 0.2316s/iter; left time: 2486.1094s
Epoch: 10 cost time: 124.44825530052185
Test is reading ....
[0.7935818827454593, 0.9246708359355618, 0.8358262233817515, 0.9105633802816901, 0.9962500888604535, 0.9862087024833064, 0.6528091593780369, 0.694143033671255, 0.8418427230046948, 0.870725416286164, 0.8889411764705881, 0.7395348837209302, 0.5413533834586466, 0.7928181108508977, 0.807031276406869, 0.7361030197721367, 0.561685552407932, 0.4211511464670098, 0.7374397815390165, 0.632474560535542, 0.8913168532338308, 0.7073352925335737, 0.7187155396762384]
Epoch: 10, Steps: 535, | Train Loss: 0.02313

	iters: 100, epoch: 11 | loss: 0.0157450
	speed: 0.3619s/iter; left time: 3836.0609s
	iters: 200, epoch: 11 | loss: 0.0278781
	speed: 0.2348s/iter; left time: 2465.6855s
	iters: 300, epoch: 11 | loss: 0.0296130
	speed: 0.2357s/iter; left time: 2451.6121s
	iters: 400, epoch: 11 | loss: 0.0185424
	speed: 0.2348s/iter; left time: 2418.2737s
	iters: 500, epoch: 11 | loss: 0.0267400
	speed: 0.2344s/iter; left time: 2391.3992s
Epoch: 11 cost time: 125.4796257019043
Test is reading ....
[0.790381478632622, 0.9253894787273179, 0.8402023692003948, 0.908450704225352, 0.9964278097675411, 0.9872124994544582, 0.6537718658892129, 0.6910998948733871, 0.8352112676056338, 0.871711485029242, 0.8940090497737556, 0.7386801354276518, 0.5387687969924813, 0.8110850897736144, 0.8086252506150855, 0.7391678782567287, 0.5685552407932011, 0.47730463266261114, 0.7342066620295231, 0.6360049351950257, 0.8910680970149254, 0.7030172464260207, 0.7210596293565726]
Epoch: 11, Steps: 535, | Train Loss: 0.02116

	iters: 100, epoch: 12 | loss: 0.0130787
	speed: 0.3634s/iter; left time: 3657.8445s
	iters: 200, epoch: 12 | loss: 0.0164315
	speed: 0.2332s/iter; left time: 2324.0083s
	iters: 300, epoch: 12 | loss: 0.0157257
	speed: 0.2342s/iter; left time: 2310.9375s
	iters: 400, epoch: 12 | loss: 0.0177706
	speed: 0.2338s/iter; left time: 2283.1082s
	iters: 500, epoch: 12 | loss: 0.0126676
	speed: 0.2340s/iter; left time: 2261.6501s
Epoch: 12 cost time: 125.60028982162476
Test is reading ....
[0.7898613246529141, 0.9267126940264244, 0.84501921449725, 0.9092723004694835, 0.9965255562664391, 0.9877885916292062, 0.6502125850340137, 0.6885178377115596, 0.8316314553990609, 0.8724959682903609, 0.9007782805429864, 0.7340400732641394, 0.5353853383458647, 0.822950819672131, 0.8087053051233106, 0.7424015994677448, 0.5741501416430594, 0.5067852129153019, 0.7323440760491536, 0.6374830505368857, 0.8914217972636815, 0.699483660972497, 0.7217464728381758]
Epoch: 12, Steps: 535, | Train Loss: 0.01888

	iters: 100, epoch: 13 | loss: 0.0184470
	speed: 0.3697s/iter; left time: 3523.8375s
	iters: 200, epoch: 13 | loss: 0.0131410
	speed: 0.2349s/iter; left time: 2215.0772s
	iters: 300, epoch: 13 | loss: 0.0127942
	speed: 0.2356s/iter; left time: 2198.1247s
	iters: 400, epoch: 13 | loss: 0.0228741
	speed: 0.2339s/iter; left time: 2159.3421s
	iters: 500, epoch: 13 | loss: 0.0205682
	speed: 0.2347s/iter; left time: 2143.2748s
Epoch: 13 cost time: 126.03939199447632
Test is reading ....
[0.7896617409527207, 0.9275083342601544, 0.848337681568185, 0.9034037558685446, 0.996569986493211, 0.9883472264653254, 0.650224732750243, 0.685542324220311, 0.8328051643192489, 0.8732804515514796, 0.904579185520362, 0.7319864572348338, 0.5374060150375939, 0.8313817330210772, 0.8096499483203675, 0.7456049253880044, 0.583215297450425, 0.5339260645765092, 0.73140119020017, 0.6379838995370201, 0.8924051616915422, 0.6949946726925733, 0.7211730530507824]
Epoch: 13, Steps: 535, | Train Loss: 0.01759

	iters: 100, epoch: 14 | loss: 0.0109198
	speed: 0.3642s/iter; left time: 3276.2341s
	iters: 200, epoch: 14 | loss: 0.0160433
	speed: 0.2420s/iter; left time: 2152.9527s
	iters: 300, epoch: 14 | loss: 0.0215776
	speed: 0.2440s/iter; left time: 2146.4172s
	iters: 400, epoch: 14 | loss: 0.0254730
	speed: 0.2347s/iter; left time: 2041.1274s
	iters: 500, epoch: 14 | loss: 0.0143423
	speed: 0.2349s/iter; left time: 2019.2072s
Epoch: 14 cost time: 127.5717089176178
Test is reading ....
[0.7896661565213092, 0.9289142505154551, 0.8512639261035114, 0.9016431924882629, 0.9965788725385654, 0.9884781565050408, 0.6482993197278912, 0.6835750425732046, 0.8342136150234742, 0.8741499407387257, 0.9112036199095023, 0.7240495087972469, 0.5476503759398497, 0.8448087431693989, 0.8104113556430422, 0.7480720098210563, 0.5853399433427762, 0.5470285446888161, 0.7288043898291986, 0.6356873236339649, 0.891064210199005, 0.6914634289126439, 0.7219607175939053]
Epoch: 14, Steps: 535, | Train Loss: 0.01542

	iters: 100, epoch: 15 | loss: 0.0152755
	speed: 0.3634s/iter; left time: 3074.3495s
	iters: 200, epoch: 15 | loss: 0.0146122
	speed: 0.2369s/iter; left time: 1980.3785s
	iters: 300, epoch: 15 | loss: 0.0155861
	speed: 0.2408s/iter; left time: 1989.0011s
	iters: 400, epoch: 15 | loss: 0.0098841
	speed: 0.2315s/iter; left time: 1889.0516s
	iters: 500, epoch: 15 | loss: 0.0222579
	speed: 0.2343s/iter; left time: 1888.3846s
Epoch: 15 cost time: 125.99299311637878
Test is reading ....
[0.7909078144083536, 0.9296186345216606, 0.8536569242702016, 0.890962441314554, 0.9966055306746285, 0.9884170558198403, 0.6464467930029154, 0.6845955699276409, 0.8328638497652583, 0.8745142518507004, 0.9125067873303168, 0.717988566353999, 0.5545112781954886, 0.8527712724434036, 0.8131243139773393, 0.7511385569329125, 0.5918319169027384, 0.5620028076743098, 0.7274235515366979, 0.633977107535945, 0.8904792444029851, 0.688243627720732, 0.7243930257030694]
Epoch: 15, Steps: 535, | Train Loss: 0.01456

	iters: 100, epoch: 16 | loss: 0.0120239
	speed: 0.3593s/iter; left time: 2848.1394s
	iters: 200, epoch: 16 | loss: 0.0051180
	speed: 0.2318s/iter; left time: 1814.0587s
	iters: 300, epoch: 16 | loss: 0.0105119
	speed: 0.2316s/iter; left time: 1789.2371s
	iters: 400, epoch: 16 | loss: 0.0133621
	speed: 0.2311s/iter; left time: 1762.5089s
	iters: 500, epoch: 16 | loss: 0.0144713
	speed: 0.2325s/iter; left time: 1749.9245s
Epoch: 16 cost time: 124.34946393966675
Test is reading ....
[0.7907029320258541, 0.930562566125118, 0.8561468763220984, 0.8757042253521127, 0.996641074856046, 0.988626543883385, 0.6442541302235181, 0.6842943299254278, 0.833744131455399, 0.8748809917034217, 0.9140633484162896, 0.7089526558250542, 0.5668703007518797, 0.8548009367681499, 0.8155401811366673, 0.7533894970761419, 0.5944050991501416, 0.5648104819840898, 0.7268258752608393, 0.6302390637788446, 0.8885844216417911, 0.6851900853540025, 0.7248530217962532]
Epoch: 16, Steps: 535, | Train Loss: 0.01283

	iters: 100, epoch: 17 | loss: 0.0102078
	speed: 0.3751s/iter; left time: 2772.1161s
	iters: 200, epoch: 17 | loss: 0.0221240
	speed: 0.2404s/iter; left time: 1752.8504s
	iters: 300, epoch: 17 | loss: 0.0089713
	speed: 0.2345s/iter; left time: 1686.2753s
	iters: 400, epoch: 17 | loss: 0.0140795
	speed: 0.2396s/iter; left time: 1698.7719s
	iters: 500, epoch: 17 | loss: 0.0092225
	speed: 0.2348s/iter; left time: 1641.7343s
Epoch: 17 cost time: 127.45789957046509
Test is reading ....
[0.7908539444715756, 0.9312013597177901, 0.8581652799323085, 0.8670774647887324, 0.996712163218881, 0.9887749312617291, 0.6424744897959184, 0.6849459919710318, 0.8349765258215962, 0.8751651543707618, 0.9164524886877827, 0.702480990175945, 0.5765507518796993, 0.8593286494925838, 0.8176518411647397, 0.7550038247407534, 0.5956680830972616, 0.5732335049134301, 0.7255377798387304, 0.6318393374134204, 0.8875835665422885, 0.6827219613858023, 0.7271025917314126]
Epoch: 17, Steps: 535, | Train Loss: 0.01185

	iters: 100, epoch: 18 | loss: 0.0073786
	speed: 0.3625s/iter; left time: 2485.3667s
	iters: 200, epoch: 18 | loss: 0.0105476
	speed: 0.2265s/iter; left time: 1530.1017s
	iters: 300, epoch: 18 | loss: 0.0114276
	speed: 0.2279s/iter; left time: 1516.5868s
	iters: 400, epoch: 18 | loss: 0.0065009
	speed: 0.2274s/iter; left time: 1491.0359s
	iters: 500, epoch: 18 | loss: 0.0084299
	speed: 0.2249s/iter; left time: 1452.2030s
Epoch: 18 cost time: 122.57140231132507
Test is reading ....
[0.790780646033009, 0.932113921993036, 0.8599897757721056, 0.859330985915493, 0.9967743655363617, 0.9888098459389867, 0.6405612244897958, 0.6850136172776511, 0.8328051643192489, 0.8749732838517885, 0.9159819004524887, 0.694766054282067, 0.5777725563909775, 0.8602654176424668, 0.8190590215204306, 0.7560659712899593, 0.5986071765816808, 0.5722976134768367, 0.7225287889326841, 0.6323890497306409, 0.8858675373134328, 0.6792141343418141, 0.7281549115610251]
Epoch: 18, Steps: 535, | Train Loss: 0.01059

	iters: 100, epoch: 19 | loss: 0.0081515
	speed: 0.3806s/iter; left time: 2406.0749s
	iters: 200, epoch: 19 | loss: 0.0128818
	speed: 0.2347s/iter; left time: 1460.2437s
	iters: 300, epoch: 19 | loss: 0.0093004
	speed: 0.2377s/iter; left time: 1455.1321s
	iters: 400, epoch: 19 | loss: 0.0121953
	speed: 0.2399s/iter; left time: 1444.3730s
	iters: 500, epoch: 19 | loss: 0.0092510
	speed: 0.2336s/iter; left time: 1382.9373s
Epoch: 19 cost time: 127.76089310646057
Test is reading ....
[0.7897412211873112, 0.9331947379377803, 0.861232548300663, 0.8550469483568076, 0.9967210492642354, 0.9888360319469297, 0.6386236637512148, 0.6859111895291433, 0.8318661971830985, 0.8752938776303263, 0.9150407239819005, 0.6923794194371982, 0.5807800751879699, 0.863231850117096, 0.820250054703914, 0.7571331837209578, 0.598512747875354, 0.5760411792232101, 0.7207357601051086, 0.6366279424878759, 0.8849385883084576, 0.6768467023381611, 0.7292261353396724]
Epoch: 19, Steps: 535, | Train Loss: 0.00962

	iters: 100, epoch: 20 | loss: 0.0108907
	speed: 0.3622s/iter; left time: 2095.6861s
	iters: 200, epoch: 20 | loss: 0.0124212
	speed: 0.2307s/iter; left time: 1311.6525s
	iters: 300, epoch: 20 | loss: 0.0065845
	speed: 0.2304s/iter; left time: 1286.9193s
	iters: 400, epoch: 20 | loss: 0.0172305
	speed: 0.2324s/iter; left time: 1275.0371s
	iters: 500, epoch: 20 | loss: 0.0079773
	speed: 0.2301s/iter; left time: 1239.4495s
Epoch: 20 cost time: 123.83878827095032
Test is reading ....
[0.7888691463911117, 0.9338392350446727, 0.8622153081370751, 0.8536384976525822, 0.9967210492642355, 0.9889233186400733, 0.6369108357628765, 0.6867964662703414, 0.8298708920187793, 0.8757237647424564, 0.9087782805429864, 0.6894155519786868, 0.5834586466165413, 0.8651053864168619, 0.8210657211932746, 0.7588370086305739, 0.5970963172804533, 0.5807206364061769, 0.7186438931396038, 0.6387290651225859, 0.8836170708955223, 0.6742380779543139, 0.7288921655733882]
Epoch: 20, Steps: 535, | Train Loss: 0.00838

	iters: 100, epoch: 21 | loss: 0.0136777
	speed: 0.3625s/iter; left time: 1903.5994s
	iters: 200, epoch: 21 | loss: 0.0101667
	speed: 0.2331s/iter; left time: 1200.5646s
	iters: 300, epoch: 21 | loss: 0.0042106
	speed: 0.2266s/iter; left time: 1144.4963s
	iters: 400, epoch: 21 | loss: 0.0111602
	speed: 0.2300s/iter; left time: 1138.8491s
	iters: 500, epoch: 21 | loss: 0.0087519
	speed: 0.2311s/iter; left time: 1121.2194s
Epoch: 21 cost time: 123.81754684448242
Test is reading ....
[0.7878283968748371, 0.9344067347095913, 0.8638458962064589, 0.8473591549295775, 0.996756593445653, 0.9888971326321302, 0.6335580660835762, 0.6859173372842906, 0.8283450704225352, 0.8761949404472769, 0.9057013574660633, 0.6842648609646446, 0.5844454887218046, 0.8616705698672913, 0.8225476190899759, 0.7589771646935057, 0.5968602455146365, 0.555919513336453, 0.7184120359636242, 0.6403659862449762, 0.883065143034826, 0.6716692620215667, 0.7276508062534264]
Epoch: 21, Steps: 535, | Train Loss: 0.00810

	iters: 100, epoch: 22 | loss: 0.0057806
	speed: 0.3645s/iter; left time: 1719.1138s
	iters: 200, epoch: 22 | loss: 0.0042404
	speed: 0.2285s/iter; left time: 1054.9351s
	iters: 300, epoch: 22 | loss: 0.0049152
	speed: 0.2285s/iter; left time: 1031.9603s
	iters: 400, epoch: 22 | loss: 0.0104460
	speed: 0.2318s/iter; left time: 1023.4854s
	iters: 500, epoch: 22 | loss: 0.0075695
	speed: 0.2303s/iter; left time: 993.7682s
Epoch: 22 cost time: 123.64219260215759
Test is reading ....
[0.7886929652044365, 0.9348344982761129, 0.8651679946410942, 0.8462441314553991, 0.996641074856046, 0.9888273032776154, 0.6321550048590865, 0.6862247250416511, 0.828169014084507, 0.8760492160024871, 0.9052669683257919, 0.679647000055503, 0.5862781954887218, 0.8546448087431694, 0.8234157657569509, 0.7597539332350551, 0.5984183191690274, 0.5353299017313992, 0.7184326454903779, 0.6439574400508179, 0.8823266480099502, 0.6697350396328255, 0.7264220495661545]
Epoch: 22, Steps: 535, | Train Loss: 0.00771

	iters: 100, epoch: 23 | loss: 0.0055893
	speed: 0.3592s/iter; left time: 1501.6694s
	iters: 200, epoch: 23 | loss: 0.0051879
	speed: 0.2328s/iter; left time: 949.9270s
	iters: 300, epoch: 23 | loss: 0.0036352
	speed: 0.2362s/iter; left time: 940.1986s
	iters: 400, epoch: 23 | loss: 0.0088924
	speed: 0.2291s/iter; left time: 889.3099s
	iters: 500, epoch: 23 | loss: 0.0055533
	speed: 0.2298s/iter; left time: 868.9237s
Epoch: 23 cost time: 123.88054418563843
Test is reading ....
[0.789966415185317, 0.9354476260547937, 0.8658951487801438, 0.8401995305164319, 0.9965788725385655, 0.9887662025924149, 0.6287172011661807, 0.6862923503482703, 0.8282276995305164, 0.8764183845959547, 0.9057375565610859, 0.6783482266748072, 0.5856672932330826, 0.8488680718188915, 0.8249492543367307, 0.761638441261945, 0.5994334277620397, 0.5194197473093121, 0.717829816832831, 0.6469258865638093, 0.8821944962686568, 0.6672271072135254, 0.7265669798420891]
Epoch: 23, Steps: 535, | Train Loss: 0.00688

	iters: 100, epoch: 24 | loss: 0.0055525
	speed: 0.3655s/iter; left time: 1332.5284s
	iters: 200, epoch: 24 | loss: 0.0041489
	speed: 0.2340s/iter; left time: 829.7140s
	iters: 300, epoch: 24 | loss: 0.0055484
	speed: 0.2321s/iter; left time: 799.9104s
	iters: 400, epoch: 24 | loss: 0.0069764
	speed: 0.2335s/iter; left time: 781.3808s
	iters: 500, epoch: 24 | loss: 0.0134090
	speed: 0.2319s/iter; left time: 752.6175s
Epoch: 24 cost time: 124.96571803092957
Test is reading ....
[0.7919269276385451, 0.935635842024063, 0.8667104428148357, 0.8386737089201878, 0.9965433283571479, 0.9885916292061274, 0.6287475704567541, 0.6868640915769607, 0.8272887323943662, 0.8764378145219267, 0.9027692307692308, 0.6756840761503026, 0.5865601503759399, 0.8424668227946916, 0.8259508251840808, 0.7627546238836063, 0.5985127478753541, 0.4997660271408516, 0.7165726357008527, 0.6492468941254077, 0.8812266791044777, 0.6656499900478872, 0.7233848150878719]
Epoch: 24, Steps: 535, | Train Loss: 0.00650

	iters: 100, epoch: 25 | loss: 0.0195484
	speed: 0.3708s/iter; left time: 1153.6450s
	iters: 200, epoch: 25 | loss: 0.0046847
	speed: 0.2413s/iter; left time: 726.5869s
	iters: 300, epoch: 25 | loss: 0.0029279
	speed: 0.2363s/iter; left time: 687.8071s
	iters: 400, epoch: 25 | loss: 0.0065615
	speed: 0.2349s/iter; left time: 660.1723s
	iters: 500, epoch: 25 | loss: 0.0046873
	speed: 0.2347s/iter; left time: 636.3829s
Epoch: 25 cost time: 126.96389389038086
Test is reading ....
[0.7925239125116902, 0.9358040956935616, 0.8675301438443097, 0.8349178403755868, 0.9965344423117937, 0.9885130711822983, 0.6273931000971817, 0.6881551201578744, 0.8250586854460094, 0.8758767754094857, 0.9011402714932126, 0.672387189876228, 0.5874999999999999, 0.8373145979703356, 0.8271552007856015, 0.7635854284976116, 0.5996104815864023, 0.4922788956481048, 0.7145425973156092, 0.6518488657602521, 0.8805853544776119, 0.6646020911145196, 0.7218346912670057]
Epoch: 25, Steps: 535, | Train Loss: 0.00617

	iters: 100, epoch: 26 | loss: 0.0041480
	speed: 0.3711s/iter; left time: 955.9598s
	iters: 200, epoch: 26 | loss: 0.0063891
	speed: 0.2366s/iter; left time: 585.8707s
	iters: 300, epoch: 26 | loss: 0.0035788
	speed: 0.2316s/iter; left time: 550.3943s
	iters: 400, epoch: 26 | loss: 0.0028972
	speed: 0.2345s/iter; left time: 533.7604s
	iters: 500, epoch: 26 | loss: 0.0051975
	speed: 0.2402s/iter; left time: 522.5711s
Epoch: 26 cost time: 126.6569275856018
Test is reading ....
[0.793989881283023, 0.9361919346605411, 0.8677901565364546, 0.8278169014084507, 0.9964988981303761, 0.9883123117880679, 0.6270347424684161, 0.6882288932196408, 0.8233568075117371, 0.8756339013348359, 0.8985701357466063, 0.6727313093189765, 0.5896146616541353, 0.8326307572209212, 0.8282901958133271, 0.7644947542794036, 0.601038715769594, 0.4932147870846981, 0.7133987685807764, 0.6556602044929819, 0.8783582089552239, 0.663597513142643, 0.7198308726693007]
Epoch: 26, Steps: 535, | Train Loss: 0.00524

	iters: 100, epoch: 27 | loss: 0.0047049
	speed: 0.3712s/iter; left time: 757.5838s
	iters: 200, epoch: 27 | loss: 0.0100462
	speed: 0.2341s/iter; left time: 454.4829s
	iters: 300, epoch: 27 | loss: 0.0039263
	speed: 0.2386s/iter; left time: 439.2711s
	iters: 400, epoch: 27 | loss: 0.0058293
	speed: 0.2322s/iter; left time: 404.2068s
	iters: 500, epoch: 27 | loss: 0.0060164
	speed: 0.2331s/iter; left time: 382.5538s
Epoch: 27 cost time: 125.68844747543335
Test is reading ....
[0.7937638041712993, 0.9362945979165063, 0.8674552249330136, 0.8224178403755869, 0.9964811260396673, 0.9880679090472657, 0.6267371234207969, 0.6887022703659759, 0.821244131455399, 0.8761548662249596, 0.8941900452488688, 0.6708775045790087, 0.5915413533834586, 0.8270101483216237, 0.8282136992832453, 0.7656387992509249, 0.6032341831916902, 0.4904071127749181, 0.7121209779220444, 0.6592760899573668, 0.8771455223880598, 0.6614361484152724, 0.7173733592947567]
Epoch: 27, Steps: 535, | Train Loss: 0.00574

	iters: 100, epoch: 28 | loss: 0.0026217
	speed: 0.3665s/iter; left time: 551.9974s
	iters: 200, epoch: 28 | loss: 0.0053946
	speed: 0.2252s/iter; left time: 316.6334s
	iters: 300, epoch: 28 | loss: 0.0050250
	speed: 0.2363s/iter; left time: 308.6207s
	iters: 400, epoch: 28 | loss: 0.0163398
	speed: 0.2289s/iter; left time: 276.0695s
	iters: 500, epoch: 28 | loss: 0.0046830
	speed: 0.2255s/iter; left time: 249.4008s
Epoch: 28 cost time: 123.23992395401001
Test is reading ....
[0.7938556479979372, 0.9365027761855467, 0.867503701875617, 0.819131455399061, 0.9964455818582498, 0.9878758783223497, 0.6278911564625851, 0.6899133781299759, 0.8186619718309859, 0.8763115200031089, 0.8923076923076924, 0.6708331020702669, 0.5925281954887218, 0.824824355971897, 0.8283151016603305, 0.7662686572204858, 0.6042020774315392, 0.4805802526906878, 0.7111317206378648, 0.663160723665726, 0.8767918221393035, 0.6591483333138195, 0.7154199512278114]
Epoch: 28, Steps: 535, | Train Loss: 0.00509

	iters: 100, epoch: 29 | loss: 0.0054232
	speed: 0.3603s/iter; left time: 349.8328s
	iters: 200, epoch: 29 | loss: 0.0030669
	speed: 0.2309s/iter; left time: 201.0801s
	iters: 300, epoch: 29 | loss: 0.0040812
	speed: 0.2329s/iter; left time: 179.5677s
	iters: 400, epoch: 29 | loss: 0.0039762
	speed: 0.2339s/iter; left time: 156.9612s
	iters: 500, epoch: 29 | loss: 0.0038644
	speed: 0.2312s/iter; left time: 132.0329s
Epoch: 29 cost time: 124.42356538772583
Test is reading ....
[0.7951193837279233, 0.9368307282532132, 0.8671247003243547, 0.8150234741784038, 0.9964100376768322, 0.987614018242919, 0.6278607871720117, 0.6906449609924935, 0.8168427230046947, 0.8761973691880234, 0.8901719457013575, 0.6713104290392408, 0.5955357142857143, 0.8232630757220921, 0.8295924158137896, 0.767015030471279, 0.6052407932011331, 0.4749649040711278, 0.710235206224077, 0.6672285948131588, 0.8756801927860696, 0.6580594550925547, 0.7129057260061626]
Epoch: 29, Steps: 535, | Train Loss: 0.00445

	iters: 100, epoch: 30 | loss: 0.0012843
	speed: 0.3638s/iter; left time: 158.6224s
	iters: 200, epoch: 30 | loss: 0.0051041
	speed: 0.2345s/iter; left time: 78.7910s
	iters: 300, epoch: 30 | loss: 0.0039820
	speed: 0.2327s/iter; left time: 54.9251s
	iters: 400, epoch: 30 | loss: 0.0052529
	speed: 0.2372s/iter; left time: 32.2626s
	iters: 500, epoch: 30 | loss: 0.0020311
	speed: 0.2388s/iter; left time: 8.5983s
Epoch: 30 cost time: 126.01674437522888
Test is reading ....
[0.7954116943684721, 0.9369362432662884, 0.8668911296009025, 0.8088028169014085, 0.996356721404706, 0.9875616462270327, 0.6274173955296405, 0.691278179772656, 0.8154342723004695, 0.8760977908174171, 0.8881447963800905, 0.6718987622800688, 0.5966165413533835, 0.8220140515222483, 0.8295737364285372, 0.7677867331310358, 0.6046506137865911, 0.470285446888161, 0.7094778061158771, 0.67151635088748, 0.8753226057213929, 0.6568862766219017, 0.7108577981940427]
Epoch: 30, Steps: 535, | Train Loss: 0.00440

>>>>>>>testing : my_classification_PTB-XL-Indep_Medformer_my_data_ftM_sl96_ll48_pl96_dm128_nh8_el6_dl1_df256_fc1_ebtimeF_dtTrue_Exp_seed41<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
Traceback (most recent call last):
  File "/data/0shared/zhangshanwei/cinc/baseline/Medformer-main/run.py", line 301, in <module>
    exp.test(setting)
TypeError: Exp_Basic.test() takes 1 positional argument but 2 were given
